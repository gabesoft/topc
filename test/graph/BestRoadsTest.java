package topc.test.graph;

import junit.framework.*;
import org.junit.Test;
import static org.junit.Assert.*;
import topc.graph.*;

public class BestRoadsTest {
  BestRoads bestroads = new BestRoads();

  @Test
  public void case1() {
    String[] roads = { "NYYYY", "YNYYY", "YYNYY", "YYYNY", "YYYYN" };
    int M = 10;
    assertArrayEquals(new int[] { 4, 4, 4, 4, 4 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case2() {
    String[] roads = { "NYY", "YNY", "YYN" };
    int M = 2;
    assertArrayEquals(new int[] { 2, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case3() {
    String[] roads = { "NYNNY", "YNNNY", "NNNNN", "NNNNY", "YYNYN" };
    int M = 4;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case4() {
    String[] roads = { "NYYNYYYN", "YNNNNYYN", "YNNNYNNN", "NNNNNNYY", "YNYNNNNN", "YYNNNNYY", "YYNYNYNY", "NNNYNYYN" };
    int M = 10;
    assertArrayEquals(new int[] { 5, 3, 2, 2, 2, 2, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case5() {
    String[] roads = { "NNYY", "NNYY", "YYNN", "YYNN" };
    int M = 5;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case6() {
    String[] roads = { "NNYNNNYNNNYNYYYNNNNNNNNNNNNNNNNNNNNNNNNNYYNY", "NNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "YNNNNNNYNNNNNNNNNYNNNNNNYNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNYNNNNNYNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNY", "YNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNN", "NNNNNYNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNN", "YNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNNN", "NNYYNNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NYYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNY", "NNNNNNNNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNYYN", "YNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNN", "YNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNYNNNN", "YNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNYNNNNNNNNN" };
    int M = 49;
    assertArrayEquals(new int[] { 9, 2, 5, 1, 1, 2, 4, 1, 3, 2, 3, 3, 1, 3, 3, 2, 2, 4, 1, 2, 2, 2, 1, 1, 3, 2, 3, 2, 1, 2, 1, 1, 3, 1, 2, 1, 1, 2, 2, 1, 3, 2, 1, 4 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case7() {
    String[] roads = { "NYYNYNNNNNYNNNNNNYYNNYNNNNNNNYN", "YNNNNYNYNYNNNNNNNNNNNNNNNNNNYNN", "YNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "YNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNYNNYNNNNYNNYNNNYNNNNNNN", "NYNNNNNNNNNNNNNNNNNNYNNNNNYNNYN", "NNNNNNYNNNNNNNNNNNNNYNNYNNNNNNN", "NYNNNNNNNNNYNNNNNNNNNNNNNNNNYNN", "YNNNNNNNNNNYNNNNNNNNNNNNYYNNNNY", "NNNNNNYNNYYNNNNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNNYNNNNNYYNNNNNNNNNNYNNNNYN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "YNNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNYYNNNNNNNNNNNNNNNNNNNNNN", "YNNNNYNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNYYNN", "NNNNNNYNYNNYNNNYNNNNNNNNNNNNNNN", "NNNYNNNNNNYNNNYNYNNNNYYNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNYNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNNYNNNNYNNNNYNNYNNNYN", "NYNNNNNNNYNNNNNNNNNNNNYNNNNNNNN", "YNNNNNNYNNNNNNNNYNNNNNNNNNNYNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNYNNNN" };
    int M = 35;
    assertArrayEquals(new int[] { 8, 5, 2, 1, 2, 2, 5, 4, 3, 2, 4, 2, 2, 1, 1, 1, 3, 1, 2, 1, 2, 2, 1, 2, 4, 1, 1, 1, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case8() {
    String[] roads = { "NNNNNNNNNYNNNNNNNYNNNNNNYNNNNYNNNNNNYNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNYNYNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNYNNNNNNYNNNNNNNNNNYNNYNNNNNNNYNNNNNNNNNN", "NNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNYNNNNNYNNNNNNNNNNNNNNNNYYNNNNNYNNNNYNN", "YNNYNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNYNN", "NNNNNYNNNNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNYNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNY", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NYNNNNNNNYNNNNNNNYYNNNNNNNNYNNNNYNNNNNNNNNNNN", "NNYNNNYNNNNYNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNNN", "YNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNY", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNYNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYYNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNYNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNN", "NNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNYNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNYNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNYN" };
    int M = 48;
    assertArrayEquals(new int[] { 6, 3, 2, 1, 2, 3, 5, 3, 6, 4, 1, 1, 1, 1, 2, 3, 1, 3, 3, 3, 2, 1, 4, 3, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 4, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case9() {
    String[] roads = { "NNNYNNNNNNNYYNYYNNNNNNNN", "NNNNNNNNNYNNNNNNNNNYNNNN", "NNNYYNNNNNNNNNNNNNNNNNNY", "YNYNNNNNNNNNNNNNNNNNNNNN", "NNYNNYNNNNYNNYNNNNNNNNYN", "NNNNYNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNYNNN", "NNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNYNNNNN", "NYNNNNNNNNNYNNNNNNNNNNNN", "NNNNYNNNNNNNNYNNYNNNNNNN", "YNNNNNNNNYNNNYNNNNNNNNNN", "YNNNNNNNYNNNNNNNNYNNNNYN", "NNNNYNNNNNYYNNNNNYNNNNNN", "YNNNNNYNNNNNNNNNNNNNNNYN", "YNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNYYNYNNYNNNYN", "NNNNNNNNYNNNNNNNNYNNNNNY", "NYNNNNNNNNNNNNNNNNNNNYYN", "NNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNN", "NNNNYNNNNNNNYNYNNYNYNNNY", "NNYNNNNNNNNNNNNNNNYNNNYN" };
    int M = 33;
    assertArrayEquals(new int[] { 5, 2, 3, 2, 5, 2, 2, 1, 2, 2, 3, 3, 4, 4, 3, 2, 1, 5, 3, 3, 1, 1, 5, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case10() {
    String[] roads = { "NNNNYYYNYYNNNNNNNNNNNNNYYNYN", "NNNNNNNNNNNNNNYNNNNNYNNYNNNN", "NNNNNNNNNNNYNNYNYNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNYNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNYNNNNNY", "YNNNNNNNNNNYNNNNNNNNYNNNNYNN", "NNNNNNNNNNNYNNNNNYNYNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNYNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNYNNYNNNNNNNNNNNNN", "NNYNNNYYNNYNNNNYNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NYYNNNNNNNYNNNNNYNNYNNNNNNNN", "NNNNNNNNNNNYNNNNYNNNNNNYNYNN", "NNYNNNNNNNNNNNYYNYNNNYNNNNYN", "NNNNNNNYNYNNNNNNYNNNNNNNNNNN", "NNNYNNNNNNNNYNNNNNNNNNYNNNYY", "NNNNNNNYNNNNNNYNNNNNNNNNNNNN", "NYNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNYNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNN", "YYNNNNNNNNNNNNNYNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNYNNYNNNNNNNNNNNN", "YNNNNNNNNNNNNYNNYNYNNNNNNNNN", "NNNNNYNNNNNNNNNNNNYNNNNNNNNN" };
    int M = 36;
    assertArrayEquals(new int[] { 8, 3, 3, 2, 1, 3, 4, 3, 1, 3, 2, 6, 2, 1, 5, 2, 3, 2, 3, 2, 2, 2, 1, 2, 1, 2, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case11() {
    String[] roads = { "NYNNNNNNNNNNYNYNNNNNYNNYYNNNNYNNNYNN", "YNYNYNNNNNNYNNNYYNNNYNNNNYNNNYNNYNNN", "NYNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNYNNNNNNNNYNNNNNNNYN", "NNNNNNNNNNNNNNYNNNNNNNNYNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNYNNNYNNNNNNN", "NNNNNNNYNNNNNNYNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNNNNY", "NYNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNYYNYNNNNNNNYNNNNNNNNNYNNNNNNNNN", "NYNNNNNNNNYNNNNNNNNNNNYNNNNNYNNNNNNN", "NYYNNNNNNYNNNNYNNNNNNNYNNNNNNNNNNNNN", "NNNYNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "YYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNYYNNNNNNNNNNNNNNNNNNN", "YNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NYNYNNNNYNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYN", "NNNNNNNYNNNNNNNYNNNNNNNNNYNNNNNNNNNN", "YYNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN" };
    int M = 42;
    assertArrayEquals(new int[] { 8, 10, 3, 2, 1, 4, 2, 3, 3, 1, 2, 2, 2, 1, 4, 2, 3, 2, 1, 1, 3, 1, 1, 2, 2, 3, 1, 2, 1, 3, 1, 1, 2, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case12() {
    String[] roads = { "NNNYNNYNNNNNYNNNNNNNNNNNNNNNNNYYNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNYNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNYNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNYNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNYNNNNNNNNNNNNNNNNNNNNNNNNN", "YYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNYNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNYNNNNNNNNNNNNNNYNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNYNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNYNNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "YNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NYNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNYNYNNNYNYNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNYYNNNNNNNNNYNNNNNNNNYNNNYN", "NNNYYNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN" };
    int M = 44;
    assertArrayEquals(new int[] { 5, 2, 1, 3, 2, 1, 5, 1, 3, 1, 1, 2, 2, 2, 3, 1, 2, 2, 1, 2, 4, 1, 1, 2, 2, 2, 1, 1, 3, 1, 2, 2, 1, 3, 4, 1, 1, 2, 5, 3, 2, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case13() {
    String[] roads = { "NNNNNNNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNYNNN", "NNNNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNYYNNNNNNNNNNNNNNNNNNNNNNYNN", "NNYNYNNNNNNNYNNNNNNNNNNNNNNYNNNNYNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNYNNNNNN", "YNNNNNYNNNNNNNNNYNNNNYNNNNNNNNNNNNNNN", "YNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNYNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNYNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNYNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNYNNNNNNYNNNNNNNNYNNNNNNNNNYYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNYNNNNNNNNYNNNYNNNNNNNYNYNNNNNYYNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNYNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNYYNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNYNNNNNNNNYNN", "NNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNYNN", "NYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNYNNYNNNNNNNNNNYYNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN" };
    int M = 38;
    assertArrayEquals(new int[] { 2, 3, 2, 2, 1, 1, 4, 5, 1, 2, 4, 2, 3, 3, 3, 1, 3, 1, 3, 4, 1, 1, 1, 3, 1, 1, 1, 2, 2, 1, 3, 2, 1, 1, 3, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case14() {
    String[] roads = { "NNNYNNNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNY", "NNNNNYNNNNYNNNYNNNNNNNNNNNNNNNYNYNNNNNYN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNYNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNN", "YNNNYNNNNNNNNNNNNNNNNNNNNNNYNYNNNYNNNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNYYNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNYNNNN", "NNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNYNNNYNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNYNNNNNYNNNNNYNNNNNNNNNNNNNYNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNYNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNYNNNNNN", "NNNNNNNNYNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NNNNNNNYNNYYNNNNNNNNNNYNNNYNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNYNNNNNNNNNNNNNNNNYYN", "NNNNYNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNYNYNNNNNNNNNNNNY", "NYNNNNNNNNNNNYNNYNNNNYNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNNN", "NNNNYNNNNNNYNNNNNYNNNNNNNNNNNNNYNNNYNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN" };
    int M = 42;
    assertArrayEquals(new int[] { 3, 2, 2, 4, 6, 1, 1, 3, 2, 2, 5, 4, 1, 2, 1, 3, 2, 1, 3, 2, 1, 2, 3, 1, 1, 2, 1, 2, 1, 4, 1, 3, 2, 1, 3, 1, 1, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case15() {
    String[] roads = { "NNNNNYNNNNNNYNNNNYNNYN", "NNNYNNNNNNYNNNNNNYYNNY", "NNNYNNNNNNYNNNYNNNNNNN", "NYYNYNNYYNNNNNNNNNNNNN", "NNNYNNYYNNNNNNNNNNNNNN", "YNNNNNNNNNYNNNNNNNNYNN", "NNNNYNNNNNNNNNNNNNNNNN", "NNNYYNNNNYNNNYNNNYYNNN", "NNNYNNNNNYNNNNNNNYNNNN", "NNNNNNNYYNNNNNNNNNYNNN", "NYYNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNNN", "YNNNNNNNNNNYNNNYNNNNNN", "NNNNNNNYNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNYNNNYNNNNN", "NNNNNNNNNNNNNNNYNNNNNN", "YYNNNNNYYNNNNNNNNNNNNN", "NYNNNNNYNYNNNNYNNNNNNN", "NNNNNYNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNN" };
    int M = 26;
    assertArrayEquals(new int[] { 4, 5, 3, 5, 3, 3, 1, 6, 1, 1, 3, 1, 3, 1, 1, 2, 1, 3, 2, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case16() {
    String[] roads = { "NNNNNNNNNNYNNNNNNNNNYYN", "NNNNNNNNYNNYYNNNNNNNNNN", "NNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNYNNNNN", "NNNNNNNNNNNNNNYNNNNNNNN", "NNYNNNNYNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNYNNNNNN", "NNNNNYYNNNNNNNNNNYYYYNN", "NYNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNNNNNNNY", "YNNNNNNNNNNNNNNYNNNYNNN", "NYNNNNNNNNNNNNNNNNNNNNN", "NYNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNNNN", "NNNNYNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNN", "NNNYNNNYNNNNNYNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNYNNYNNNYNNNNNNNN", "YNNNNNNYNNNNNNNNNNNNNNY", "YNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYYNNNNNNNNNNYNN" };
    int M = 32;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case17() {
    String[] roads = { "NNNNNYNYNYNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNYNNYNN", "NNNNNNNNNNYNNNNNYNYNNN", "NNNNNNNNNNNNNYNNNNYNNY", "NNNNNNNNNNYNNNYNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNYNN", "YNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNY", "YNNNNNNNNNNNYNNNNYNNNN", "NNYNYNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNYNNNNNNNYNYNN", "NNNYNNNNNNNNNNYNNNNNNN", "NNNNYNYNNNYNNYNYNNNYNN", "NNNNNNNNNNNNNNYNNNYNNN", "NYYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNYNNNNNNNNN", "NNYYNNNNYNNYNNNYNNNYYN", "YYNNNNYNNNNNYNYNNNYNNN", "NNNNNNNNNNNNNNNNNNYNNN", "NNNYNNNNYNNNNNNNNNNNNN" };
    int M = 23;
    assertArrayEquals(new int[] { 4, 2, 3, 3, 2, 1, 2, 1, 2, 3, 2, 1, 1, 1, 3, 1, 2, 1, 5, 3, 1, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case18() {
    String[] roads = { "NNNNNNNNNNNNNNNNNNNNYNNNNYNNNNY", "NNNNNNYNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNYNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NYNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNYYNNYN", "NNNYNYNNNNNNNYNYNNNNNYNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNYNYNNNYYYYYNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "YNNNNNNNNNNYNNYNYNYNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNYNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN" };
    int M = 33;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case19() {
    String[] roads = { "NYNNNNNNYYNNNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNYY", "YNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNYNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNYNNNNNNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "YNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNYNNNN", "NNNNNNNYNNNNNNNNNNNNYYNNNNNYNNNNNNNNNNYNNYYN", "NNNNNNNNYNNNNNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNYNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNYNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNYNNYNNNNNNNNNNNNNNNNYNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "YNNNYNNNNNNNNYNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYYNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNY", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNYNNNNNNYYNNNNNNNNNNNNNNNNNNN", "YNNNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN" };
    int M = 50;
    assertArrayEquals(new int[] { 7, 3, 3, 3, 2, 3, 1, 2, 4, 3, 2, 1, 1, 3, 7, 3, 1, 1, 2, 1, 1, 3, 1, 3, 1, 1, 2, 4, 1, 4, 4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 1, 3, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case20() {
    String[] roads = { "NNNNNNYYNNNYNNNNNNNNNNNNNNNNNNYYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNNNNYNNNNNNNNNNYNNNNNNNNNNY", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "YNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNYNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYYNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNYNYNNNNNNYNNYNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNNNYNNNYNNNNNNYNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNYNYNNNYNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNYNNNNNNNNNNNNNNNNNNNYNYNNNNNNNNNNYNNNN", "NNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNYNNNYNNNNNYNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYYNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNYNYNNNNNN", "YNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNYNYNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNYNNYNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNYYNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNYYNNNNNNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN" };
    int M = 52;
    assertArrayEquals(new int[] { 5, 1, 4, 2, 4, 1, 2, 3, 4, 2, 1, 5, 1, 5, 5, 1, 1, 2, 2, 2, 2, 2, 2, 4, 4, 1, 1, 3, 1, 2, 3, 3, 5, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case21() {
    String[] roads = { "NNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNYNNYNNNY", "NNNNNNNNNNNNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "YNNNNNYNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNYNNNNNNNNNYNNYNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNYNNNNYNNNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNYYNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNYNNNYNNNN", "YNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNYNN", "NNNNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NYNYNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNYNN", "NNNNNYNNNNNNNNNNNNNNNNNNNNNNNYNNYNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNYNNNNYNNN", "NNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN" };
    int M = 58;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case22() {
    String[] roads = { "NNNNNNNNNYNNNNNYNNNNNNYNNNYNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNYNNNN", "NNNNNYNNNNNNNNNNNYNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNNNNNYNNNNYNNNYN", "NNNNNNNNYNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNYNNNNNNYNN", "YNNNNNNNNNNNYNNNNNNNYNNNNNNNYNN", "NNNNNNNNNNNYNNNNYNNNNNNNNNNNNYN", "NYNNNNNNNNYNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNYNNNNNYYNNN", "NNNNNNNNNNNNNNNNYNNNNNNNYNNNYNN", "YNNNNNNNNNNNNNNNNNYYNNNNNNNNNNN", "NNNNNNNNNNYNNNYNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNYYNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNYNYNNNNY", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNYNNYNNNYNNNNNNNNNNNNNNNYN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNY", "YNNNNNNYNNNNNNNNNNNNNNNNNNYNNNY", "NNNYYNNNNNNNNNNNNNYNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNNYNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNYNNNNNNNNNNNY", "YYNNNNNNNNNNNYNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNYNNNNNNNNNNNNNNNNY", "NNNNNNNNYYNNNNYNNNNNNNNNNNNNNNN", "NNYNNNYNNNYNNNNNNNNNYNNNNNNNNNN", "NNNNNYNNNNNNNNNNNNYNNYYNNYNYNNN" };
    int M = 40;
    assertArrayEquals(new int[] { 4, 2, 3, 1, 1, 2, 3, 2, 3, 4, 3, 2, 2, 4, 3, 3, 2, 4, 4, 1, 4, 1, 2, 3, 2, 2, 3, 1, 3, 4, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case23() {
    String[] roads = { "NYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "YNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNYNNNNNNYNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNYNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "NNNYNNNNNNNNNNNNNNNNNNNYYNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNYN", "NNNNNNNNNNNNNYNNYNNNNNNNNNNNNNNYNNNNNN", "NNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNYNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNYNNNNNNNNNNYYNNNNYNNNNY", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNYNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNYNNN", "NNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "YNNNYNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNYNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNYNNNNNNNNNNYNNYNNNNYNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNYNNNNNYNNNNNNNNNNNN", "NNNNNNNNNNYNNNYNNNNNNNNNNNYNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNYY", "NYNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNYNNN", "NNNNNNNNNYYNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNNN" };
    int M = 39;
    assertArrayEquals(new int[] { 2, 3, 1, 3, 2, 3, 2, 2, 1, 4, 2, 3, 2, 2, 6, 1, 2, 1, 1, 2, 2, 3, 3, 1, 2, 1, 4, 2, 2, 1, 1, 1, 2, 1, 3, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case24() {
    String[] roads = { "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNYNYNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNY", "NNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNNYNNY", "NNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNN", "NNNNYNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNYNNYYNYNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNY", "NNYNNNNNNNNNNNNYNNNYYNNNYNNNNNYNNNNNNNNNNNNN", "NNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNYNYNNNNNNNNNNNNNNYYNNNNNNNNNNNNNNNNNNN", "YYNNNNNNNYNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNYNNNNNNYNNNN", "NNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNY", "NNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNY", "NNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNYNNNY", "NNNNNNNNNNNNNNNNNNNNNNYYNNNNNNNNNNNNNNYNYNNN", "YNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNN", "NNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNN", "NNYNNNYNNNYNNNNNNNNNNNNNNNNNNYNNYNYNYNYNNNNN" };
    int M = 44;
    assertArrayEquals(new int[] { 2, 3, 4, 2, 2, 1, 4, 3, 2, 4, 2, 5, 2, 1, 1, 1, 3, 2, 4, 3, 2, 1, 1, 3, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1, 5 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case25() {
    String[] roads = { "NYNNYYNNNNNNNNYNNYNNNNNNNNYNNNYNNYNYNNNNYNNYYNN", "YNNNNYNNNNNYYNNNNNYYYNNNYYNNYNYYNYNYNNYNNYNYYYN", "NNNYYNNNNYNYYYNNNYNYNNYNNYNNNYYYNYNNNNNNYNYYNYN", "NNYNNNNYYYNNNYNYYNYYYNYYNYNYNNNYYYNNNNNYYYNYYNN", "YNYNNYNNNYNYNYYNYYYYNYNNYNNNNYYYYNYNNYNNYYNNYYN", "YYNNYNYNNNYYNYNYNNYNYNNNYNNNNYNYNNNYYYYYNYNNNNY", "NNNNNYNNNNYNNYYYNNNNNNNYYNYYNYNYYNYNNNYYNYNYNYN", "NNNYNNNNNNNNNNNNYNNNYNNNNYYYYNYYYNNYNNYYYYNNNNN", "NNNYNNNNNNYYYYYNNNNNNNNNYNNYYNNYNNYNNYNYNNNYNNN", "NNYYYNNNNNNNNYYNNYNNYYNYNYNNYNNYYNYYNYNNYNYYNNN", "NNNNNYYNYNNNYYNNNYYYYNYNYYNNYNNYYYNNNNNNNNNNNNN", "NYYNYYNNYNNNNYYNYYNYNYNYYNNNNNNYYNNNNNNNNNYNNYN", "NYYNNNNNYNYNNNYYYNNNYNNNNNNNNNNYNNNNYYNNNYYNNNY", "NNYYYYYNYYYYNNNYNNYNYNYNYNNYYNYNYNNNNNYYNNNNNYY", "YNNNYNYNYYNYYNNYNYYNNNYYNNNNYNNNYYYNNNYNYNNNNYN", "NNNYNYYNNNNNYYYNYNNYYYNNYYNNNYNNNNNNYYYNYNYNNNN", "NNNYYNNYNNNYYNNYNNNNNYYNNNNYYNYNNNNYNNNYNYNNNNN", "YNYNYNNNNYYYNNYNNNNNNNNNNYYYNNNNNNNNYYYYYNNYYNY", "NYNYYYNNNNYNNYYNNNNYNYNNYNYNYYNNNYNYNYYNYNYYYNY", "NYYYYNNNNNYYNNNYNNYNNNYYNNNNNNNYYYNYNNNYNNYYNNY", "NYNYNYNYNYYNYYNYNNNNNYNNYNNYNNNYNNYNYNNYNNNNYYY", "NNNNYNNNNYNYNNNYYNYNYNYNNYNNYNNNYYNYNYNNNNYYYYN", "NNYYNNNNNNYNNYYNYNNYNYNYNYNNNNYNNNYNNNYYNNNNNNY", "NNNYNNYNNYNYNNYNNNNYNNYNNYNYYYYNNNNYNYNNNNNYNNN", "NYNNYYYNYNYYNYNYNNYNYNNNNNNYYYNYYNYNNYYNNNNNYNY", "NYYYNNNYNYYNNNNYNYNNNYYYNNNNYNNYYYYNNNNYNNNYNYN", "YNNNNNYYNNNNNNNNNYYNNNNNNNNNNNYYYNNNNNYYNYNYNNY", "NNNYNNYYYNNNNYNNYYNNYNNYYNNNNNNNYNYYNYYNYNYYNYN", "NYNNNNNYYYYNNYYNYNYNNYNYYYNNNYYNNYNNYYYYNNNNYNY", "NNYNYYYNNNNNNNNYNNYNNNNYYNNNYNYYNNNYYNYYYYNNYNN", "YYYNYNNYNNNNNYNNYNNNNNYYNNYNYYNYNNNYYNYYNYYYNNN", "NYYYYYYYYYYYYNNNNNNYYNNNYYYNNYYNNNYYYNYYNNYYNNY", "NNNYYNYYNYYYNYYNNNNYNYNNYYYYNNNNNYYNNNNNNYYNNNY", "YYYYNNNNNNYNNNYNNNYYNYNNNYNNYNNNYNYYNYYNNYYNYNY", "NNNNYNYNYYNNNNYNNNNNYNYNYYNYNNNYYYNNNNNYNNNNNYY", "YYNNNYNYNYNNNNNNYNYYNYNYNNNYNYYYNYNNNNNNNNNNYNY", "NNNNNYNNNNNNYNNYNYNNYNNNNNNNYYYYNNNNNNNYYYYNNYY", "NNNNYYNNYYNNYNNYNYYNNYNYYNNYYNNNNYNNNNNNYNYNNYY", "NYNNNYYYNNNNNYYYNYYNNNYNYNYYYYYYNYNNNNNNNYNYNYY", "NNNYNYYYYNNNNYNNYYNYYNYNNYYNYYYYNNYNYNNNNNNNNNY", "YNYYYNNYNYNNNNYYNYYNNNNNNNNYNYNNNNNNYYNNNNNNYYN", "NYNYYYYYNNNNYNNNYNNNNNNNNNYNNYYNYYNNYNYNNNYNNYY", "NNYNNNNNNYNYYNNYNNYYNYNNNNNYNNYYYYNNYYNNNYNYNYN", "YYYYNNYNYYNNNNNNNYYYNYNYNYYYNNYYNNNNNNYNNNYNYYN", "YYNYYNNNNNNNNNNNNYYNYYNNYNNNYYNNNYNYNNNNYNNYNYY", "NYYNYNYNNNNYNYYNNNNNYYNNNYNYNNNNNNYNYYYNYYYYYNN", "NNNNNYNNNNNNYYNNNYYYYNYNYNYNYNNYYYYYYYYYNYNNYNN" };
    int M = 100;
    assertArrayEquals(new int[] { 12, 19, 18, 22, 23, 13, 1, 1, 1, 3, 1, 4, 2, 4, 2, 2, 2, 3, 4, 4, 3, 1, 2, 1, 3, 3, 1, 1, 1, 2, 4, 4, 2, 4, 1, 2, 1, 1, 1, 1, 4, 3, 1, 4, 4, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case26() {
    String[] roads = { "NNNYYNYYNNYNNYNNNYYNYNYYYNYYYNNNYNNYYNYYYNNNNYN", "NNYYYYYNYNNYNYNYNNNNNYNNNNYYNNYNYYNNNNNNNYYNNNY", "NYNNYYNYNNNNNYNNNYNNYYNNNNNNYNNNNYNNNNYYNNYNNNY", "YYNNNYNYYNNNNYNYNYYYYYYNNNNYYNYNNNYYNNNYYYNNNYN", "YYYNNNYYNYYNNNNYNYYNYYYNYYNNYYNNNNNNNNYNYNYNNNN", "NYYYNNNNNYYYNNYNNYNNYNNYYNYNYYYNNYYNYYYYNNNNNYN", "YYNNYNNYNNYNYYYYYYNNNYYYNNYYNNNNNYYYNNNNYNYNNNY", "YNYYYNYNYYNNYNYNNYYYYNNNYYYYNNNYNYYNYYNNYYNNYNN", "NYNYNNNYNNNNNNYNYNNYNNNYYNNYNNYNNNNYYYNYNYYNYNN", "NNNNYYNYNNNYNYNNYNYYYNYYYNYYNYYYYNNNYNNNNYNNYYN", "YNNNYYYNNNNYNNNYNYNYYYNNYNYYNNNYNNNNYNYNYYYNNYN", "NYNNNYNNNYYNNYNYYYYYYNYNYNNNNNYNNYYYYYYNNNNNYNN", "NNNNNNYYNNNNNYNNYYNYNYNNNYNNYNYYYNNNYYNNYNYNNNN", "YYYYNNYNNYNYYNNYYYNNYNYNYNNNYNNYYYNNYNYNNNYYNNY", "NNNNNYYYYNNNNNNNNNNNNNNNYYNNYYNYNYNNNYYYYNYNNYY", "NYNYYNYNNNYYNYNNNYNNYYYNNYNNYNYNYNYNNYYYYNYNNYN", "NNNNNNYNYYNYYYNNNNNNNNYNYYYNNNNNYNYNNNYNNNNNNYN", "YNYYYYYYNNYYYYNYNNYNNYNYYNNNNYNYNNNYNNYNYNNNNNY", "YNNYYNNYNYNYNNNNNYNNNNNNNNNYNNYNNYYNNNYNNNYNNNY", "NNNYNNNYYYYYYNNNNNNNNNNNNNYNYYYYNNYYNYNNNYYNYYN", "YNYYYYNYNYYYNYNYNNNNNNNNNYNNNNNYYNNNNNNNNYNYNNN", "NYYYYNYNNNYNYNNYNYNNNNNYNYNNYNYYYNNYNNNNYNNNYNN", "YNNYYNYNNYNYNYNYYNNNNNNNNYYNNNNYNYYNNNNNNYNNNNY", "YNNNNYYNYYNNNNNNNYNNNYNNNYYYYNNNNYNNYNNNNYYYNYY", "YNNNYYNYYYYYNYYNYYNNNNNNNYNNNNNNYNNYYNNYNYNYNYN", "NNNNYNNYNNNNYNYYYNNNYYYYYNNYYYNYNYYYYNYYNNYYNNY", "YYNNNYYYNYYNNNNNYNNYNNYYNNNNNNNYNNNYYYNNNYYNYYY", "YYNYNNYYYYYNNNNNNNYNNNNYNYNNNYNNNNNNNYNYYNNNYNN", "YNYYYYNNNNNNYYYYNNNYNYNYNYNNNNNYYNNNNNNNNNNNNNY", "NNNNYYNNNYNNNNYNNYNYNNNNNYNYNNNNNNNNNNYNNYNYNNY", "NYNYNYNNYYNYYNNYNNYYNYNNNNNNNNNYYNNNNNYNNYYNYYN", "NNNNNNNYNYYNYYYNNYNYYYYNNYYNYNYNYNYNYNNNNYNNNYN", "YYNNNNNNNYNNYYNYYNNNYYNNYNNNYNYYNNNYNYYNYNYNNNY", "NYYNNYYYNNNYNYYNNNYNNNYYNYNNNNNNNNYNNNNYNNNNYNN", "NNNYNYYYNNNYNNNYYNYYNNYNNYNNNNNYNYNNNNYNYNYNYNN", "YNNYNNYNYNNYNNNNNYNYNYNNYYYNNNNNYNNNYNYNNYNYYNY", "YNNNNYNYYYYYYYNNNNNNNNNYYYYNNNNYNNNYNNNNYNNNYNY", "NNNNNYNYYNNYYNYYNNNYNNNNNNYYNNNNYNNNNNYYNYYYNYN", "YNYNYYNNNNYYNYYYYYYNNNNNNYNNNYYNYNYYNYNNYNYNNYN", "YNYYNYNNYNNNNNYYNNNNNNNNYYNYNNNNNYNNNYNNNYNYYYN", "YNNYYNYYNNYNYNYYNYNNNYNNNNNYNNNNYNYNYNYNNYNNNNN", "NYNYNNNYYYYNNNNNNNNYYNYYYNYNNYYYNNNYNYNYYNNNNYN", "NYYNYNYNYNYNYYYYNNYYNNNYNYYNNNYNYNYNNYYNNNNNYNY", "NNNNNNNNNNNNNYNNNNNNYNNYYYNNNYNNNNNYNYNYNNNNYYY", "NNNNNNNYYYNYNNNNNNNYNYNNNNYYNNYNNYYYYNNYNNYYNYN", "YNNYNYNNNYYNNNYYYNNYNNNYYNYNNNYYNNNNNYYYNYNYYNY", "NYYNNNYNNNNNNYYNNYYNNNYYNYYNYYNNYNNYYNNNNNYYNYN" };
    int M = 101;
    assertArrayEquals(new int[] { 22, 18, 14, 22, 20, 9, 5, 6, 2, 2, 3, 2, 1, 5, 1, 3, 1, 5, 3, 1, 4, 4, 3, 1, 2, 1, 2, 3, 4, 1, 2, 1, 2, 2, 1, 2, 1, 1, 3, 3, 3, 2, 3, 1, 1, 2, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case27() {
    String[] roads = { "NNNNNNYNYYNYYNNYYYNNYYNNYNNYNYNNNNYNNNYYNNN", "NNYYYNNNNYYNYYNNNNNYNNYYNYYNYNNNYNNNYNNNYNY", "NYNNNYYNNNYYYNNYNNNNYNYNYNYNNYNNNYNYNNNYNNN", "NYNNNNNNNYNNYYYYNYYNYNYNYYNYYNNYNNYYNYYNYNY", "NYNNNYYNNNYNYNYYNNNYNNYNYNNYYNNYYYNNYYYYYNY", "NNYNYNNYYYNNNYYNNNYNNNNYYYYNNNNYNYNYYNYYNYN", "YNYNYNNNNYNYYNNNYYNNNYNNYNNNYNYYNNYYNNNYNNY", "NNNNNYNNNNYNYYNNNNYNYNYNNYNNYNNNYYNYNNYYNYN", "YNNNNYNNNYNNNNYYNNYNNNNYNNNNNNNNNNYYNNNYNNN", "YYNYNYYNYNYNYNNNNNYYYNYYNNNNYNYYNYNNNNNNYNN", "NYYNYNNYNYNYYYYNNYNNNNYYNNNNNNYYNNNNNNYNYNN", "YNYNNNYNNNYNNNNYYNYNYNYNYNNYYNNNYYYNYYNNNYY", "YYYYYNYYNYYNNNYYYYYNNYYYYYNNYNNYNYNNNYNYYYN", "NYNYNYNYNNYNNNNNNNYNYYNYNNYNYNYYNYYYYNNNYNY", "NNNYYYNNYNYNYNNNYNYYNNNYYNNNYNNYYNYNNNNNYNN", "YNYYYNNNYNNYYNNNNNNNNYYNYNNNYNNNNNNNNNNYYYY", "YNNNNNYNNNNYYNYNNNNYNNNYYNNNYYYNYNNNYYYNNNN", "YNNYNNYNNNYNYNNNNNNYNNNNNYNNYNYYNNNNNNNNYYY", "NNNYNYNYYYNYYYYNNNNNNYNNNNNNNYNYNYNNYNNYNYN", "NYNNYNNNNYNNNNYNYYNNNYNYYYNYNYYYYYNNYYYNYYN", "YNYYNNNYNYNYNYNNNNNNNNYNNYNYNNYNNYYNNNYNNNN", "YNNNNNYNNNNNYYNYNNYYNNNYNYNNNNNYYNNYYYNNYNY", "NYYYYNNYNYYYYNNYNNNNYNNNNYNNYNYYYYYNNNYYNNY", "NYNNNYNNYYYNYYYNYNNYNYNNNNNNNYNNNNNNNNNYYYY", "YNYYYYYNNNNYYNYYYNNYNNNNNNYNYNNNNYYYNYNYYYY", "NYNYNYNYNNNNYNNNNYNYYYYNNNYNYNYYYNYNNNNNNNN", "NYYNNYNNNNNNNYNNNNNNNNNNYYNNNYNYNYNYNYYYNYY", "YNNYYNNNNNNYNNNNNNNYYNNNNNNNYNYNYNNNNNNNNYY", "NYNYYNYYNYNYYYYYYYNNNNYNYYNYNNNNNNNNYYNYYNY", "YNYNNNNNNNNNNNNNYNYYNNNYNNYNNNYNNYYYNYNYNNN", "NNNNNNYNNYYNNYNNYYNYYNYNNYNYNYNYNNYYYNNYNYN", "NNNYYYYNNYYNYYYNNYYYNYYNNYYNNNYNNNNYNNYNNNN", "NYNNYNNYNNNYNNYNYNNYNYYNNYNYNNNNNNNNNNYNNYN", "NNYNYYNYNYNYYYNNNNYYYNYNYNYNNYNNNNYNYNNNNNN", "YNNYNNYNYNNYNYYNNNNNYNYNYYNNNYYNNYNNNNNYNYN", "NNYYNYYYYNNNNYNNNNNNNYNNYNYNNYYYNNNNNNYYNYY", "NYNNYYNNNNNYNYNNYNYYNYNNNNNNYNYNNYNNNNNNNNY", "NNNYYNNNNNNYYNNNYNNYNYNNYNYNYYNNNNNNNNNYNNY", "YNNYYYNYNNYNNNNNYNNYYNYNNNYNNNNYYNNYNNNYYYY", "YNYNYYYYYNNNYNNYNNYNNNYYYNYNYYYNNNYYNYYNNYN", "NYNYYNNNNYYNYYYYNYNYNYNYYNNNYNNNNNNNNNYNNYY", "NNNNNYNYNNNYYNNYNYYYNNNYYNYYNNYNYNYYNNYYYNN", "NYNYYNYNNNNYNYNYNYNNNYYYYNYYYNNNNNNYYYYNYNN" };
    int M = 104;
    assertArrayEquals(new int[] { 16, 17, 15, 21, 21, 18, 4, 1, 2, 4, 3, 2, 5, 3, 3, 4, 1, 2, 2, 2, 3, 1, 4, 2, 5, 3, 3, 3, 3, 2, 1, 3, 2, 3, 2, 3, 3, 2, 4, 3, 3, 1, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case28() {
    String[] roads = { "NYNYNYYYNYNNYYNYNYNYYYNYYYNNNNNYYYNNYNYNYYYNNY", "YNYYNNNYNNNNNNNNNYYNYYNYNNNNNYYYYYYNNNYNNNYNYN", "NYNNNYYYNYYNYNYYNNNNNYNYNNYYNNNYNNYNYNNYYNNNYN", "YYNNNYYYNYYNYYNNYNYNNYNNNYNNYNNNNYNYNYYYNNYNYN", "NNNNNYYNNNYNNNNNYYNNNNNYYNNNNYNNYYNNNYNYYNNYNY", "YNYYYNNNYNNNYNNNNNNNNNNYYYNNYYNNYYYNNNYNNNNNYN", "YNYYYNNNNYYYNNNNNNYYNNNNNNNNYNYNYNNNNYNYNYNNNN", "YYYYNNNNNNNNYNYNYNYNYNNYNNYYYNYYYYYNNNYNNYYYYY", "NNNNNYNNNNNNYYNNNNYNNNYNYNYNYYYNNYYNYNNYNYNNNN", "YNYYNNYNNNNNNYYYNNNNNYNYNNNNNNNYYNNNNYYNYNNNNN", "NNYYYNYNNNNYNYNYNNNYNNYYNNYNNYNYNYYYYNNNYYNNYY", "NNNNNNYNNNYNYNNNYNNYNNYYYNNNNNNYNYYYNNNYNNNNYY", "YNYYNYNYYNNYNNNYYYNNNYYYYNNYNNYNYNNYYNNYNNYNNN", "YNNYNNNNYYYNNNYNNNNNYNYYYNYNYYYNNNNNNYYYNNNYNN", "NNYNNNNYNYNNNYNYNNNNNNYYNYYYNNNNYYNNNYNNNYYNYY", "YNYNNNNNNYYNYNYNNNNNNYNNYYYNNNYNNNYNNYYYYYNNYY", "NNNYYNNYNNNYYNNNNNYNYNYNYNYNYNNNNNYNNNYNNYNNNN", "YYNNYNNNNNNNYNNNNNNNNYNNYNNNNYNYNYNNNYNNYYNYYY", "NYNYNNYYYNNNNNNNYNNNNNNNNYNNNNNNYNNNNNYNNNYNNN", "YNNNNNYNNNYYNNNNNNNNNNNYNNNNYNNNYYNNYYYYNYYNNY", "YYNNNNNYNNNNNYNNYNNNNNYNNYYYNYNYYYNYYNNNNNNNNN", "YYYYNNNNNYNNYNNYNYNNNNNNNYYYNNYYNNNNNNNYNYYNYY", "NNNNNNNNYNYYYYYNYNNNYNNNNNNNNYYNYNYYNNNNYYNYNY", "YYYNYYNYNYYYYYYNNNNYNNNNNYNNYNYYNNYNYNNNNNYNNY", "YNNNYYNNYNNYYYNYYYNNNNNNNNNYYYNNNNYNYNYNNNYYNN", "YNNYNYNNNNNNNNYYNNYNYYNYNNNNYYNNYYNYNNYNYYNYNY", "NNYNNNNYYNYNNYYYYNNNYYNNNNNYYYYNYNNNYNYNNNNNYN", "NNYNNNNYNNNNYNYNNNNNYYNNYNYNNNYYYYYNNYYNNNNNNY", "NNNYNYYYYNNNNYNNYNNYNNNYYYYNNNNYNYNNYNNNYYYNNN", "NYNNYYNNYNYNNYNNNYNNYNYNYYYNNNNNNYNNNYNNNNYNNY", "NYNNNNYYYNNNYYNYNNNNNYYYNNYYNNNNNNNNNNYNYNYYYN", "YYYNNNNYNYYYNNNNNYNNYYNYNNNYYNNNYYNYYYYNYYNNNN", "YYNNYYYYNYNNYNYNNNYYYNYNNYYYNNNYNNYYNYYNNYNNYN", "YYNYYYNYYNYYNNYNNYNYYNNNNYNYYYNYNNNNYYNYNYYYNY", "NYYNNYNYYNYYNNNYYNNNNNYYYNNYNNNNYNNNYYNNYNYYNN", "NNNYNNNNNNYYYNNNNNNNYNYNNYNNNNNYYNNNNNYNNNNYNN", "YNYNNNNNYNYNYNNNNNNYYNNYYNYNYNNYNYYNNYYYNYYNNN", "NNNYYNYNNYNNNYYYNYNYNNNNNNNYNYNYYYYNYNNYNNNNNY", "YYNYNYNYNYNNNYNYYNYYNNNNYYYYNNYYYNNYYNNYNYNNNY", "NNYYYNYNYNNYYYNYNNNYNYNNNNNNNNNNNYNNYYYNNYYYYN", "YNYNYNNNNYYNNNNYNYNNNNYNNYNNYNYYNNYNNNNNNNNYNN", "YNNNNNYYYNYNNNYYYYNYNYYNNYNNYNNYYYNNYNYYNNYNYN", "YYNYNNNYNNNNYNYNNNYYNYNYYNNNYYYNNYYNYNNYNYNNNY", "NNNNYNNYNNNNNYNNNYNNNNYNYYNNNNYNNYYYNNNYYNNNNN", "NYYYNYNYNNYYNNYYNYNNNYNNNNYNNNYNYNNNNNNYNYNNNY", "YNNNYNNYNNYYNNYYNYNYNYYYNYNYNYNNNYNNNYYNNNYNYN" };
    int M = 94;
    assertArrayEquals(new int[] { 25, 18, 19, 21, 12, 5, 5, 4, 2, 3, 3, 1, 3, 2, 1, 2, 2, 3, 2, 1, 2, 4, 1, 4, 2, 2, 1, 1, 1, 2, 1, 3, 3, 4, 2, 1, 2, 2, 3, 2, 2, 1, 3, 1, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case29() {
    String[] roads = { "NNNYNYYYNNYYYNYNYYYNYYYYYYNNNNNNYYYNYNYNYYYNY", "NNYYNYYNNNYNNYNNNYNNYYYNNYYNNYNNYNNNYNNNNYNNY", "NYNYNNNYYYYNNNYNNNNNNNNNNNYYNYNYNNNNNYYYYNNYN", "YYYNNNNYYYYNNYYYNNNNNYYYYNYNYNNYYNNNNYNYYNYNY", "NNNNNYNNYNNYYYYNNYNYNNYNNYNYNYYNNYYNYYNNNNYNN", "YYNNYNYYYYNYNNYYYYNNYYNYYNYNYNYNNNNNYNYNYNNNN", "YYNNNYNNNYNYNNNYNNYNNNNNNYNNNYNYYNYYNYYNYNYYY", "YNYYNYNNNYYNYNNNYYNNNNYNYNNNYYYYNNNYNYNYNNNYN", "NNYYYYNNNYYYNYNYNNNYNYYYYNYNNNNNNYYNNYNNYNYNN", "NNYYNYYYYNYYNYYYYNNNNNNNYNNNYYYNNNNNYNNYYYNYY", "YYYYNNNYYYNNNNNNNNNNYYNYYNNNNNYNNNYYNNYNYNYNY", "YNNNYYYNYYNNNNNYNNNNNNYYNNNNYNNYNNNNYNNYNYNYY", "YNNNYNNYNNNNNYNNYYNNNNYYNYNNNYNNNNNNYNNNNNNNY", "NYNYYNNNYYNNYNNYYNNNNYYNYNYYNYYNNNNYYYNNNNYYN", "YNYYYYNNNYNNNNNNNNNYYNNYNNYNYNNNNNYNYNYNNNNNN", "NNNYNYYNYYNYNYNNNNNYYNNNNYYYYYNNYYNNYNNNNNNNN", "YNNNNYNYNYNNYYNNNNNYYNNYNNYYYNNYNNNNNNYYNNYYY", "YYNNYYNYNNNNYNNNNNYNYYNNYNYYNNYYYNNNNNNNNNNNN", "YNNNNNYNNNNNNNNNNYNYNYNNYNNNNNYYNNYNYNNNNNYNY", "NNNNYNNNYNNNNNYYYNYNNNNNYYNNYNYNNNNNNYYYNNNYN", "YYNNNYNNNNYNNNYYYYNNNYNYNNNNYNNNNNYNNNNYNNYNY", "YYNYNYNNYNYNNYNNNYYNYNYNNNNNYNYYYYNYNYYYYYNYN", "YYNYYNNYYNNYYYNNNNNNNYNYNNNNNYNNYNNYYNNNNNNNY", "YNNYNYNNYNYYYNYNYNNNYNYNNNNNYNNNNNNNYNYYNYYYN", "YNNYNYNYYYYNNYNNNYYYNNNNNNNYNNYYYYNNYYNNYNYNY", "YYNNYNYNNNNNYNNYNNNYNNNNNNYNNYNYNYNNYNNNNYYNN", "NYYYNYNNYNNNNYYYYYNNNNNNNYNNNNNNYYYYNYYNNNNYN", "NNYNYNNNNNNNNYNYYYNNNNNNYNNNYYNNYNNNYYNYYNNNN", "NNNYNYNYNYNYNNYYYNNYYYNYNNNYNNNYYYYNYYNNNNYYN", "NYYNYNYYNYNNYYNYNNNNNNYNNYNYNNNYNYYNNYNNNNYNN", "NNNNYYNYNYYNNYNNNYYYNYNNYNNNNNNYNYYNNYNNNNYNN", "NNYYNNYYNNNYNNNNYYYNNYNNYYNNYYYNYYNNYNNNNYYYY", "YYNYNNYNNNNNNNNYNYNNNYYNYNYYYNNYNYYNNYNNNYNNN", "YNNNYNNNYNNNNNNYNNNNNYNNYYYNYYYYYNNYYNYNNNYYY", "YNNNYNYNYNYNNNYNNNYNYNNNNNYNYYYNYNNNNYNNYYNNN", "NNNNNNYYNNYNNYNNNNNNNYYNNNYNNNNNNYNNNNNNNYNYY", "YYNNYYNNNYNYYYYYNNYNNNYYYYNYYNNYNYNNNYNNNYYYN", "NNYYYNYYYNNNNYNNNNNYNYNNYNYYYYYNYNYNYNNNNNNYN", "YNYNNYYNNNYNNNYNYNNYNYNYNNYNNNNNNYNNNNNYYYNNY", "NNYYNNNYNYNYNNNNYNNYYYNYNNNYNNNNNNNNNNYNYYYNN", "YNYYNYYNYYYNNNNNNNNNNYNNYNNYNNNNNNYNNNYYNYNYN", "YYNNNNNNNYNYNNNNNNNNNYNYNYNNNNNYYNYYYNYYYNYYY", "YNNYYNYNYNYNNYNNYNYNYNNYYYNNYYYYNYNNYNNYNYNYN", "NNYNNNYYNYNYNYNNYNNYNYNYNNYNYNNYNYNYYYNNYYYNY", "YYNYNNYNNYYYYNNNYNYNYNYNYNNNNNNYNYNYNNYNNYNYN" };
    int M = 101;
    assertArrayEquals(new int[] { 26, 17, 16, 23, 18, 7, 4, 4, 4, 3, 4, 2, 2, 3, 4, 1, 1, 3, 1, 1, 2, 3, 4, 2, 2, 3, 3, 2, 1, 3, 1, 2, 3, 2, 2, 1, 3, 3, 2, 2, 3, 2, 3, 1, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case30() {
    String[] roads = { "NYNNYYYYNYNNNYYNNNYNNNYYYNNNYYNYNNYNYYNNNNNYNNN", "YNYNNNYYYNYNNYYNNYNNNNYYYNYYNNNNYNNNYYNYYYYYNNY", "NYNNYNNYNNYNYYYNNNNYNYYNYYNNYYYYNNNYYYNYNNYNNYN", "NNNNYYNNYYYNNNNNNYNNNNYNYNYNYNNYNYNYNNNYNNNNNNN", "YNYYNNYNYNNNYNYYNNYNNNYYNYNNNNYYNNYYNYNYYYYNNNN", "YNNYNNYYYNNYNYYYYYNNNYYYYNNNYYYYYNYYYYNNYNNYNYY", "YYNNYYNYNNYYNNYYNNNYNNNYNYYNNNNNNNNNNNYYNNYNNYN", "YYYNNYYNNNNYNNYYNYYNYNNYYNYYNYNYNNYNNYYYNNNYNNY", "NYNYYYNNNNNYNNNNNNYNYYNYNNNYYYNYNYNYNNNNNNNNNYN", "YNNYNNNNNNNNYYNYNNNNNNNNNNNYNYNYNYNYYYNYYYYNNNY", "NYYYNNYNNNNNNNNYYNYYNNNYNNNNYNYYNNYNNYNNNNNYNYN", "NNNNNYYYYNNNNNYYYYYNNYNNNNYNNYYYYNNYYNNYYYNNYNY", "NNYNYNNNNYNNNNYYNNNYNNYYYNNYYNNNYYYNYYYNYYYNYNN", "YYYNNYNNNYNNNNNYYNNYNNNNNNNYNYNYNYYYNNYNNNNYNNY", "YYYNYYYYNNNYYNNNYNNYYYNNNNNNNNYYYNNYNNNYYYNYNYN", "NNNNYYYYNYYYYYNNNNNYNYYNYYNYYNYNNNYNYNNYNYNNNNN", "NNNNNYNNNNYYNYYNNNNNYYYYNNNNYNYNNYYYYNYYNYNNYNN", "NYNYNYNYNNNYNNNNNNYNYYNYNYYYYYNYNYNNYYNNNNNNNNN", "YNNNYNNYYNYYNNNNNYNYNNYNYYNNYNNNYNNYNYNYYNYYNYY", "NNYNNNYNNNYNYYYYNNYNYNNYYNNYNNNNNNNNYYNYNNNNYYN", "NNNNNNNYYNNNNNYNYYNYNYNNYYNNYYNNYNNNYNYNNYYYNYY", "NNYNNYNNYNNYNNYYYYNNYNYYNNNNNNNYNYNYNNNNYNNNNYN", "YYYYYYNNNNNNYNNYYNYNNYNNNNNNYNYNNYNNNNYNYYNNYYN", "YYNNYYYYYNYNYNNNYYNYNYNNYNYYNNYNNYNYYYNYNNNNNYN", "YYYYNYNYNNNNYNNYNNYYYNNYNNNYNYNYNNYYNNYNNYNYNNN", "NNYNYNYNNNNNNNNYNYYNYNNNNNNNYNNNNNYNNYYNNNNNNNY", "NYNYNNYYNNNYNNNNNYNNNNNYNNNYYNNYNNNYNNNYYNNNNNN", "NYNNNNNYYYNNYYNYNYNYNNNYYNYNYNYNNNYYYYNYNYYYYNN", "YNYYNYNNYNYNYNNYYYYNYNYNNYYYNNYYNYYNNYNNYNYNNYN", "YNYNNYNYYYNYNYNNNYNNYNNNYNNNNNYNNNNNNNYNNNNNYNN", "NNYNYYNNNNYYNNYYYNNNNNYYNNNYYYNYNNNNYNNNNNNNNNY", "YNYYYYNYYYYYNYYNNYNNNYNNYNYNYNYNNNNNNYNNNNYNNNN", "NYNNNYNNNNNYYNYNNNYNYNNNNNNNNNNNNYNNNYNNNNNNNNN", "NNNYNNNNYYNNYYNNYYNNNYYYNNNNYNNNYNNYYYNNYYNNNNN", "YNNNYYNYNNYNYYNYYNNNNNNNYYNYYNNNNNNNYNYYYYYNNYN", "NNYYYYNNYYNYNYYNYNYNNYNYYNYYNNNNNYNNNYYNYNYYNNN", "YYYNNYNNNYNYYNNYYYNYYNNYNNNYNNYNNYYNNNYNYNNNNNN", "YYYNYYNYNYYNYNNNNYYYNNNYNYNYYNNYYYNYNNYYNNNYNNN", "NNNNNNYYNNNNYYNNYNNNYNYNYYNNNYNNNNYYYYNNNNYNYNN", "NYYYYNYYNYNYNNYYYNYYNNNYNNYYNNNNNNYNNYNNYNNNNNN", "NYNNYYNNNYNYYNYNNNYNNYYNNNYNYNNNNYYYYNNYNNNYNNN", "NYNNYNNNNYNYYNYYYNNNYNYNYNNYNNNNNYYNNNNNNNYNYYN", "NYYNYNYNNYNNYNNNNNYNYNNNNNNYYNNYNNYYNNYNNYNNYNN", "YYNNNYNYNNYNNYYNNNYNYNNNYNNYNNNNNNNYNYNNYNNNYYN", "NNNNNNNNNNNYYNNNYNNYNNYNNNNYNYNNNNNNNNYNNYYYNNY", "NNYNNYYNYNYNNNYNNNYYYYYYNNNNYNNNNNYNNNNNNYNYNNN", "NYNNNYNYNYNYNYNNNNYNYNNNNYNNNNYNNNNNNNNNNNNNYNN" };
    int M = 104;
    assertArrayEquals(new int[] { 19, 23, 22, 14, 21, 9, 5, 5, 4, 2, 3, 2, 2, 4, 5, 1, 1, 2, 2, 1, 1, 1, 5, 3, 4, 2, 2, 1, 3, 2, 2, 4, 1, 1, 2, 3, 3, 4, 1, 4, 2, 2, 3, 2, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case31() {
    String[] roads = { "NNNYNYNYYNNNNYYYYYNNNNNNYNNNNYN", "NNYNYNYYYYNYNNNYYNYYYNNNYNNYNNY", "NYNNNNYYNNNNNYNNNNNNYNYYNNNYNNY", "YNNNNNNNNNYNNNYYNNNYYYNNYNYYNYY", "NYNNNYNYYYYYYNYYYYYNNNYNYNNNNNY", "YNNNYNYNYYYYNYNNNNNNYNNYNYYNNYN", "NYYNNYNNNNNYYNNNNYNYNNNYNNNYYNN", "YYYNYNNNNNNNNYYYYYNNNNNYNYNYYNY", "YYNNYYNNNNNNYYNNNNYNNNNNYYYYNYN", "NYNNYYNNNNNNNYYYNNYNNNYNYYYNNNY", "NNNYYYNNNNNYYYNNNYYNNNNYNNYYNNN", "NYNNYYYNNNYNNNYYYYYNYNNYNYYNNNY", "NNNNYNYNYNYNNYYYYYYNYNYNYNNYNYY", "YNYNNYNYYYYNYNNYNYYNYNYYNNNYNNN", "YNNYYNNYNYNYYNNNNNNNYNNYNYNYYNY", "YYNYYNNYNYNYYYNNNNNYYYNYYNNNNYN", "YYNNYNNYNNNYYNNNNNYYNNNNYYNNNYN", "YNNNYNYYNNYYYYNNNNNNNYYYNNNNYYN", "NYNNYNNNYYYYYYNNYNNYNYNYYNNNNNN", "NYNYNNYNNNNNNNNYYNYNYYNYNNYNNNN", "NYYYNYNNNNNYYYYYNNNYNYNYYNYYNNY", "NNNYNNNNNNNNNNNYNYYYYNYYYYNNNNN", "NNYNYNNNNYNNYYNNNYNNNYNYNNYNNYN", "NNYNNYYYNNYYNYYYNYYYYYYNYYNNNNN", "YYNYYNNNYYNNYNNYYNYNYYNYNNYNYNN", "NNNNNYNYYYNYNNYNYNNNNYNYNNNYNYY", "NNNYNYNNYYYYNNNNNNNYYNYNYNNNNNN", "NYYYNNYYYNYNYYYNNNNNYNNNNYNNNYY", "NNNNNNYYNNNNNNYNNYNNNNNNYNNNNNY", "YNNYNYNNYNNNYNNYYYNNNNYNNYNYNNY", "NYYYYNNYNYNYYNYNNNNNYNNNNYNYYYN" };
    int M = 76;
    assertArrayEquals(new int[] { 11, 15, 9, 12, 16, 13, 8, 4, 4, 3, 3, 4, 2, 3, 3, 4, 3, 3, 2, 3, 4, 1, 2, 2, 4, 1, 2, 3, 1, 3, 4 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case32() {
    String[] roads = { "NNNNYYYYNYYNYNNYNNNNYYYNNYYYNNYNNNYNNNNN", "NNNNNNNNNNNNNNNNYYNYYNNNNNNNNNYNNNNYNNNY", "NNNYYYNNYNNYNNNYYYYNYNYNNNNYYNYNNNNYYNYY", "NNYNNYYYNNNYNYNNNYYNYYYNYNYYYYNNYYNYNYYY", "YNYNNNNNNNNNNYNNYYYYYYYYNNNNNNYNYYNNNYNN", "YNYYNNNNNYNYYNYNYYNYYYYYNNYNYNNNYYYYNYNN", "YNNYNNNYNYYNNYYNNNNNNNNNNYNNYNNNNYNNYYNY", "YNNYNNYNNNNNNNNNYYNNNNNYNYYNNYNYYYYNYNYY", "NNYNNNNNNNNNNYNYNYNNNNYYYYNYNNNNYYYYNNYY", "YNNNNYYNNNNYYYNNYNNYYNNNNNYNYYNYYYYYYNYY", "YNNNNNYNNNNYNYYNNYNNYNNNYNYYYYNYNYNNNYNN", "NNYYNYNNNYYNNNYYYNNNYYNNNNNYNNNYNNYNNYYN", "YNNNNYNNNYNNNNYYNYNYNYYYNNNYYYYNNNNNNYNY", "NNNYYNYNYYYNNNNNYNNNNYYYYNNNNNNNYYYYNYYY", "NNNNNYYNNNYYYNNYNNNNNNNYYNNYNYYYYNNYYYYY", "YNYNNNNNYNNYYNYNNNNNNNNNYNYNNNYYNNNNYNNY", "NYYNYYNYNYNYNYNNNNNYYNNNYNNNNNNNNYYYNNNN", "NYYYYYNYYNYNYNNNNNNNYYYYNYNYNYNNNNNNNNYN", "NNYYYNNNNNNNNNNNNNNYNYYNNYYNNYYYNNYYYYNN", "NYNNYYNNNYNNYNNNYNYNYNYNYYNNYYNYYNNNNNYY", "YYYYYYNNNYYYNNNNYYNYNNYNNYYYNYNYYNNYNNNN", "YNNYYYNNNNNYYYNNNYYNNNYNNNYYNNNNNNYYYYYN", "YNYYYYNNYNNNYYNNNYYYYYNNYYYNNYNNNNYNYYNN", "NNNNYYNYYNNNYYYNNYNNNNNNYNNNYNNNNNYNNYNN", "NNNYNNNNYNYNNYYYYNNYNNYYNYNYYNNNNNNNNNNY", "YNNNNNYYYNNNNNNNNYYYYNYNYNNYYYYNNNYYNYYY", "YNNYNYNYNYYNNNNYNNYNYYYNNNNYNNNNNYNNYNYN", "YNYYNNNNYNYYYNYNNYNNYYNNYYYNNNNNYNYYNYNY", "NNYYNYYNNYYNYNNNNNNYNNNYYYNNNNNYNNNYNNYN", "NNNYNNNYNYYNYNYNNYYYYNYNNYNNNNNNYNYNNYNY", "YYYNYNNNNNNNYNYYNNYNNNNNNYNNNNNYNYNYNNYN", "NNNNNNNYNYYYNNYYNNYYYNNNNNNNYNYNYYNNYNYN", "NNNYYYNYYYNNNYYNNNNYYNNNNNNYNYNYNNYNYNNY", "NNNYYYYYYYYNNYNNYNNNNNNNNNYNNNYYNNNNNNNN", "YNNNNYNYYYNYNYNNYNYNNYYYNYNYNYNNYNNNNYYY", "NYYYNYNNYYNNNYYNYNYNYYNNNYNYYNYNNNNNNNYY", "NNYNNNYYNYNNNNYYNNYNNYYNNNYNNNNYYNNNNNNY", "NNNYYYYNNNYYYYYNNNYNNYYYNYNYNYNNNNYNNNNY", "NNYYNNNYYYNYNYYNNYNYNYNNNYYNYNYYNNYYNNNY", "NYYYNNYYYYNNYYYYNNNYNNNNYYNYNYNNYNYYYYYN" };
    int M = 81;
    assertArrayEquals(new int[] { 16, 7, 18, 22, 15, 8, 2, 3, 1, 2, 1, 3, 2, 2, 1, 2, 4, 4, 3, 2, 5, 3, 4, 1, 1, 1, 2, 3, 2, 1, 4, 1, 2, 2, 1, 3, 1, 2, 2, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case33() {
    String[] roads = { "NYNYYYYNYNYNNNYYNNNNYYNNYNYNNYNNNNNNNYYN", "YNNNNNNNYNYYNYYNYNYNYYNYNYNYYNYNNYYNYYYY", "NNNNNNYYNNNYNNYNNNYNYNNNNNNYYYNNYYYYNNNY", "YNNNNYNNNYNNNYNNNYNYNYNNNYYYNNNNYYYYNNNY", "YNNNNNYNNYNYYYYNYNNNYNNNNNNYYYNYNNYYNYNN", "YNNYNNNYNNNNNYYYNNYNYYYYYYNNNNYNNNNYYNNN", "YNYNYNNNNNNNNNYNNNNNNYNYYNNNNNYNYNYNNYNY", "NNYNNYNNNNNNNYYYYYNYYNYYNNYNNNNNNYNNNYNY", "YYNNNNNNNNNNNNNNYNNNYNNNNNNYYNNNNNYYNYYN", "NNNYYNNNNNYNNYNYYYNNYYNNNNYYYNYNNYNYNNNN", "YYNNNNNNNYNNYNYYNNYNYNNNNNNYNNNNYNNNYYNY", "NYYNYNNNNNNNNYYNNNYNYNYNYYYYNNYNNNYNNNNY", "NNNNYNNNNNYNNYYNNNNNYYNYYYNYNYNNYYNNNNYN", "NYNYYYNYNYNYYNYNYNYYNYNNYYNNNNNYYNNNNYNN", "YYYNYYYYNNYYYYNNYNNYYNNNYYYNYNYNNNNYNNNN", "YNNNNYNYNYYNNNNNNNYNNYNNYYNNYYNNNYYYNYNY", "NYNNYNNYYYNNNYYNNYYNYYNNNNNNYYNNNYNNNNYY", "NNNYNNNYNYNNNNNNYNYNNNNNYNYNNYNNNYYNYNNN", "NYYNNYNNNNYYNYNYYYNNNYNYYNNYNNNYYNNNYNNN", "NNNYNNNYNNNNNYYNNNNNNYNNYNNYYYYYNNNYNNNN", "YYYNYYNYYYYYYNYNYNNNNNNNNYYNNYNYNNNYNYYY", "YYNYNYYNNYNNYYNYYNYYNNNYNNNNNNYYNYNNNYNN", "NNNNNYNYNNNYNNNNNNNNNNNYNNNYYNNYYYNNYYNY", "NYNNNYYYNNNNYNNNNNYNNYYNNNNYYNNNNNYYYNYN", "YNNNNYYNNNNYYYYYNYYYNNNNNNNNNNYNYYNNNNYN", "NYNYNYNNNNNYYYYYNNNNYNNNNNYNYNNNYNNYNNYN", "YNNYNNNYNYNYNNYNNYNNYNNNNYNNNYNNNYYYYYNY", "NYYYYNNNYYYYYNNNNNYYNNYYNNNNNYNNNNYYNNNN", "NYYNYNNNYYNNNNYYYNNYNNYYNYNNNYNNNNYNNYYY", "YNYNYNNNNNNNYNNYYYNYYNNNNNYYYNNYYYNYNYNN", "NYNNNYYNNYNYNNYNNNNYNYNNYNNNNNNNNYNYYNYY", "NNNNYNNNNNNNNYNNNNYYYYYNNNNNNYNNYNYNNNYN", "NNYYNNYNNNYNYYNNNNYNNNYNYYNNNYNYNNNNNNNN", "NYYYNNNYNYNNYNNYYYNNNYYNYNYNNYYNNNYYYNNN", "NYYYYNYNYNNYNNNYNYNNNNNYNNYYYNNYNYNYNYYN", "NNYYYYNNYYNNNNYYNNNYYNNYNYYYNYYNNYYNNYNN", "NYNNNYNNNNYNNNNNNYYNNNYYNNYNNNYNNYNNNNNY", "YYNNYNYYYNYNNYNYNNNNYYYNNNYNYYNNNNYYNNYY", "YYNNNNNNYNNNYNNNYNNNYNNYYYNNYNYYNNYNNYNY", "NYYYNNYYNNYYNNNYYNNNYNYNNNYNYNYNNNNNYYYN" };
    int M = 82;
    assertArrayEquals(new int[] { 16, 21, 14, 15, 16, 5, 3, 2, 2, 2, 2, 3, 1, 4, 4, 1, 2, 1, 2, 1, 4, 3, 1, 1, 1, 2, 2, 4, 3, 3, 1, 1, 2, 3, 4, 3, 1, 3, 2, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case34() {
    String[] roads = { "NYNNYYNYNYYNNNNNNYNNYYYYNNYNNYNY", "YNNNYYNNNNNNYNYNYYYNYYNYNNNNNNYN", "NNNYNNYYNYYNYNNYYNNNNNNYNYNNYYYY", "NNYNYYNNNNNNYNYNNNYNNYNNYYYYNNNN", "YYNYNNNNYYYNNNYYYYNYNNNYNYYYYNNN", "YYNYNNNNYYYYYYNNNYNNNNYNYYNYNNNY", "NNYNNNNYYNNNNNYNNYNNNYNNNNYNNYNN", "YNYNNNYNYYNNNNNNYYNNNNNYYNNYYNNN", "NNNNYYYYNNYNNNNNNYNNNYNNNNNNNNYY", "YNYNYYNYNNNYNNNNYNYNNNYYNNYNNNYY", "YNYNYYNNYNNNNYNYNYYNYNNNYNNYNNYN", "NNNNNYNNNYNNYNNYYNNNYYNYYYNNYYNY", "NYYYNYNNNNNYNNYYNNYYNYNYNYNNYYYY", "NNNNNYNNNNYNNNYNNYYYYNNNNNNNNNNN", "NYNYYNYNNNNNYYNYNYNYNYNYYYNNYYNN", "NNYNYNNNNNYYYNYNYNNNYYYNNYYNNNYY", "NYYNYNNYNYNYNNNYNYNYNYYNNNYNYNYN", "YYNNYYYYYNYNNYYNYNNNYNNNYNNYYYYN", "NYNYNNNNNYYNYYNNNNNNYYNNYYYNNNYN", "NNNNYNNNNNNNYYYNYNNNNYNNYNNNYNNY", "YYNNNNNNNNYYNYNYNYYNNNNNYNNYYYYN", "YYNYNNYNYNNYYNYYYNYYNNYNNNNYYYNN", "YNNNNYNNNYNNNNNYYNNNNYNNYNNYNNNY", "YYYNYNNYNYNYYNYNNNNNNNNNNNYNNNYN", "NNNYNYNYNNYYNNYNNYYYYNYNNNNNYNYN", "NNYYYYNNNNNYYNYYNNYNNNNNNNNNNYYN", "YNNYYNYNNYNNNNNYYNYNNNNYNNNNYNNY", "NNNYYYNYNNYNNNNNNYNNYYYNNNNNNNNY", "NNYNYNNYNNNYYNYNYYNYYYNNYNYNNYYY", "YNYNNNYNNNNYYNYNNYNNYYNNNYNNYNNN", "NYYNNNNNYYYNYNNYYYYNYNNYYYNNYNNY", "YNYNNYNNYYNYYNNYNNNYNNYNNNYYYNYN" };
    int M = 77;
    assertArrayEquals(new int[] { 14, 12, 14, 11, 16, 15, 4, 3, 3, 4, 4, 1, 4, 1, 4, 2, 3, 4, 2, 1, 2, 3, 2, 4, 2, 4, 3, 3, 2, 2, 2, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case35() {
    String[] roads = { "NYYYYNNNYNYNYYNYNNYYYNNYNYYYNYNYYN", "YNNYYYYNYYNNYYNNYNYYNNNNNNYNNNNYNY", "YNNYYNYYNYYYNYYYYNYNYNYYYYYNNNYNYY", "YYYNYNYNNYNYYYYYYYNNNNNYNNYNNYYNNY", "YYYYNYNNYYNNNNYYNYNNYNNYNYYYNNYNNN", "NYNNYNYYNNNYNYNNNNNYNYNNYNNNNNNYNN", "NYYYNYNNYNNNYNYYYYNYYYNYYYNYYYNNNN", "NNYNNYNNYYNYNNNNNNYNNYNNNNYNNNNNNY", "YYNNYNYYNNNNNNNNYNNNYYNYNYYYYYYNNY", "NYYYYNNYNNNNNNYYNNNYNNNYNNYYNYNYNY", "YNYNNNNNNNNYYYNYNYYNYYNNNNYNYNNNYN", "NNYYNYNYNNYNYNNNYYNNYYYYYNNNYNNNNN", "YYNYNNYNNNYYNYYNYYYYNYYNNYYNNNNYNN", "YYYYNYNNNNYNYNNNYYYNNNNNYYNYNNYYNN", "NNYYYNYNNYNNYNNNNNNNYNNNYNNYNNYNNN", "YNYYYNYNNYYNNNNNNYYYYNNYNYNNYNYYNN", "NYYYNNYNYNNYYYNNNNNNNNYYNYYYNYNYNY", "NNNYYNYNNNYYYYNYNNNYYNYNYNNYNYNNNY", "YYYNNNNYNNYNYYNYNNNNNNNYYNNYYNNYNY", "YYNNNYYNNYNNYNNYNYNNNYYNNNYNYNYNNN", "YNYNYNYNYNYYNNYYNYNNNNNNNYNYNNNYNN", "NNNNNYYYYNYYYNNNNNNYNNYYNYNNNYNYYN", "NNYNNNNNNNNYYNNNYYNYNYNYNNYYNNYNNY", "YNYYYNYNYYNYNNNYYNYNNYYNYYNYYNYNNN", "NNYNNYYNNNNYNYYNNYYNNNNYNNNYYYNYNN", "YNYNYNYNYNNNYYNYYNNNYYNYNNNNNNNYYN", "YYYYYNNYYYYNYNNNYNNYNNYNNNNNYNNYNY", "YNNNYNYNYYNNNYYNYYYNYNYYYNNNNNYNNN", "NNNNNNYNYNYYNNNYNNYYNNNYYNYNNYNNNN", "YNNYNNYNYYNNNNNNYYNNNYNNYNNNYNYNNN", "NNYYYNNNYNNNNYYYNNNYNNYYNNNYNYNYNN", "YYNNNYNNNYNNYYNYYNYNYYNNYYYNNNYNYN", "YNYNNNNNNNYNNNNNNNNNNYNNNYNNNNNYNN", "NYYYNNNYYYNNNNNNYYYNNNYNNNYNNNNNNN" };
    int M = 76;
    assertArrayEquals(new int[] { 19, 15, 22, 18, 9, 3, 4, 1, 3, 4, 2, 2, 3, 4, 3, 4, 3, 1, 3, 2, 2, 1, 1, 3, 1, 2, 4, 1, 1, 2, 2, 2, 2, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case36() {
    String[] roads = { "NNNYNNNNYYNNNNYYYYNNYYYYYNNNYNYN", "NNNYYYNNYNYNYYYNNNNNNNNNYNNNNNNY", "NNNYNNYYYYNYNYNYYNNNYYYNNYNYNYYY", "YYYNNYYNNNYNNNYNNNNNYYNNNNNNNNNN", "NYNNNYYYYNNYNNNNYYYYNYNNYNYYYNYY", "NYNYYNNYNNNYNNNNNNNNYNNYNNYNNYNN", "NNYYYNNYYNNYYNNNNNNYNYNNNYYYNYNY", "NNYNYYYNNYNNYNNNNYNNYYYNNYYYYNYY", "YYYNYNYNNNNNNYYNNYNNYYYYYNYYNNNN", "YNYNNNNYNNNYNNYNNNNYYNNYNNNYYNNY", "NYNYNNNNNNNNNNYYYYNNNNYNNNNYNNNN", "NNYNYYYNNYNNYNNNYNYNNYNNNYNNNNYY", "NYNNNNYYNNNYNNNYNNNNYNNNNYNNNNNY", "NYYNNNNNYNNNNNNYYNNNYYYYYNYNYNNN", "YYNYNNNNYYYNNNNNNNNYYYYNNYNNYYNY", "YNYNNNNNNNYNYYNNNYNNYYNNNYNYNYNN", "YNYNYNNNNNYYNYNNNNYNYYNYNYNYNNYN", "YNNNYNNYYNYNNNNYNNNYNNYYYYYNYNYN", "NNNNYNNNNNNYNNNNYNNNYYNNYNYNYYYN", "NNNNYNYNNYNNNNYNNYNNNNYYNNNNNNYY", "YNYYNYNYYYNNYYYYYNYNNNNNNNYNYNNY", "YNYYYNYYYNNYNYYYYNYNNNNYNNNYNYYN", "YNYNNNNYYNYNNYYNNYNYNNNNNNYNYNNY", "YNNNNYNNYYNNNYNNYYNYNYNNYNYNNYYN", "YYNNYNNNYNNNNYNNNYYNNNNYNNNNNYYN", "NNYNNNYYNNNYYNYYYYNNNNNNNNYNNYYY", "NNNNYYYYYNNNNYNNNYYNYNYYNYNNNNYN", "NNYNYNYYYYYNNNNYYNNNNYNNNNNNNYNN", "YNNNYNNYNYNNNYYNNYYNYNYNNNNNNNYN", "NNYNNYYNNNNNNNYYNNYNNYNYYYNYNNNN", "YNYNYNNYNNNYNNNNYYYYNYNYYYYNYNNN", "NYYNYNYYNYNYYNYNNNNYYNYNNYNNNNNN" };
    int M = 65;
    assertArrayEquals(new int[] { 14, 10, 17, 9, 17, 5, 3, 3, 4, 2, 2, 3, 1, 2, 3, 2, 3, 2, 1, 1, 3, 4, 2, 1, 3, 1, 1, 2, 2, 1, 3, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case37() {
    String[] roads = { "NNNNYYNNNYYNNNYYNNYNNNNNNNYYNYNNYNNNNYYNYNNYNNNYNY", "NNNNYYNNNYNNNYYNYYNNYNYNYNYYNYNNYYYNYNYNNYNNNNNNYY", "NNNYNYYYYYNYNNYYYNYNNYNNNYNNNNNNNNYYNNNYYNYNNYNNNY", "NNYNNYNYYNNNNNYYYYNNNYNYNYNNYYNNYNNYYNNYNYNYNNYNYN", "YYNNNNNNNYNNYNNNYNNYNYNNNYNNNYYYNNYYNNNYNYYYYYYYNN", "YYYYNNYYYYNNNYYYNNYNNNNNYNNNNNNNNNNNYNNNNYYNNNYNYN", "NNYNNYNNNNNYYNNNNNYYNNNYNYNYYNNYNYYYYYNNNNNNNNNNNN", "NNYYNYNNYNNYNNNNNYNNNYNNNNNYNYYNNNNNNYYNYNYYNNNNNN", "NNYYNYNYNNNNNYYYNNYYNNNYNYNYYNNNYYYNNNNNYNYNNYNNYN", "YYYNYYNNNNNYYYYYNNYYNNYYNYYYYNNNNYNYNYNYNYNNNNYNNY", "YNNNNNNNNNNYNNNYYNNNYNYNNNNYNYNNNNYNNNNNNNYNNYYNNY", "NNYNNNYYNYYNYNYNNNYNNNNYNNNYYYYNYNNYNYNNNYNYNNNNNY", "NNNNYNYNNYNYNNYNNNNNNYNNNYNYYYNYNYNNYYYNYYNNYNYYYY", "NYNNNYNNYYNNNNNNNYYNNNNNNYYNYNNNNNNYNYYYNNNNYNNNNY", "YYYYNYNNYYNYYNNNYYYYNYYNYNNNYNNNNYYNYYYNYNNNYNYNYN", "YNYYNYNNYYYNNNNNNNNYNNNYNNYYYNYYNYYNYNNYYNYNNNYNYN", "NYYYYNNNNNYNNNYNNNNYYYYYNNYNYYNNYYNNYYNNYNNNYNNYYY", "NYNYNNNYNNNNNYYNNNNYNYYYYNYYNYNYNNYNYNNYNYYYNYNYYN", "YNYNNYYNYYNYNYYNNNNNNNYNYYNNNYYNNNNYNNNNNNNNNNYYNN", "NNNNYNYNYYNNNNYYYYNNNYYYYNNYNNNYYNNNYNYYYNYNYNNNNY", "NYNNNNNNNNYNNNNNYNNNNYYNYNNNYYYNNNYNNYNNNYNYYYNNYN", "NNYYYNNYNNNNYNYNYYNYYNYYYNNNNYYNNYYYNNNNNYYYNNYNYN", "NYNNNNNNNYYNNNYNYYYYYYNNYNNNYNNYNNNNYNNYYYNYNYNYYN", "NNNYNNYNYYNYNNNYYYNYNYNNNNNNNNNNNNNNYYNYYYNNNYNNNN", "NYNNNYNNNNNNNNYNNYYYYYYNNNNNYYNYNNYNYNNYYNNYNYYYNN", "NNYYYNYNYYNNYYNNNNYNNNNNNNYYNNNYYNNNNNYNNYYYYNNNNN", "YYNNNNNNNYNNNYNYYYNNNNNNNYNYYNNYYYNYYNNYYYNNYNYNNN", "YYNNNNYYYYYYYNNYNYNYNNNNNYYNYYNNYNNNYYYNNNNNNYYYNY", "NNNYNNYNYYNYYYYYYNNNYNYNYNYYNYYYYYNNYNYYYYNNNYYNYN", "YYNYYNNYNNYYYNNNYYYNYYNNYNNYYNNNNYNNYNNNNYNNYNNNNN", "NNNNYNNYNNNYNNNYNNYNYYNNNNNNYNNYYNNYNNNYNNNNNNNNYY", "NNNNYNYNNNNNYNNYNYNYNNYNYYYNYNYNNYYNNNYYYYYYNNNNYY", "YYNYNNNNYNNYNNNNYNNYNNNNNYYYYNYNNNYNNNYNNNYYYNNYNY", "NYNNNNYNYYNNYNYYYNNNNYNNNNYNYYNYNNYNYYYNNYYNYYNNNN", "NYYNYNYNYNYNNNYYNYNNYYNNYNNNNNNYYYNNNNNNYYYNNYNNYN", "NNYYYNYNNYNYNYNNNNYNNYNNNNYNNNYNNNNNYNNNNNNYNYNYNN", "NYNYNYYNNNNNYNYYYYNYNNYYYNYYYYNNNYNYNNNNYYYYYYYNYN", "YNNNNNYYNYNYYYYNYNNNYNNYNNNYNNNNNYNNNNNYNNNYNYYYYN", "YYNNNNNYNNNNYYYNNNNYNNNNNYNYYNNYYYNNNNNYNNNNNYYYYN", "NNYYYNNNNYNNNYNYNYNYNNYYYNYNYNYYNNNNNYYNNNNYNYYNYN", "YNYNNNNYYNNNYNYYYNNYNNYYYNYNYNNYNNYNYNNNNNNYNNNYNY", "NYNYYYNNNYNYYNNNNYNNYYYYNYYNYYNYNYYNYNNNNNYNNNNYNN", "NNYNYYNYYNYNNNNYNYNYNYNNNYNNNNNYYYYNYNNNNYNYNYNYNN", "YNNYYNNYNNNYNNNNNYNNYYYNYYNNNNNYYNNYYYNYYNYNNNNYNY", "NNNNYNNNNNNNYYYNYNNYYNNNNYYNNYNNYYNNYNNNNNNNNNYNYN", "NNYNYNNNYNYNNNNNNYNNYNYYYNNYYNNNNYYYYYYYNNYNNNNNYN", "NNNYYYNNNYYNYNYYNNYNNYNNYNYYYNNNNNNNYYYYNNNNYNNYNY", "YNNNYNNNNNNNYNNNYYYNNNYNYNNYNNNNYNNYNYYNYYYYNNYNNY", "NYNYNYNNYNNNYNYYYYNNYYYNNNNNYNYYNNYNYYYYNNNNYYNNNN", "YYYNNNNNNYYYYYNNYNNYNNNNNNNYNNYYYNNNNNNNYNNYNNYYNN" };
    int M = 115;
    assertArrayEquals(new int[] { 17, 21, 20, 21, 21, 18, 6, 3, 3, 5, 1, 2, 2, 2, 5, 4, 4, 2, 4, 2, 1, 3, 1, 1, 2, 3, 2, 2, 1, 4, 1, 1, 3, 1, 3, 3, 3, 1, 2, 3, 2, 4, 3, 3, 1, 2, 3, 2, 3, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case38() {
    String[] roads = { "NYNNNYYNNYNYNYYYYYNNNNYYNYYNYYYY", "YNNYNNNNNYYNYNNNNYNNYYNYNYNNYNNY", "NNNNNNYNNNYNNNYNYNYYNNNYNYNYYNNY", "NYNNNNYNYNNYYYNNYYNYNYNNYNNNYNNN", "NNNNNNYNNYYYYYYYNNYYNNNNYNNYYNNY", "YNNNNNNNYNYNYNNNNNNNYYNYNNNYYNNN", "YNYYYNNYNYYNNYYNYYNNNNNYNYNNNYNN", "NNNNNNYNNNNYNNNNNNNNNYYYNNNYYNYY", "NNNYNYNNNNNYYNYYYYNNYYNYYYYNYNYN", "YYNNYNYNNNNYNNNYNYNNYNNYYNNYYYNN", "NYYNYYYNNNNNYYNYYYYYNYNNYNNNYNNN", "YNNYYNNYYYNNNNNYYYNYNNNNYNNYNYNN", "NYNYYYNNYNYNNYNNYNNYNNNNYYNYYYYY", "YNNYYNYNNNYNYNYNNYYYYNYNNYNNNNYY", "YNYNYNYNYNNNNYNYNYYNNYYNYNNYNNYN", "YNNNYNNNYYYYNNYNNNNNNNNNNYYYNNYN", "YNYYNNYNYNYYYNNNNYNNNNNYNNNNNNYY", "YYNYNNYNYYYYNYYNYNNYYNYNYNNYYNNY", "NNYNYNNNNNYNNYYNNNNNNNNNNNNNYYYN", "NNYYYNNNNNYYYYNNNYNNNNNNYNNYNNYY", "NYNNNYNNYYNNNYNNNYNNNNYNNNNNYNNN", "NYNYNYNYYNYNNNYNNNNNNNNYNNYNNNYY", "YNNNNNNYNNNNNYYNNYNNYNNNNNNNYNNN", "YYYNNYYYYYNNNNNNYNNNNYNNNYNNNYYN", "NNNYYNNNYYYYYNYNNYNYNNNNNNYYNNNN", "YYYNNNYNYNNNYYNYNNNNNNNYNNYNNNNN", "YNNNNNNNYNNNNNNYNNNNNYNNYYNNNYNY", "NNYNYYNYNYNYYNYYNYNYNNNNYNNNYNYN", "YYYYYYNYYYYNYNNNNYYNYNYNNNNYNNYY", "YNNNNNYNNYNYYNNNNNYNNNNYNNYNNNNY", "YNNNNNNYYNNNYYYYYNYYNYNYNNNYYNNN", "YYYNYNNYNNNNYYNNYYNYNYNNNNYNYYNN" };
    int M = 70;
    assertArrayEquals(new int[] { 18, 12, 11, 12, 14, 5, 5, 1, 2, 3, 4, 3, 4, 3, 3, 2, 3, 3, 2, 3, 2, 2, 1, 3, 2, 3, 1, 2, 5, 1, 1, 4 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case39() {
    String[] roads = { "NNYNYNYNNNNNNNNNYNNNYYNNNYNNNNYYYNY", "NNNNYNNNNYNNNNNYYNYYYNYYNYNNNNNYNYN", "YNNNNYNYNNYNNNNYNNYNYNNYNNNYNNNNNNN", "NNNNNYNYNNYNYNNNYYNYNNYNNYNNYNNYNNN", "YYNNNNYNYNNYYNYYYNNNYNYNYNNNYYNYNNN", "NNYYNNNYNYNNYYNNYNNYYYNNNYNYNYNNNNN", "YNNNYNNNYYNYNNNNNYNNNYNNYYYYYNNYNYN", "NNYYNYNNYNNNYYNYNNYNYNNYYYNNYNNYNNN", "NNNNYNYYNNYNYNNNNYNYNYNYNNYYNNNNYNY", "NYNNNYYNNNYYNNNNNNNYNYNYYYYNYNYNNYN", "NNYYNNNNYYNNYYNNYNNNNYYNYNYNYYNNYYN", "NNNNYNYNNYNNYYNYNYYYNYNNNYNNNNYNYNY", "NNNYYYNYYNYYNNYNYYNNNNNNYYNNYNNNNYY", "NNNNNYNYNNYYNNYNYNNYNNYYNYYNNYNNYYN", "NNNNYNNNNNNNYYNNNNNNNNNYYNNYNYNNNNN", "NYYNYNNYNNNYNNNNYNNYNNNYNNNYNNNNNNN", "YYNYYYNNNNYNYYNYNNYNNNYNYNNNNYNYYNN", "NNNYNNYNYNNYYNNNNNYYYNYNYYYNNYNYYYY", "NYYNNNNYNNNYNNNNYYNYNNNNNNNNNNNNNYN", "NYNYNYNNYYNYNYNYNYYNNNNYNYYYNNNYYYN", "YYYNYYNYNNNNNNNNNYNNNYNNYYNYNYYYNYN", "YNNNNYYNYYYYNNNNNNNNYNYYYYYYNNYNYNN", "NYNYYNNNNNYNNYNNYYNNNYNYNNNNNYYNYYY", "NYYNNNNYYYNNNYYYNNNYNYYNYYYNYNNNYYN", "NNNNYNYYNYYNYNYNYYNNYYNYNYNYNNNNYNY", "YYNYNYYYNYNYYYNNNYNYYYNYYNNYYNNYYNN", "NNNNNNYNYYYNNYNNNYNYNYNYNNNNYYNNNNN", "NNYNNYYNYNNNNNYYNNNYYYNNYYNNNNNYNYN", "NNNYYNYYNYYNYNNNNNNNNNNYNYYNNNYNYNN", "NNNNYYNNNNYNNYYNYYNNYNYNNNYNNNNYNYY", "YNNNNNNNNYNYNNNNNNNNYYYNNNNNYNNYYNN", "YYNYYNYYNNNNNNNNYYNYYNNNNYNYNYYNNYY", "YNNNNNNNYNYYNYNNYYNYNYYYYYNNYNYNNNN", "NYNNNNYNNYYNYYNNNYYYYNYYNNNYNYNYNNN", "YNNNNNNNYNNYYNNNNYNNNNYNYNNNNYNYNNN" };
    int M = 81;
    assertArrayEquals(new int[] { 11, 12, 9, 11, 15, 13, 14, 6, 3, 3, 2, 2, 4, 2, 1, 3, 5, 2, 2, 3, 5, 3, 3, 2, 2, 5, 1, 3, 3, 2, 1, 5, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case40() {
    String[] roads = { "NYYNYNNNNNYNNNNYNYYYNYYYYNNYNNNYYYYNNNNNYNYNYYNNN", "YNYYNNNNYNYNNNNYNYNYYNNYYNYNYYYYNYYYNNNNNNNNNYNYY", "YYNNNNNYNNYNYNYNNYYYNNNYNYNNNYYNYNNNYNYNNNNNYNNNN", "NYNNNNNYNNYNYNNYYNNNYYYYNNNNYNNNYNYYNNNNYNNYYNYYY", "YNNNNYYNNNNNNNYNNNNYYNYYNNNNYYNNYYYNNYNNNNYYNYYYY", "NNNNYNNNYNYYNYNYNYNYNNNYNNYNNYYNNYYNYNNNNNYYNYYYY", "NNNNYNNNNNYYNNNNYNNNNNNYYNNYYYYNNNYNNYNNYNYNNYYYY", "NNYYNNNNNYNNNYNYYYNNNNYYYYYYNNNYYNNYNYNNNNYNYYNNY", "NYNNNYNNNYNNYNYNYYYNNNYNNNNNNYNNNNNYYYYNYNNYNNYNN", "NNNNNNNYYNNYYNNNYNYNNNYNNNNNNNYYNNNYYNNNNNYYNNYNY", "YYYYNYYNNNNNYNNYYYNNNNNYNYYNNNYNNNNYNNYNYYYNNNNNN", "NNNNNYYNNYNNNNYYYNYYYYNNNNNYYYNYYNNNNNNYYNNNYNNNN", "NNYYNNNNYYYNNYYYNNNNNYYYNYYNYNYNNNNNNNYNNYYNNYNNN", "NNNNNYNYNNNNYNYNNYNNYYNNNYNYNYNNNNNYNYNYNYNYYYYNN", "NNYNYNNNYNNYYYNNYNYNNNNNNYNNNYYNNNNNNNYNNYNNNNNNN", "YYNYNYNYNNYYYNNNNYNYNNNNYNNNNYYNNNNYYNNYNNYNNNNNY", "NNNYNNYYYYYYNNYNNNNNYYNNYNNYNNNNYYYNYNNNYNNNYNYYY", "YYYNNYNYYNYNNYNYNNYNNNNNYYNNNNYNNYNNYYNNNNNNYNYNY", "YNYNNNNNYYNYNNYNNYNYNNYNYYYNNNNNYYNNNYYYNNNNNNNYN", "YYYNYYNNNNNYNNNYNNYNNNYYNNYYYNNNYNNNNNYYYYNNNNNYY", "NYNYYNNNNNNYNYNNYNNNNNNNNNNNNNYNYYYNYNYNNYNNYYNNY", "YNNYNNNNNNNYYYNNYNNNNNYNNNNYYYNNYNYYNYYYYYYYYNYNY", "YNNYYNNYYYNNYNNNNNYYNYNNYYNNNYYNYNNYNNYNNNNNYNNNY", "YYYYYYYYNNYNYNNNNNNYNNNNNNNYNYNNNYNNNNYNNNYNNYNNY", "YYNNNNYYNNNNNNNYYYYNNNYNNYNNNYNNNNNNYYYNYYYYNNYNY", "NNYNNNNYNNYNYYYNNYYNNNYNYNYNYNNNNYNNYYNNYYYNNNYYN", "NYNNNYNYNNYNYNNNNNYYNNNNNYNNYNYYYNNNNNYNNNNNYNYNN", "YNNNNNYYNNNYNYNNYNNYNYNYNNNNNNNNNNNNYNNNNNNNNNNNN", "NYNYYNYNNNNYYNNNNNNYNYNNNYYNNNNYYYNNNNNYYNNNNNYYY", "NYYNYYYNYNNYNYYYNNNNNYYYYNNNNNYYNNNYYNNNNNYYNYYNY", "NYYNNYYNNYYNYNYYNYNNYNYNNNYNNYNNNNNYNNYNYNYNNNNNN", "YYNNNNNYNYNYNNNNNNNNNNNNNNYNYYNNNNYYYNYNNYYNNNNYY", "YNYYYNNYNNNYNNNNYNYYYYYNNNYNYNNNNYNYNYNYYYNNYYNYN", "YYNNYYNNNNNNNNNNYYYNYNNYNYNNYNNNYNNNNYYNYNYYYNNYN", "YYNYYYYNNNNNNNNNYNNNYYNNNNNNNNNYNNNYYNNNYYNYYNNYN", "NYNYNNNYYYYNNYNYNNNNNYYNNNNNNYYYYNYNNNYNNNYNYNNNY", "NNYNNYNNYYNNNNNYYYNNYNNNYYNYNYNYNNYNNNNNNNYYNYYYY", "NNNNYNYYYNNNNYNNNYYNNYNNYYNNNNNNYYNNNNNYNNNYNNNNN", "NNYNNNNNYNYNYNYNNNYYYYYYYNYNNNYYNYNYNNNNYYNNYNNYY", "NNNNNNNNNNNYNYNYNNYYNYNNNNNNYNNNYNNNNYNNNNYNNNYYY", "YNNYNNYNYNYYNNNNYNNYNYNNYYNNYNYNYYYNNNYNNNYNNYYYY", "NNNNNNNNNNYNYYYNNNNYYYNNYYNNNNNYYNYNNNYNNNNYNYNYY", "YNNNYYYYNYYNYNNYNNNNNYNYYYNNNYYYNYNYYNNYYNNNNYYNN", "NNNYYYNNYYNNNYNNNNNNNYNNYNNNNYNNNYYNYYNNNYNNNNNYN", "YNYYNNNYNNNYNYNNYYNNYYYNNNYNNNNNYYYYNNYNNNNNNYYNY", "YYNNYYYYNNNNYYNNNNNNYNNYNNNNNYNNYNNNYNNNYYYNYNNNN", "NNNYYYYNYYNNNYNNYYNNNYNNYYYNYYNNNNNNYNNYYNYNYNNNN", "NYNYYYYNNNNNNNNNYNYYNNNNNYNNYNNYYYYNYNYYYYNYNNNNY", "NYNYYYYYNYNNNNNYYYNYYYYYYNNNYYNYNNNYYNYYYYNNYNNYN" };
    int M = 104;
    assertArrayEquals(new int[] { 21, 22, 17, 20, 20, 7, 1, 3, 2, 1, 6, 2, 2, 1, 2, 4, 1, 4, 2, 4, 3, 2, 3, 5, 2, 1, 1, 1, 3, 3, 2, 2, 4, 3, 4, 2, 1, 1, 1, 1, 2, 1, 2, 2, 3, 3, 2, 3, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case41() {
    String[] roads = { "NNNNNNNNNNYNYNNNYNNNYNNNYYNYNYNNYNNN", "NNNYYNNNYYYNYNYNNYYNYYNNYNYYNNYYNNNN", "NNNYNNNNNNNNYNNYYNNYNYNYNYNYNYNNYNNN", "NYYNYYNYYNYNNNYNNYNYNNNNNNYYYNYNYNYN", "NYNYNNYNNNYNNYNNYYNNNNNNNNNYNYNNNNNN", "NNNYNNYYNNYYNNNYYNYNNNYNYNYYYNNNNNNN", "NNNNYYNYNNNYYNNNYNNNYYYNYNYYYNYNNYYN", "NNNYNYYNNNYNNNNNYYYNYNNYNYYYYNNNNYNY", "NYNYNNNNNNYNYNNYNYYYYNYNNYNNNYNNNYYY", "NYNNNNNNNNNNNNYYYYNYNNYNNYYYNYNYYYYY", "YYNYYYNYYNNNYNYYNYYYYNYYYYNNYNNNNNYN", "NNNNNYYNNNNNYYNNYNNNNNYYYNNNYNNNYNYN", "YYYNNNYNYNYYNNNNNNYNNNNYYNNYNNNNYYNN", "NNNNYNNNNNNYNNYNNYYYNYNNNYYYNYNYNYNN", "NYNYNNNNNYYNNYNNNYNNNNYYYNYYNYYNNYNN", "NNYNNYNNYYYNNNNNYNNNNYNYYNNNNNYNNNNN", "YNYNYYYYNYNYNNNYNNYNNNNNYNNYNYNNNNNN", "NYNYYNNYYYYNNYYNNNNNYYYNYNYNYYNNNNNY", "NYNNNYNYYNYNYYNNYNNNNNNYYNNYNNYYNNNN", "NNYYNNNNYYYNNYNNNNNNYNNYYNNYYNNNNYYY", "YYNNNNYYYNYNNNNNNYNYNYNNYYNNNNNYYYNY", "NYYNNNYNNNNNNYNYNYNNYNYYNYNYYNNYNNYN", "NNNNNYYNYYYYNNYNNYNNNYNYYNNYNYYYNYNN", "NNYNNNNYNNYYYNYYNNYYNYYNNNYNYNYNNNNN", "YYNNNYYNNNYYYNYYYYYYYNYNNYYYNYNNYNNY", "YNYNNNNYYYYNNYNNNNNNYYNNYNYNYYYNNNNN", "NYNYNYYYNYNNNYYNNYNNNNNYYYNYYNYYNNNY", "YYYYYYYYNYNNYYYNYNYYNYYNYNYNNNYNYNNY", "NNNYNYYYNNYYNNNNNYNYNYNYNYYNNNNYNYNY", "YNYNYNNNYYNNNYYNYYNNNNYNYYNNNNYNYYNN", "NYNYNNYNNNNNNNYYNNYNNNYYNYYYNYNNNYNN", "NYNNNNNNNYNNNYNNNNYNYYYNNNYNYNNNNNNY", "YNYYNNNNNYNYYNNNNNNNYNNNYNNYNYNNNNNY", "NNNNNNYYYYNNYYYNNNNYYNYNNNNNYYYNNNYY", "NNNYNNYNYYYYNNNNNNNYNYNNNNNNNNNNNYNN", "NNNNNNNYYYNNNNNNNYNYYNNNYNYYYNNYYYNN" };
    int M = 89;
    assertArrayEquals(new int[] { 9, 16, 11, 16, 9, 13, 16, 9, 2, 1, 6, 2, 4, 1, 2, 2, 6, 4, 3, 2, 4, 3, 2, 1, 4, 2, 4, 7, 3, 3, 3, 1, 3, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case42() {
    String[] roads = { "NYNYNNNNNNYNNYNNYNNNNNYYNYYNNNYNYYYNNNNNNNNYN", "YNYYNYYNNYNNYYNNYYYNNYNNNYNYNNNNYNYYYNNNYNNNN", "NYNNYYNNNNNYYNNYNNNYNYYYNNNNYNNYNYYNNNNYNNNNY", "YYNNYNNNYNYNNNNNYNNNYNYNYYYNYNYNNNNNYYNYYNNYN", "NNYYNYYNYNNNNYYYNYYYNNNNNNYNYNNYNYNYYNNNYNYYN", "NYYNYNNYYNNYYYYYNNNYNNYYNYNNNYNNYYYNYYNNYYYYY", "NYNNYNNYYYYNYNNYYYNYNNYNNNNNYYYNNNNYNNNNNYNYY", "NNNNNYYNNNNNNNYNNNYNNNNNNNYNYNYYNNNYNYNNNYNYY", "NNNYYYYNNYYYNNYYYNYNNNNYNNNNNNYYNYNNNYYYYNNYN", "NYNNNNYNYNYYYNNYYNNNNNNNYNNNNNYYNNNNYYNNNYNYN", "YNNYNNYNYYNNNYNYYYNNNYNNNYNNNYYNYNNNYNNYNNNYY", "NNYNNYNNYYNNYNYNNYNNYYNYNYYYYNNNNNNYNNNNYYYYN", "NYYNNYYNNYNYNNNNYYYNNNYNNNNYNNNYNNNNNNNYYYYNY", "YYNNYYNNNNYNNNNNNYNNNNNYYYNNNYYYYYYNYNYNYYYNY", "NNNNYYNYYNNYNNNNNNNNNNNYYNNYNYNYYYNNNNNNYNYNN", "NNYNYYYNYYYNNNNNYNNYNNYYNNYNNNYNNNYNNYYYNYNNN", "YYNYNNYNYYYNYNNYNNYYYYNNNNNYNNNYYNNYNYNNNYNYN", "NYNNYNYNNNYYYYNNNNYYYNYNNNNYNNNYYYYNYYNYNNNNN", "NYNNYNNYYNNNYNNNYYNNYYNYNNYNNYNNNNYNNNNNNYNNY", "NNYNYYYNNNNNNNNYYYNNYYNNNYYNYNNYNYNYYNNYNYNNN", "NNNYNNNNNNNYNNNNYYYYNNNYYNYYYNNNNNNNNNNNNNYYN", "NYYNNNNNNNYYNNNNYNYYNNNYNNNYYYNNYYNYNYNYNNNYY", "YNYYNYYNNNNNYNNYNYNNNNNNYNNNYNNYYNYNYNYNYNNNN", "YNYNNYNNYNNYNYYYNNYNYYNNYYYNNNYYYNYYNNNYYNNNY", "NNNYNNNNNYNNNYYNNNNNYNYYNNNYYYNYNNNYYYNYNNYNY", "YYNYNYNNNNYYNYNNNNNYNNNYNNNYYNNNNNNNNYNYYYNNN", "YNNYYNNYNNNYNNNYNNYYYNNYNNNYNNYYNNYYNNNYNYNYY", "NYNNNNNNNNNYYNYNYYNNYYNNYYYNNNNNNYYNYNYNNYYYY", "NNYYYNYYNNNYNNNNNNNYYYYNYYNNNNNNNYYNNNNYYYNNN", "NNNNNYYNNNYNNYYNNNYNNYNNYNNNNNYYYNNYYNNNNNNNN", "YNNYNNYYYYYNNYNYNNNNNNNYNNYNNYNYNNNYYYNNNYYNN", "NNYNYNNYYYNNYYYNYYNYNNYYYNYNNYYNNYNNNNNYNNYYY", "YYNNNYNNNNYNNYYNYYNNNYYYNNNNNYNNNYNNYYYYYYNNN", "YNYNYYNNYNNNNYYNNYNYNYNNNNNYYNNYYNNNNYYYNNNNN", "YYYNNYNNNNNNNYNYNYYNNNYYNNYYYNNNNNNNNNYYYYNNN", "NYNNYNYYNNNYNNNNYNNYNYNYYNYNNYYNNNNNYYNNNYNYN", "NYNYYYNNNYYNNYNNNYNYNNYNYNNYNYYNYNNYNYNYNNYNY", "NNNYNYNYYYNNNNNYYYNNNYNNYYNNNNYNYYNYYNNNNYNYN", "NNNNNNNNYNNNNYNYNNNNNNYNNNNYNNNNYYYNNNNNNNNNY", "NNYYNNNNYNYNYNNYNYNYNYNYYYYNYNNYYYYNYNNNYNNNN", "NYNYYYNNYNNYYYYNNNNNNNYYNYNNYNNNYNYNNNNYNNNNN", "NNNNNYYYNYNYYYNYYNYYNNNNNYYYYNYNYNYYNYNNNNYNY", "NNNNYYNNNNNYYYYNNNNNYNNNYNNYNNYYNNNNYNNNNYNNY", "YNNYYYYYYYYYNNNNYNNNYYNNNNYYNNNYNNNYNYNNNNNNY", "NNYNNYYYNNYNYYNNNNYNNYNYYNYYNNNYNNNNYNYNNYYYN" };
    int M = 102;
    assertArrayEquals(new int[] { 14, 19, 16, 18, 20, 23, 2, 1, 4, 1, 2, 2, 3, 4, 2, 3, 3, 2, 2, 3, 1, 2, 4, 3, 1, 4, 3, 1, 3, 1, 2, 2, 3, 4, 4, 2, 4, 2, 1, 2, 4, 1, 2, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case43() {
    String[] roads = { "NNNYYNNYNNNYYNYNNYYYNYYYNNYNYYN", "NNNYNYNNYYNYYYYYYNNNNNNNNNNNNYY", "NNNYNYNNYNYYYNNNNYNYNNYYNYNYYNN", "YYYNNNNNNNNYNNNNYYYNNNNNYNYNNNY", "YNNNNNYNNYNNNYNNYNYNNNNYNNYYNYN", "NYYNNNYNNNNNNNNNNYNNYYYNYNNNYNN", "NNNNYYNNYNYYYYYNNNYYYYYYYNNNYNN", "YNNNNNNNNNNNNYYNNNNNNNYNNYYNNYN", "NYYNNNYNNNNYYYYNYYNYNNYNYNYYNYN", "NYNNYNNNNNNNNNYNNNYNNNNNNNNNYNN", "NNYNNNYNNNNYNNYYYYNNNNNYNNYYYNN", "YYYYNNYNYNYNNYNYYYNNNNNNYNYNNNN", "YYYNNNYNYNNNNYYYNYNNYYNNNNNYNYY", "NYNNYNYYYNNYYNNNNNYNYYNNYYNYYYN", "YYNNNNYYYYYNYNNNNNYNNYYNNNNNYYY", "NYNNNNNNNNYYYNNNYYNYNNNNNNYYNNN", "NYNYYNNNYNYYNNNYNYYYNNYYNYNYNNY", "YNYYNYNNYNYYYNNYYNYNNYNYYYYYNNY", "YNNYYNYNNYNNNYYNYYNYYNNNNNNNNNN", "YNYNNNYNYNNNNNNYYNYNYYNNNNYNYNY", "NNNNNYYNNNNNYYNNNNYYNNNYNYNYNNY", "YNNNNYYNNNNNYYYNNYNYNNYYYNYNYYN", "YNYNNYYYYNNNNNYNYNNNNYNYNNNNNYN", "YNYNYNYNNNYNNNNNYYNNYYYNYYYYYYY", "NNNYNYYNYNNYNYNNNYNNNYNYNYYNNYY", "NNYNNNNYNNNNNYNNYYNNYNNYYNYNNNN", "YNNYYNNYYNYYNNNYNYNYNYNYYYNNYNY", "NNYNYNNNYNYNYYNYYYNNYNNYNNNNNYN", "YNYNNYYNNYYNNYYNNNNYNYNYNNYNNNN", "YYNNYNNYYNNNYYYNNNNNNYYYYNNYNNY", "NYNYNNNNNNNNYNYNYYNYYNNYYNYNNYN" };
    int M = 64;
    assertArrayEquals(new int[] { 15, 12, 13, 10, 10, 9, 3, 1, 3, 2, 1, 4, 3, 2, 2, 1, 3, 4, 3, 2, 1, 2, 3, 3, 2, 1, 3, 2, 3, 3, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case44() {
    String[] roads = { "NYNNNYNYYYNNYYNYYNYNNYYYYNNYYNYYYYYNNYNN", "YNNNYNYNNNNNYNYYNYYNNYNYNNYYNYNNYYNNYNNN", "NNNNYNYNNNNYNNNNYYNYNNYYNNNNYYYNNYYNYNYY", "NNNNYNNNNYNNYNNNYNYYYYNYYNNNNNNYYYNNNNYY", "NYYYNNNYNNNNNYNYNYYYYYNYNNNNYNNNYNNNNYNN", "YNNNNNNYNYNNNNNYNYNYNNNNYNNYYNNNNYNYYYYN", "NYYNNNNYNYNYNNYYNNNYYYNYYNNYNNYYNNNNNNYN", "YNNNYYYNYNNNYYNYNNYYNNNNNNNYNNYNNNNNNYNY", "YNNNNNNYNNNYNYNYYYYNNYYNNNYNNYNYNNYYNYNN", "YNNYNYYNNNYNYNNYNYYNNNNYYNNNNNNNYNNNYNNN", "NNNNNNNNNYNNYNNNNNYYYYNNYYYNNYNYYNYNYYNY", "NNYNNNYNYNNNYNNYYNNNYYYNYYNNNNYNYYNYNNYY", "YYNYNNNYNYYYNYYYYNNNNNNNNNNYNYYNYNYNNNNY", "YNNNYNNYYNNNYNNYNYNNNYNNNYYYNNYYYYYYNNYN", "NYNNNNYNNNNNYNNYNNNNNYYYNYYNNNYYYYNYNNYN", "YYNNYYYYYYNYYYYNNNNNNNNYNNYNNNYNYNNYNNYY", "YNYYNNNNYNNYYNNNNNYNNNYYNNNNYNNYNYNNNNYN", "NYYNYYNNYYNNNYNNNNNYYNNYNYNNYNNNNNNYNYYY", "YYNYYNNYYYYNNNNNYNNNNNNYNNNNYNNNYNNNYYYN", "NNYYYYYYNNYNNNNNNYNNYNNNNNYYYNYNNNNYYYNN", "NNNYYNYNNNYYNNNNNYNYNYNYYNYNYYYYYNNNNNNN", "YYNYYNYNYNYYNYYNNNNNYNNYNYYYNNYNYNYNNNYY", "YNYNNNNNYNNYNNYNYNNNNNNYNNYNYNYNNNNYNNNY", "YYYYYNYNNYNNNNYYYYYNYYYNNYYYNNNNNNNNNNYY", "YNNYNYYNNYYYNNNNNNNNYNNNNNNNNNNNNYYNNNNY", "NNNNNNNNNNYYNYYNNYNNNYNYNNNNNNYYYNYNNYYN", "NYNNNNNNYNYNNYYYNNNYYYYYNNNYNNNNNNYNYNNY", "YYNNNYYYNNNNYYNNNNNYNYNYNNYNYNNNYNYNYNYY", "YNYNYYNNNNNNNNNNYYYYYNYNNNNYNNNNNNYNYNNN", "NYYNNNNNYNYNYNNNNNNNYNNNNNNNNNNNNYNYYNNY", "YNYNNNYYNNNYYYYYNNNYYYYNNYNNNNNYNNNYNNYN", "YNNYNNYNYNYNNYYNYNNNYNNNNYNNNNYNNNNNNYNN", "YYNYYNNNNYYYYYYYNNYNYYNNNYNYNNNNNYYNYNYN", "YYYYNYNNNNNYNYYNYNNNNNNNYNNNNYNNYNYNYNNN", "YNYNNNNNYNYNYYNNNNNNNYNNYYYYYNNNYYNNNYNN", "NNNNNYNNYNNYNYYYNYNYNNYNNNNNNYYNNNNNNNYN", "NYYNNYNNNYYNNNNNNNYYNNNNNNYYYYNNYYNNNNNY", "YNNNYYNYYNYNNNNNNYYYNNNNNYNNNNNYNNYNNNNY", "NNYYNYYNNNNYNYYYYYYNNYNYNYNYNNYNYNNYNNNN", "NNYYNNNYNNYYYNNYNYNNNYYYYNYYNYNNNNNNYYNN" };
    int M = 93;
    assertArrayEquals(new int[] { 22, 16, 16, 15, 15, 12, 2, 3, 1, 4, 2, 1, 3, 2, 1, 4, 3, 4, 4, 4, 2, 4, 2, 5, 3, 1, 1, 3, 4, 2, 2, 2, 4, 5, 2, 1, 3, 2, 2, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case45() {
    String[] roads = { "NNNNNNNNYNNNNNNYNNYNYNYNNNNNNNNNNNNNNNNNYNNYNNN", "NNNNNNNNNNNNNNNYYNNNNNNNNNNNYNNYNNNYNYNNYNNNNYN", "NNNNNYNNNNNYNNYNNNNNNNNNNNNNNNNNYYNNYNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNYNYNNNNYNNNNYNNN", "NNYNNNNNNYNYNNNNNYNYNYNNNNYYNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNYNYNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNYNNYNNNNN", "YNNYNNNNNNNNYNNNNNYNYNNNNNNYNNNNNNNYNNNNNNNNNNY", "NNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNNYYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNYYNNNNNNNNNNNNYNNNNNNNNYNN", "NNYNNYYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNYYNNNNNNNYNNNNNNNNNNNYNN", "NNNNNNNNNNNNNNNNNNNYNNNNYNNNNYNNNNNNNNNNNNNNNNY", "NNYNNNNNNNNNNNNNNYNNNNYNNNYNNNNNNNNNNNYNNNNYNNN", "YYNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNN", "NYNNNNNNNNYNNNNNNNNNNNNNNNNYNYNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNNNNYNNNNNYNNNNNNNNYNNNNNYNNNNNNNNNNY", "YNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNYNNN", "NNNNNYNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNYNNNYNYNNN", "YNNNNNNNYNNNNNNYNYNNNNNNNNNNNNNNNNNNYNNNNNYNNNY", "NNNYNYNYNNYNNNNNNNNNNNYNNNNNNNNNYNNNNNNNYNNNYNN", "YNNNNNNNNNYNNNYNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNYN", "NNNNNNNNNNNNYNNNNNNNNNNNYNNNNNNNNNNYNYNNNNNNNNN", "NNNNNNNNNNNNYYNNNNNNNNNYNNNYNNNNNNNYNYNNNNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNNNNNNNYNNNNN", "NNNNYYNNNYNNNNYNNNNNNNNNNNNNNNNNNNNNNNNYYNNNNNY", "NNNNNYNNYNNNNNNNYNNYNNNNYNNNNNNNNNNNNNNYNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNYNNYYNNNNNNNNNNNNYYNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNYN", "NYNNYNNNNNNNNNNNNNNNNNNNNYNNNYNNYNNNYNNNYNNNNNN", "NNYNNNNNNYNNYNNNNNNNNYNNNNNNNNNYNYNNYNNYNNNNNYN", "NNYNYNYNNYNNNNNNNNYNNNNNNYNNNNNNYNNNNNNNNNNYNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNY", "NYNYNNYNYNYNNNNNNYNNNNNYYNNNYNNNNNNNNYYYYNNNNNN", "NNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNYYNNNNNNNNNNYNNN", "NYNNNNNNNNNNNNNNNNNYNNNYYNNNNNYNNNNYNNNNNNNNYNN", "NNNNYNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNYNYNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNYYNNNNYNNYNNNNNNNNNNN", "YYNNNNNNNNNNNNNNNNNNNYNNNNYNNNNYNNNYNNYNNYNNNYY", "NNNNNNNYNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNYNNNNNY", "NNNNNNNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNYNNNNYNNY", "YNNNYNYNNNNNNNYNNNYYNNNNNNNNNNNNNYNNYNNNNNYNNNN", "NNNNNYNNNNYNYNNNNNNNNYNNNNNNNNNNNNYNNYNNNNNNNNN", "NYNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNYNNNNNNNYNNNNNN", "NNNNNNNNYNNNNYNNNYNNYNNNNNYNNNNNNNYNNNNNYYYNNNN" };
    int M = 46;
    assertArrayEquals(new int[] { 7, 7, 6, 2, 4, 6, 1, 2, 4, 1, 1, 2, 3, 2, 1, 3, 2, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case46() {
    String[] roads = { "NYYNYNNYNNYYNNYNNNYYNYNNNNYNNYNYNNNYYYNYYNNYNNNNNN", "YNYNYYYYNYNYNYNYNNYYYYNNYNNNYYNNNYYYNYNNNNYYNNNYNY", "YYNYNNYNYNYNYNYYNNYNNNYNNYNYNNNYNNYYYYYYNNYYNYNNNN", "NNYNYYNYNYNYYYNNNNNYYNYYYYNYNYNYYNYNNYYYNYNNNNNNNN", "YYNYNYYNYYNNNYNNNYNNNYYYNNNNYYYNNYNNNYNYYNYYNNNNYN", "NYNYYNYYYYYNYNNYNYNYNNNNYYYNNYNNNNNNNYYNNNYYYYYNNN", "NYYNYYNYNYNYYNYNNNNNYNNNNNNNYYNNNNYNNNYYNNNNYNYYNN", "YYNYNYYNNNNNNYNNNNNNNNYYYYNNNNNNYYYNNYYYYNNNNYYNYN", "NNYNYYNNNNYNNYNYNNNNYYYYYNNNYNNYYNYNYNYNNNYYNYYNNN", "NYNYYYYNNNNNYNNYYYNNYNNYNYYYYYNYNNYNNNYNNYYYNYNNNY", "YNYNNYNNYNNYNNYNNNNYNNYNNNNYYNNYNYYNNYYNYYYNNNYYYN", "YYNYNNYNNNYNYNYYYYNNYYYYNYYNNYYNNYNYNYNNNNYYNYNNNY", "NNYYNYYNNYNYNYNYNYNNYYYYYNNYYYYNNYNYYYNNNNYNYNYNYY", "NYNYYNNYYNNNYNNNNYNYYNYYNNNNNNNNYYYNNNNNNNNNYYYNNN", "YNYNNNYNNNYYNNNNNNNYNNYNNYYNNNYNNYYNYNYNYYNNYYNNNN", "NYYNNYNNYYNYYNNNNNNNYNNYYYYNYNYYNNNNYYYYNNYYNNNYYY", "NNNNNNNNNYNYNNNNNNNYNYNYNNYNNYYNYNYYNNYYYYNYNYNNYY", "NNNNYYNNNYNYYYNNNNNYYNNNNYYYNYYNYNYYNYYYYNYNYYNYYN", "YYYNNNNNNNNNNNNNNNNYYNNNYYYYYYYYYNNNNNNNNYYYYYYNNN", "YYNYNYNNNNYNNYYNYYYNYNNYNNYYNNYYYYYYYNYNNYYNNNYNYN", "NYNYNNYNYYNYYYNYNYYYNNNNYYYYYNNYNNNYYNYNNNNYNNNNNN", "YYNNYNNNYNNYYNNNYNNNNNYYYNNNNYNYNYYNNNYNYNYNYNYYNY", "NNYYYNNYYNYYYYYNNNNNNYNNNNNNYNNNYYYNYNNYYYNNNNNNYY", "NNNYYNNYYYNYYYNYYNNYNYNNNYYYNNYYYYNNYYYNYYNNYNNNNN", "NYNYNYNYYNNNYNNYNNYNYYNNNNYNNYYNYNNYYYNNNNNYNNYNNN", "NNYYNYNYNYNYNNYYNYYNYNNYNNYNNNNYNNYNYYNNNNNYYNNYYY", "YNNNNYNNNYNYNNYYYYYYYNNYYYNNYNNYYYNYYNNNYNYNYNNYYY", "NNYYNNNNNYYNYNNNNYYYYNNYNNNNNNYNYNYYYNNNYYYYNYYNYN", "NYNNYNYNYYYNYNNYNNYNYNYNNNYNNYNYYYYNNNNNNNNYNNNYNY", "YYNYYYYNNYNYYNNNYYYNNYNNYNNNYNNNNNYNNNYNYNYNNNNYNN", "NNNNYNNNNNNYYNYYYYYYNNNYYNNYNNNNYYNYYNNYYYYYNNYNNY", "YNYYNNNNYYYNNNNYNNYYYYNYNYYNYNNNYYYYYYYYYYNNNYNNNN", "NNNYNNNYYNNNNYNNYYYYNNYYYNYYYNYYNYNYYYYYNYNNYYYYNN", "NYNNYNNYNNYYYYYNNNNYNYYYNNYNYNYYYNNYYYNNNNNYYNNYNY", "NYYYNNYYYYYNNYYNYYNYNYYNNYNYYYNYNNNNNYYYYYYNNYNYNN", "YYYNNNNNNNNYYNNNYYNYYNNNYNYYNNYYYYNNNYNYNYNNYNNNNN", "YNYNNNNNYNNNYNYYNNNYYNYYYYYYNNYYYYNNNNYYYYNYYNYYNY", "YYYYYYNYNNYYYNNYNYNNNNNYYYNNNNNYYYYYNNYNNYYYYYYNYY", "NNYYNYYYYYYNNNYYYYNYYYNYNNNNNYNYYNYNYYNNYNYNYNYYNY", "YNYYYNYYNNNNNNNYYYNNNNYNNNNNNNYYYNYYYNNNNNNYNNYYNY", "YNNNYNNYNNYNNNYNYYNNNYYYNNYYNYYYNNYNYNYNNYYNNNYYYN", "NNNYNNNNNYYNNNYNYNYYNNYYNNNYNNYYYNYYYYNNYNNNYYNNYN", "NYYNYYNNYYYYYNNYNYYYNYNNNNYYNYYNNNYNNYYNYNNNYYYYYY", "YYYNYYNNYYNYNNNYYNYNYNNNYYNYYNYNNYNNYYNYNNNNNNNNNY", "NNNNNYYNNNNNYYYNNYYNNYNYNYYNNNNNYYNYYYYNNYYNNYYYNN", "NNYNNYNYYYNYNYYNYYYNNNNNNNNYNNNYYNYNNYNNNYYNYNYYNN", "NNNNNYYYYNYNYYNNNNYYNYNNYNNYNNYNYNNNYYYYYNYNYYNNYN", "NYNNNNYNNNYNNNNYNYNNNYNNNYYNYYNNYYYNYNYYYNYNYYNNYN", "NNNNYNNYNNYNYNNYYYNYNNYNNYYYNNNNNNNNNYNNYYYNNNYYNY", "NYNNNNNNNYNYYNNYYNNNNYYNNYYNYNYNNYNNYYYYNNYYNNNNYN" };
    int M = 252;
    assertArrayEquals(new int[] { 19, 25, 23, 23, 22, 23, 18, 20, 21, 24, 21, 25, 27, 9, 5, 7, 2, 6, 3, 6, 8, 6, 8, 7, 6, 6, 4, 5, 7, 9, 3, 6, 3, 6, 8, 5, 4, 10, 8, 6, 4, 3, 9, 8, 3, 6, 6, 3, 4, 4 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case47() {
    String[] roads = { "NYYYYYYYYNYYNYYNNYYYYYYYNYYNNYYYYYYYNYYYYNNYYNYY", "YNYYNNYYYYYYNNYYYYYNYYYYYNYYNNYNNNYYNYYYYYYYYYYY", "YYNYYNYYYYYYYYYYYYYNNYYNNYNNYYNYYNYYYNYYYYNYYYYY", "YYYNYYYNYYNYYNYNYYYYYYYYYYYYNYYYYYNYYYYYYNNYYYYY", "YNYYNYNYYNNYYYYYYNYNNNYNYYYYYYYYYNYNYNYYYYNNYYYY", "YNNYYNNYYYYYYNYYYYYYYNYYYNYYNYYYYYNYYYYNNYYYYYNN", "YYYYNNNNYNYNYYYYNYNYNYYYNYNNNYNYYYYYYYNYNYYYYYYY", "YYYNYYNNYNYYYNYYNYYYYYNYYYYYYYYNYYNYYYYYNYNNYYYY", "YYYYYYYYNYYYYYYYYYYYYYYNYNYYYNYNYNNYNYYNYYNYNNYY", "NYYYNYNNYNYYYNYNYNYYNNYYYYYNNYNYYNYYYNYYYYYYYNNY", "YYYNNYYYYYNYYYYYYNYNNNYNYYYYYYYNYYNYYYYYYNNYYYYY", "YYYYYYNYYYYNYNYNYYYYNYYYYYYYYYYNYNYYYYNYYYNYNYYN", "NNYYYYYYYYYYNNYYYYYYNYNYYYYYYNYYYNYYYNYYYYYNYYNY", "YNYNYNYNYNYNNNYYYYYYYNYYYYYYYNNNNYYYYNYYYYYYYYNY", "YYYYYYYYYYYYYYNYYNYYYYYYYYYYYNYNYYYYYNYYYYYYYNYY", "NYYNYYYYYNYNYYYNNYNYYNYYYYYYYYYYYYNNYNNYYYYYYYNN", "NYYYYYNNYYYYYYYNNNYYYYYYYYNYYYYYYYYYNYNNNYYYNNYY", "YYYYNYYYYNNYYYNYNNNYYYYYYNYYYYNNYNNYYYYYYYNYNYNY", "YYYYYYNYYYYYYYYNYNNYYYYYYYYYNNNYYNYNYYNYYNNYYNYY", "YNNYNYYYYYNYYYYYYYYNNNYNYYNYYYYYYNYYYNYNYYNYYYNY", "YYNYNYNYYNNNNYYYYYYNNYYNYYNYYYYYNYYYYYNNNYNNYYNY", "YYYYNNYYYNNYYNYNYYYNYNNYYNNNYNYYYYYYYYYYYNNNYYYN", "YYYYYYYNYYYYNYYYYYYYYNNNYYYYYYYNYYYYYYYYYYYYNYYY", "YYNYNYYYNYNYYYYYYYYNNYNNYNYNYYYYNNYYYYYYYYNYYYYY", "NYNYYYNYYYYYYYYYYYYYYYYYNYYYYNNYYYYNYYYYYYNYYYYY", "YNYYYNYYNYYYYYYYYNYYYNYNYNYNYYNYYYYYYNNYYYYYNYNN", "YYNYYYNYYYYYYYYYNYYNNNYYYYNYYYYYYNNYYYYYYNYNYNYY", "NYNYYYNYYNYYYYYYYYYYYNYNYNYNYYNYNYNYYNYYYNYYYYYY", "NNYNYNNYYNYYYYYYYYNYYYYYYYYYNYYNYNYYYNNYYYYYYNYN", "YNYYYYYYNYYYNNNYYYNYYNYYNYYYYNYYYYYYYYNYYYYYNYYY", "YYNYYYNYYNYYYNYYYNNYYYYYNNYNYYNYYYYYYYYYYYYYYYYN", "YNYYYYYNNYNNYNNYYNYYYYNYYYYYNYYNYNYYYNNYYNYYYYYY", "YNYYYYYYYYYYYNYYYYYYNYYNYYYNYYYYNYNNNYYYYNYNNYYY", "YNNYNYYYNNYNNYYYYNNNYYYNYYNYNYYNYNYNYNYNYNYYYYNY", "YYYNYNYNNYNYYYYNYNYYYYYYYYNNYYYYNYNYYYNYYYNNNYYY", "YYYYNYYYYYYYYYYNYYNYYYYYNYYYYYYYNNYNYYYYYYYNYYYY", "NNYYYYYYNYYYYYYYNYYYYYYYYYYYYYYYNYYYNYYYYYNYYYYY", "YYNYNYYYYNYYNNNNYYYNYYYYYNYNNYYNYNYYYNNNYYYNYYYY", "YYYYYYNYYYYNYYYNNYNYNYYYYNYYNNYNYYNYYNNYYYYNYYYN", "YYYYYNYYNYYYYYYYNYYNNYYYYYYYYYYYYNYYYNYNNYYYYNNN", "YYYYYNNNYYYYYYYYNYYYNYYYYYYYYYYYYYYYYYYNNYYNNYYN", "NYYNYYYYYYNYYYYYYYNYYNYYYYNNYYYNNNYYYYYYYNNYYNYY", "NYNNNYYNNYNNYYYYYNNNNNYNNYYYYYYYYYNYNYYYYNNYNNYY", "YYYYNYYNYYYYNYYYYYYYNNYYYYNYYYYYNYNNYNNYNYYNYNNY", "YYYYYYYYNYYNYYYYNNYYYYNYYNYYYNYYNYNYYYYYNYNYNYYN", "NYYYYYYYNNYYYYNYNYNYYYYYYYNYNYYYYYYYYYYNYNNNYNYN", "YYYYYNYYYNYYNNYNYNYNNYYYYNYYYYYYYNYYYYYNYYYNYYNN", "YYYYYNYYYYYNYYYNYYYYYNYYYNYYNYNYYYYYYYNNNYYYNNNN" };
    int M = 178;
    assertArrayEquals(new int[] { 36, 35, 36, 39, 33, 11, 4, 5, 6, 4, 4, 6, 4, 3, 6, 4, 4, 4, 5, 2, 3, 4, 5, 3, 3, 4, 4, 3, 2, 4, 4, 4, 4, 2, 4, 4, 3, 3, 5, 5, 5, 3, 1, 4, 5, 4, 5, 5 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case48() {
    String[] roads = { "NNYYNNNYYNNNNNYYYNYNYNNYNYYYYNYNNNYNNYYYNNYYYYYNY", "NNYYNYNNNYNYNNNYNYYYYNYNNNYNYYYNYYYNNYNYNNNNNNYNY", "YYNNYYNNYNYNYYYYNNNYYNNYNNNNNNYYYYYYNNYYYYYNNNNYY", "YYNNYYYNNYNYNYYYNNYNYYYNYNYYYYNNYYNYYYYNNYNYYNYNY", "NNYYNYNYYYNNYYYNYNYNYNYNYNYNNNNNNYNNNYNNNNYNNNYYN", "NYYYYNYYNNYYYYNYNNYYYNYNYNNYYYNNNNYNNYNYNNNNYYYYN", "NNNYNYNYNYYYNYYYYYNYYYNYYYYNYYYYNYYYNYYNYYYYYYYYY", "YNNNYYYNNYYNNYNYNNYYNNYYYYNNYNYNYYYNYYYNYNYYNNNNN", "YNYNYNNNNYNNYYNYYYYYNYYYYYNNYNNNNNYNYYNNYNYNNYNNN", "NYNYYNYYYNYYYYNYNYYNYYNYYNNYYYYYNNNYNNNNNNNNNNYYN", "NNYNNYYYNYNYYYNNYYNYNNNNNYYNYYYYNNYNNNYYNNNYNNNYY", "NYNYNYYNNYYNYYYYNYYYYNNNYYYNNYYNYNYNNYNNNYYYNNYYY", "NNYNYYNNYYYYNYNYNNYNYNNNNYYYNNYYNYYNNNNNNNNYYYNYY", "NNYYYYYYYYYYYNYYNYNYNNNYNNYYYYYYYNYNYNYYYNNYYNYYN", "YNYYYNYNNNNYNYNYNNNNNNNYYYNYYNYNNNYNYYNYNNYYYYYYY", "YYYYNYYYYYNYYYYNNYNNNYYYYYNYNNYYYYYYYNYYYNNNNYNYN", "YNNNYNYNYNYNNNNNNYYYYYYNNNNNNYNNYYNYYNNNYYYNNYYYN", "NYNNNNYNYYYYNYNYYNYNYNNYYNYYNYNYYYYNYNNNNYNNYYNYY", "YYNYYYNYYYNYYNNNYYNNNNNYNNNNYYNNYYYYNYNNNNYNNYNYY", "NYYNNYYYYNYYNYNNYNNNYYNNNYYYNYNNYYNNYYYYYYNYNNYYN", "YYYYYYYNNYNYYNNNYYNYNYNNNNYYYYYNNYYYYYNNYYNNNNYNN", "NNNYNNYNYYNNNNNYYNNYYNYNYYYYYYYNYNYNYNYYNYYNNYNYY", "NYNYYYNYYNNNNNNYYNNNNYNNYNNNNNYNYNNNNNNNNNNYYYYNY", "YNYNNNYYYYNNNYYYNYYNNNNNYYNNYNNYYYYYNYYNYYYYYNYYN", "NNNYYYYYYYNYNNYYNYNNNYYYNYNNNNNNYNNYNYYYNYNYYYNNY", "YNNNNNYYYNYYYNYYNNNYNYNYYNNYYNYNYNYYYYYYNNNYYNYYY", "YYNYYNYNNNYYYYNNNYNYYYNNNNNYNYNYNNYYNNYNYYYYNYNNN", "YNNYNYNNNYNNYYYYNYNYYYNNNYYNYYNNYNYYYNYNNNYNYNYNY", "YYNYNYYYYYYNNYYNNNYNYYNYNYNYNNNNNYNNYNYNYNNYYNNYN", "NYNYNYYNNYYYNYNNYYYYYYNNNNYYNNNYYYNYYYYNYNNYYYYYN", "YYYNNNYYNYYYYYYYNNNNYYYNNYNNNNNYNYYNYYNYNYNYNNNNY", "NNYNNNYNNYYNYYNYNYNNNNNYNNYNNYYNYNNNNYYNNYYYNYYNN", "NYYYNNNYNNNYNYNYYYYYNYYYYYNYNYNYNYYNNYYYNYYYNYYYY", "NYYYYNYYNNNNYNNYYYYYYNNYNNNNYYYNYNNYYNNNYNNNNYNNN", "YYYNNYYYYNYYYYYYNYYNYYNYNYYYNNYNYNNYYNYNNYNYNYNYN", "NNYYNNYNNYNNNNNYYNYNYNNYYYYYNYNNNYYNNYNYYNNNYNYYN", "NNNYNNNYYNNNNYYYYYNYYYNNNYNYYYYNNYYNNYYYYYNYNYYYN", "YYNYYYYYYNNYNNYNNNYYYNNYYYNNNYYYYNNYYNYYYYNYYYNYN", "YNYYNNYYNNYNNYNYNNNYNYNYYYYYYYNYYNYNYYNYYNNYYYNYY", "YYYNNYNNNNYNNYYYNNNYNYNNYYNNNNYNYNNYYYYNNYYNYNYNY", "NNYNNNYYYNNNNYNYYNNYYNNYNNYNYYNNNYNYYYYNNNYYNYYNY", "NNYYNNYNNNNYNNNNYYNYYYNYYNYNNNYYYNYNYYNYNNNYNYNYY", "YNYNYNYYYNNYNNYNYNYNNYNYNNYYNNNYYNNNNNNYYNNYNNYNY", "YNNYNNYYNNYYYYYNNNNYNNYYYYYNYYYYYNYNYYYNYYYNYNYNY", "YNNYNYYNNNNNYYYNNYNNNNYYYYNYYYNNNNNYNYYYNNNYNNYNY", "YNNNNYYNYNNNYNYYYYYNNYYNYNYNNYNYYYYNYYYNYYNNNNNYY", "YYNYYYYNNYNYNYYNYNNYYNYYNYNYNYNYYNNYYNNYYNYYYNNNN", "NNYNYYYNNYYYYYYYYYYYNYNYNYNNYYNNYNYYYYYNNYNNNYNNN", "YYYYNNYNNNYYYNYNNYYNNYYNYYNYNNYNYNNNNNYYYYYYYYNNN" };
    int M = 489;
    assertArrayEquals(new int[] { 25, 22, 26, 30, 20, 26, 36, 25, 23, 25, 23, 28, 23, 32, 25, 32, 22, 26, 24, 27, 27, 26, 17, 28, 25, 24, 13, 13, 16, 14, 16, 9, 16, 14, 19, 11, 12, 16, 13, 12, 10, 11, 12, 14, 11, 13, 15, 17, 14 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case49() {
    String[] roads = { "NNYYYNYNYNYNNNYYYYYNYNYYYYNNNYNYYYYNNNYNYNNYNNNNNY", "NNYNNNNYNYNYNYYNYYNYNYNYYNNNNNYNYYYNNNYYNYYYNYNYYN", "YYNNNNNYYYNNNYNYYYNYNYNNYNNNNNYNNYNNYYYYNYNYNYNYYY", "YNNNYYNYYYNNYNYNYNYNNNNNYYYYYNNYNYYYYYYNNNNYYYNYYY", "YNNYNNYNYYYYYYYNYYNNYYYYYNNYNNNNYYYYNNYNYYYNYNYYNN", "NNNYNNNNYYNYNYNNNYYYNNNNYNNYYNNNYYYYYYYYYNNYNNNNNN", "YNNNYNNYNYYNYNNYNNYYYNYNNNYYYNNNNNYNNYNYYYNYYNNNNY", "NYYYNNYNNYYYNYNNNYYNNNYNYNNYYYNNYNYNYYNNNYYYYYYYNY", "YNYYYYNNNYNYYYNNYNNNYYYNYNNNYYNYNYNNNYNNNNYYYNYNNY", "NYYYYYYYYNNNYYNNNYNYYNNNYYYNNYYNYNNYNYNNNNNNYNYYNN", "YNNNYNYYNNNNNYNYYNYNYYYYNYNYYYYYNYYYNNNNYYNNNYNYYN", "NYNNYYNYYNNNNYNNYYYNYNYYYNYYNYYYYNYYYYYYNNYYYNYYNY", "NNNYYNYNYYNNNYNYYYNNYNNNYYYYYNNNYNYNYNNNNNNNNNYNNN", "NYYNYYNYYYYYYNNNNYYYNNYYNNNYNNNYYNNYYNNYNYYYNYNNNY", "YYNYYNNNNNNNNNNYYNYNYNNNNYYYYYYNNNYNYYNNYNYYNYYYYN", "YNYNNNYNNNYNYNYNYYYNNNYYNYNYNNYNYYYNNYNNNYYNYYNNYY", "YYYYYNNNYNYYYNYYNYYNNYNNYYYYYYNYNYYYYYYYNNYYYNNNNY", "YYYNYYNYNYNYYYNYYNNNNYNNYNNNYYYNYYNYNYNNYNNYYYNNNN", "YNNYNYYYNNYYNYYYYNNYYYNYYNYNNYNNYNNNNNYNYYNNYNNNNY", "NYYNNYYNNYNNNYNNNNYNNNYYNNNYNNYNYNYNNYYNNNYYNNNYNY", "YNNNYNYNYYYYYNYNNNYNNNYNNNYNNYYNNYNYYNNYNYNNYNYYNN", "NYYNYNNNYNYNNNNNYYYNNNNYYNYYNYNNYYNYYYNNYYYYYYYYYN", "YNNNYNYYYNYYNYNYNNNYYNNYYNYNYYNNNNYNNNNNNNNYYNNYNY", "YYNNYNNNNNYYNYNYNNYYNYYNNNYNYYYNNNNNNYNNYYNNNNYYYN", "YYYYYYNYYYNYYNNNYYYNNYYNNNYNYYNNNYYNYYYNYYYYYNNNYN", "YNNYNNNNNYYNYNYYYNNNNNNNNNNNNYNYNNNNYNYNYNNNNYNNNY", "NNNYNNYNNYNYYNYNYNYNYYYYYNNNNYYYNYYNNNYNNNNNNYNNNY", "NNNYYYYYNNYYYYYYYNNYNYNNNNNNYNYNNNNYNYYYNNNYNYNYYN", "NNNYNYYYYNYNYNYNYYNNNNYYYNNYNNNNNNNYYNYNNNNNYYYNYY", "YNNNNNNYYYYYNNYNYYYNYYYYYYYNNNYNYYYYYNNNNYNYNYYNNN", "NYYNNNNNNYYYNNYYNYNYYNNYNNYYNYNYNYYYNYYYNYYYNNYYNY", "YNNYNNNNYNYYNYNNYNNNNNNNNYYNNNYNYNNYYNYNNYYYYNNYNN", "YYNNYYNYNYNYYYNYNYYYNYNNNNNNNYNYNNNYNYYNYYNNNYNYNN", "YYYYYYNNYNYNNNNYYYNNYYNNYNYNNYYNNNNYYYNNYYNNYYYYYY", "YYNYYYYYNNYYYNYYYNNYNNYNYNYNNYYNNNNNNYNYNNYYNYYNNY", "NNNYYYNNNYYYNYNNYYNNYYNNNNNYYYYYYYNNNNYYYYNYYYYNNN", "NNYYNYNYNNNYYYYNYNNNYYNNYYNNYYNYNYNNNNNNYNNNNYNYNY", "NNYYNYYYYYNYNNYYYYNYNYNYYNNYNNYNYYYNNNNNYNNYNNYNNN", "YYYYYYNNNNNYNNNNYNYYNNNNYYYYYNYYYNNYNNNYNYYNNNNNYN", "NYYNNYYNNNNYNYNNYNNNYNNNNNNYNNYNNNYYNNYNNYYNYYYNYY", "YNNNYYYNNNYNNNYNNYYNNYNYYYNNNNNNYYNYYYNNNNYNYYNYNN", "NYYNYNYYNNYNNYNYNNYNYYNYYNNNNYYYYYNYNNYYNNYNYNYNYN", "NYNNYNNYYNNYNYYYYNNYNYNNYNNNNNYYNNYNNNYYYYNNYYNYNN", "YYYYNYYYYNNYNYYNYYNYNYYNYNNYNYYYNNYYNYNNNNNNYNNYYN", "NNNYYNYYYYNYNNNYYYYNYYYNYNNNYNNYNYNYNNNYYYYYNNYYYY", "NYYYNNNYNNYNNYYYNYNNNYNNNYYYYYNNYYYYYNNYYNYNNNYYNY", "NNNNYNNYYYNYYNYNNNNNYYNYNNNNYYYNNYYYNYNYNYNNYYNYNN", "NYYYYNNYNYYYNNYNNNNYYYYYNNNYNNYYYYNNYNNNYNYYYYYNYY", "NYYYNNNNNNYNNNYYNNNNNYNYYNNYYNNNNYNNNNYYNYNYYNNYNY", "YNYYNNYYYNNYNYNYYNYYNNYNNYYNYNYNNYYNYNNYNNNNYYNYYN" };
    int M = 461;
    assertArrayEquals(new int[] { 25, 24, 24, 28, 29, 21, 22, 27, 24, 24, 26, 31, 19, 26, 24, 24, 32, 25, 24, 19, 22, 27, 21, 21, 28, 8, 13, 14, 13, 15, 11, 7, 14, 14, 16, 11, 12, 16, 11, 8, 11, 13, 12, 17, 14, 10, 10, 14, 8, 13 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case50() {
    String[] roads = { "NNYNYYYYYNYNYYYYYYYYYYNYYYNYYYYYYYYYYYYYYYNYYY", "NNYYNYNYYYYYNYYNYYYNYYYYYYNYYYYYYYYYYYYYNYYYYY", "YYNYYYYYYYYYYYYYYNYYYYYYNYYYYYYNYYYYYYYNYYNYYY", "NYYNNYYNYYYYYYYYYYYYYYYYYYNNYYYNYYYYYYYYYYYYYY", "YNYNNYNYNYYYYYYNNYNYNYNYYYYYYYYYYYNYYYYYYYYYYY", "YYYYYNYYYYNNYYYNNYYYYYYYYNNYYYYNYNYNYYNYYYYNYN", "YNYYNYNNYYYNYYYYYYYYYYNYYNYYNYYYYYYYYYYYNYYYNY", "YYYNYYNNYYYYNYYYYNNYYYYYYYNYYNYNYYYYYYYYNYYNYN", "YYYYNYYYNYYYNYYYYYYYYYYNYYYYYYYYYYNYYNYYNYYYYY", "NYYYYYYYYNYYNYYNYYYYYYYYNYYYYYYYYYNYYYYNNYYYNY", "YYYYYNYYYYNNYNYNYYNYYYYYNYYNYYYYYYYNYYNYYYYNYY", "NYYYYNNYYYNNYYYNNYYYYYYYNNYYYNYYYYYYYYYYNYYYYN", "YNYYYYYNNNYYNYYYYYYNNYYYYNNYYYYYYYNYYYYYYYYYYY", "YYYYYYYYYYNYYNYYNNYNYYYYYYYYYNYYYYNYYYYYYNNYYN", "YYYYYYYYYYYYYYNYYNYNYYYYYYYYNYYYNYYYYNYYYNYYYY", "YNYYNNYYYNNNYYYNYYNNYYYYYYYYNYYYNYYYYYNYYNNYYY", "YYYYNNYYYYYNYNYYNYYYNYYNYYNNYYYYYNNYNNYNYYNYYY", "YYNYYYYNYYYYYNNYYNYYYNNYYYYYNNYYYYYYYYNYNYNNYN", "YYYYNYYNYYNYYYYNYYNNYYYYYYYNYYYYYYYYYYYYYYYYYN", "YNYYYYYYYYYYNNNNYYNNYYYYYNYYYYNYYYYNYNNYNYYNYY", "YYYYNYYYYYYYNYYYNYYYNYYYYYNNYYYNYNYYNYYYYYYYYY", "YYYYYYYYYYYYYYYYYNYYYNYYYYYYNYYYYYNYNYNYYYYYYY", "NYYYNYNYYYYYYYYYYNYYYYNYYNYYNYYYYYNYNYNYNNYYYY", "YYYYYYYYNYYYYYYYNYYYYYYNYYYYYYYNYYYYYYYYNNYYYY", "YYNYYYYYYNNNYYYYYYYYYYYYNYNYYNYYYYYYYYYYYYYNYN", "YYYYYNNYYYYNNYYYYYYNYYNYYNYNNYYYYNYYYYYNYYNYYY", "NNYNYNYNYYYYNYYYNYYYNYYYNYNNNYYYYNNYNYYYYYNYNY", "YYYNYYYYYYNYYYYYNYNYNYYYYNNNNYNYYYYYNYYYYYYYYY", "YYYYYYNYYYYYYYNNYNYYYNNYYNNNNYNYYYYYYYNYYNNYYY", "YYYYYYYNYYYNYNYYYNYYYYYYNYYYYNYNYYYNNYYNYYNYYN", "YYYYYYYYYYYYYYYYYYYNYYYYYYYNNYNYYNNYNYYYYYNYNY", "YYNNYNYNYYYYYYYYYYYYNYYNYYYYYNYNYYYYYYYYNNYYYN", "YYYYYYYYYYYYYYNNYYYYYYYYYYYYYYYYNNYYYNNNNYYNNY", "YYYYYNYYYYYYYYYYNYYYNYYYYNNYYYNYNNYYYYYYYNYNNY", "YYYYNYYYNNYYNNYYNYYYYNNYYYNYYYNYYYNYYYYYYNYYYN", "YYYYYNYYYYNYYYYYYYYNYYYYYYYYYNYYYYYNYYYYYYNYNY", "YYYYYYYYYYYYYYYYNYYYNNNYYYNNYNNYYYYYNNYNNNYNYY", "YYYYYYYYNYYYYYNYNYYNYYYYYYYYYYYYNYYYNNYYYNYNYY", "YYYYYNYYYYNYYYYNYNYNYNNYYYYYNYYYNYYYYYNYYYYYYN", "YYNYYYYYYNYYYYYYNYYYYYYYYNYYYNYYNYYYNYYNNYYYYY", "YNYYYYNNNNYNYYYYYNYNYYNNYYYYYYYNNYYYNYYNNNYYYY", "YYYYYYYYYYYYYNNNYYYYYYNNYYYYNYYNYNNYNNYYNNYYYN", "NYNYYYYYYYYYYNYNNNYYYYYYYNNYNNNYYYYNYYYYYYNYNY", "YYYYYNYNYYNYYYYYYNYNYYYYNYYYYYYYNNYYNNYYYYYNYY", "YYYYYYNYYNYYYYYYYYYYYYYYYYNYYYNYNNYNYYYYYYNYNN", "YYYYYNYNYYYNYNYYYNNYYYYYNYYYYNYNYYNYYYNYYNYYNN" };
    int M = 45;
    assertArrayEquals(new int[] { 38, 6, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case51() {
    String[] roads = { "NYYYYYNYYYNYYNYYYYYYYYYYYNYYYYYYYYNYYYYYNYYYYYYY", "YNYYYYNNYYYYYYYYYNYYYYYYNNYYYYYNYYYYYYYYYYNYYYYY", "YYNYNYYYNYNNNYYNYYYYYYYNYYYYYYYYYYYYYYNNNYYNYYYY", "YYYNYYYYYYYYYYYNYYNYYYNYNNYNYNYYYYYYYYYYYYNYNYYY", "YYNYNYYYYNYYYYYYYNYYYYYYYNYYYNYNNNYNYYNYNYYYYYYY", "YYYYYNYYNNNYYYYYNYYYNYYYYYYYYYNYNYYYYYYNYNYYYYYY", "NNYYYYNYYYYYYYYYYNYYYNYNYYYYYYNYYYYYYNYNYYYYYYYY", "YNYYYYYNYNNYNYYNYYYNNNNYYYYYYNYYYYYYYNYYYYYYYYYY", "YYNYYNYYNYNYNYNYYYYYYNYYYYNYYNYYYYYYYYYYNYNYYYNN", "YYYYNNYNYNYYYYYYYYYYYYYYYNYNYYYYYYNYYNNNYYYYYYYY", "NYNYYNYNNYNYYYYYYYYYNYNYYYYYYYYYYNYYYYNYYYYYYYYY", "YYNYYYYYYYYNNYYYYYYNNYNYNYNNYYYYYYYYYYYNYYYNYYYY", "YYNYYYYNNYYNNYYYYYYYYYYYYYYNYYYYYYNYYYYNYYYYYYYY", "NYYYYYYYYYYYYNNYYYYYYYNYYYYYNYYNNYYYYYYNNYYYYYNY", "YYYYYYYYNYYYYNNYNYYYYYYNYYYYYYYYYYYYNYYYYYYYYYYY", "YYNNYYYNYYYYYYYNNYYYYYYNYYYYYNYNYYYYYYNYYYYYYYYY", "YYYYYNYYYYYYYYNNNNYYYYYYYYYYYYYYYYNYYNYYYNYYYYYY", "YNYYNYNYYYYYYYYYNNYYNYYYNNYYYNYYYYNYYYYYYNNYYYYY", "YYYNYYYYYYYYYYYYYYNNNYYYYNYYYYYYYYNYYYYYYYYYYYNY", "YYYYYYYNYYYNYYYYYYNNYYNYYYYYYYNYYYYYYYNYYYYYYYNY", "YYYYYNYNYYNNYYYYYNNYNYYYYYYYYYYYYYYYYYYYYYNNYYYY", "YYYYYYNNNYYYYYYYYYYYYNNYYNYYYYYYYNYYYYYYYYYYYYYY", "YYYNYYYNYYNNYNYYYYYNYNNYNYYYYYYYYNNYYYYYYNYNYYYY", "YYNYYYNYYYYYYYNNYYYYYYYNYYYYYYYNYYYYNYYNYYYYNYYY", "YNYNYYYYYYYNYYYYYNYYYYNYNYYYYYYNYYYYYYYNNYYYYYNY", "NNYNNYYYYNYYYYYYYNNYYNYYYNYYYYNYYYYYYYYNYNYYNYYY", "YYYYYYYYNYYNYYYYYYYYYYYYYYNYYYYYYNYYYYYYNYYYYYYN", "YYYNYYYYYNYNNYYYYYYYYYYYYYYNYYYYYYYYYYYYYYYNYYYY", "YYYYYYYYYYYYYNYYYYYYYYYYYYYYNYYNYNNYYNYYYYYYNYYY", "YYYNNYYNNYYYYYYNYNYYYYYYYYYYYNYYNYYYNYNYYYNYYYYY", "YYYYYNNYYYYYYYYYYYYNYYYYYNYYYYNYYNYYYYYYYYNYYYNY", "YNYYNYYYYYYYYNYNYYYYYYYNNYYYNYYNYNYYYNYYYYNYYYYY", "YYYYNNYYYYYYYNYYYYYYYYYYYYYYYNYYNYNYYYYYYYYYYYYN", "YYYYNYYYYYNYYYYYYYYYYNNYYYNYNYNNYNYYYYYYYYNNNYYY", "NYYYYYYYYNYYNYYYNNNYYYNYYYYYNYYYNYNNNNYYYNYYYYYY", "YYYYNYYYYYYYYYYYYYYYYYYYYYYYYYYYYYNNNYYYYNYYYYYN", "YYYYYYYYYYYYYYNYYYYYYYYNYYYYYNYYYYNNNYYYYYYYNYYY", "YYYYYYNNYNYYYYYYNYYYYYYYYYYYNYYNYYNYYNYYYYYYNYYY", "YYNYNYYYYNNYYYYNYYYNYYYYYYYYYNYYYYYYYYNNYYYNNYNY", "YYNYYNNYYNYNNNYYYYYYYYYNNNYYYYYYYYYYYYNNYNYNYYYY", "NYNYNYYYNYYYYNYYYYYYYYYYNYNYYYYYYYYYYYYYNYYYNYYY", "YYYYYNYYYYYYYYYYNNYYYYNYYNYYYYYYYYNNYYYNYNYYYYNY", "YNYNYYYYNYYYYYYYYNYYNYYYYYYYYNNNYNYYYYYYYYNYYYYY", "YYNYYYYYYYYNYYYYYYYYNYNYYYYNYYYYYNYYYYNNYYYNYYYY", "YYYNYYYYYYYYYYYYYYYYYYYNYNYYNYYYYNYYNNNYNYYYNNNY", "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYNNYN", "YYYYYYYYNYYYYNYYYYNNYYYYNYYYYYNYYYYYYYNYYNYYNYNY", "YYYYYYYYNYYYYYYYYYYYYYYYYYNYYYYYNYYNYYYYYYYYYNYN" };
    int M = 450;
    assertArrayEquals(new int[] { 41, 40, 36, 38, 36, 38, 39, 36, 35, 38, 38, 37, 40, 29, 12, 11, 13, 11, 13, 12, 10, 11, 9, 12, 11, 9, 12, 10, 13, 10, 12, 11, 11, 12, 11, 13, 13, 10, 9, 7, 9, 12, 10, 11, 12, 13, 12, 12 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case52() {
    String[] roads = { "NYYYYYYNYYYYYYNNYYNNYNYYYNYNYYYNYYNYYYYYYYYYYYYYYN", "YNYYYNNYYNYNYYNYNYNNYYYYYYYYYNYYYYYYYYYNYNYYYNNNNY", "YYNYYYNNYYYYYYYYYNNYYYNYYYYYNYYYYYNNNNYYYYYYYYYYYY", "YYYNYYNYYYYYYYYYYNNNYYYYYYNYYYYYYYYNNYYNYYYNNYYYYY", "YYYYNYYYYNYYYYYYNYYNYYYYNNNYNNNNNYNNYYYNYYYYYNYNYY", "YNYYYNNYYYYYYYYNYYYYNYYYYYYYYNYYNNNNYNYYYYYYNYYYYY", "YNNNYNNYYYYNYYYYYNNYYYNYYYYYYYNNYNYNNYNYNYYYYYNNYN", "NYNYYYYNNNYYYYYYYYYNYYYYYNNYYYYYNYNYYNNNYYYNYYYNYY", "YYYYYYYNNNYNNNNNYYNYNNYYYNYYNYYNYYNYYYNNYYYYYYYYYY", "YNYYNYYNNNYYYYYNYNYYYYYYYYNYYNYYNYNYYNNNYNYYYYYNNY", "YYYYYYYYYYNYYYNNYYYYYYYNYYNYYNYNYYNYNYNNYYYYNYYYYY", "YNYYYYNYNYYNYNNNYYYYYNYNYYYNYYYYYYNYYYYNYNYNYYYYYY", "YYYYYYYYNYYYNYYYYYYYYNYYNYYNYYYYNYYYYYYYYNYNYYYYYY", "YYYYYYYYNYYNYNYYNYYNYNYYYYNYYYYYYYNYYYYYYYYNYYYYYN", "NNYYYYYYNYNNYYNNYNYYYYYYYYYYYYYYYNYYYYYYYYNYNYYYYY", "NYYYYNYYNNNNYYNNNYYYYYYNNYYNYYNYYYYNYYYYNYNYYYNYYY", "YNYYNYYYYYYYYNYNNNYYNYYYYYYNYYYYYYYYNYYYYYYNYYYYNY", "YYNNYYNYYNYYYYNYNNNYYYYYYYYYNYYYYYYYYYYNYYYYNYYYNN", "NNNNYYNYNYYYYYYYYNNYNYNNNYNYYYYYYYYYYNYNNYNNNYYYNN", "NNYNNYYNYYYYYNYYYYYNYNYNYYYYNYYYYYNYYYYYNYNYYYYYYN", "YYYYYNYYNYYYYYYYNYNYNYYYYYYYYYYYNYYYYYYYYNYYYYYYNY", "NYYYYYYYNYYNNNYYYYYNYNYNYNNYNYYNYYYYYNNYYNYYNYYYNN", "YYNYYYNYYYYYYYYYYYNYYYNNYYYNYNNNNYNYYNYYYYNYNYYNYY", "YYYYYYYYYYNNYYYNYYNNYNNNNYYNYYYYYNYYYYNYYYYNYYNYYY", "YYYYNYYYYYYYNYYNYYNYYYYNNYNYYNYYYYNYYNYNNYYYYYNNYY", "NYYYNYYNNYYYYYYYYYYYYNYYYNYYNNYYNYNYYYYYYYYYYYYYYY", "YYYNNYYNYNNYYNYYYYNYYNYYNYNYYYNYYYYYNYNYYYYYYYYYYY", "NYYYYYYYYYYNNYYNNYYYYYNNYYYNNNYNYYYNYNYYYYYYYYNYYY", "YYNYNYYYNYYYYYYYYNYNYNYYYNYNNYNYNYYYNYNYYYYNYYYYYY", "YNYYNNYYYNNYYYYYYYYYYYNYNNYNYNYYNYYYYYYNYYYYYNYNYY", "YYYYNYNYYYYYYYYNYYYYYYNYYYNYNYNYYNYNYYYYNYYYYNNNYN", "NYYYNYNYNYNYYYYYYYYYYNNYYYYNYYYNNYYYNYYYYYYNYNYYNY", "YYYYNNYNYNYYNYYYYYYYNYNYYNYYNNYNNYYNYYYNYNYYYYNYYY", "YYYYYNNYYYYYYYNYYYYYYYYNYYYYYYNYYNYYYYYYYYYYYYNNYN", "NYNYNNYNNNNNYNYYYYYNYYNYNNYYYYYYYYNYNNYYYYYYNYYYYY", "YYNNNNNYYYYYYYYNYYYYYYYYYYYNYYNYNYYNYYYYYYNYYYYYYN", "YYNNYYNYYYNYYYYYNYYYYYYYYYNYNYYNYYNYNYNYYNYYNYYYYN", "YYNYYNYNYNYYYYYYYYNYYNNYNYYNYYYYYYNYYNYNYYNYYYYYYY", "YYYYYYNNNNNYYYYYYYYYYNYNYYNYNYYYYYYYNYNYNYYYYYYYNY", "YNYNNYYNNNNNYYYYYNNYYYYYNYYYYNYYNYYYYNYNYYYYYYNYYY", "YYYYYYNYYYYYYYYNYYNNYYYYNYYYYYNYYYYYYYNYNYNYYNYNYY", "YNYYYYYYYNYNNYYYYYYYNNYYYYYYYYYYNYYYNYYYYNYYYNNYYY", "YYYYYYYYYYYYYYNNYYNNYYNYYYYYYYYYYYYNYNYYNYNYYYYYYY", "YYYNYYYNYYYNNNYYNYNYYYYNYYYYNYYNYYYYYYYYYYYNNNYYNY", "YYYNYNYYYYNYYYNYYNNYYNNYYYYYYYYYYYNYNYYYYYYNNYYYNY", "YNYYNYYYYYYYYYYYYYYYYYYYYYYYYNNNYYYYYYYYNNYNYNNYNY", "YNYYYYNYYYYYYYYNYYYYYYYNNYYNYYNYNNYYYYYNYNYYYNNYYN", "YNYYNYNNYNYYYYYYYYYYYYNYNYYYYNNYYNYYYYYYNYYYYYYNYY", "YNYYYYYYYNYYYYYYNNNYNNYYYYYYYYYNYYYYYYNYYYYNNNYYNY", "NYYYYYNYYYYYYNYYYNNNYNYYYYYYYYNYYNYNNYYYYYYYYYNYYN" };
    int M = 333;
    assertArrayEquals(new int[] { 38, 34, 39, 39, 33, 38, 31, 35, 33, 33, 23, 8, 10, 10, 7, 6, 9, 7, 5, 6, 9, 9, 9, 10, 10, 7, 6, 10, 7, 6, 8, 6, 6, 8, 3, 5, 7, 6, 6, 4, 9, 8, 10, 8, 8, 8, 8, 5, 8, 8 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case53() {
    String[] roads = { "NNNNNYNYNNNNNNNNYYNYYNNNNNNNNNNYNYNNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNNNYNNYNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNY", "NNNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNNNNNNNNYYN", "YNNNNNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNYNNNNNYYNNNNNNNNYYNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNNNYYNNNNNN", "NNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNYNYNNYYNNNNNNNNNNNNNNNNYN", "NNNNNNNNNYNNNYNNNNNNYNNNNNNNNYNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNNNNYNYNYNNNNNNNNNNYNNNNNNY", "NNNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNNNYNNNY", "NNNNYNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNNYNNNNNNNNNNNYNNNNNNYNYNNNNNNNNNYNNNNNNNNN", "YNNNNNYNNNNNNNNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YNNNYNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YYNNNNNNNNNNYNYNNNNNNNYNNNNNNYNNYNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNYNNYYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNYNYNNNNNNNNYNNNNNYYNNNNNNNNNYYNNNNN", "NNNNNNYNNNNNNNNNYNNNNNYNNNNNNNNNYNNYNNNNNNNYNN", "NNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNYNNNNYNNNNNNNNNNNYNNNYNNNNNNNNNNNNN", "NNYNNNNNNNNYNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNY", "NNNNNNNNNNYNNNNNNNNNNNNYNNYNNNNNNNNNNNNNYNNNNY", "NNNNNNNYNNNNYNNNNNNNYNNYNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNYNNYN", "YYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNYNNNYNYNNYNNNNNNNNNNNNNNNN", "YNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNYYNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNN", "NYNYNNNYNYNNNYNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "NNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNN", "YNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNYNNNNNYNNNNNNNNNNNNYNNNNNYNNYNNNNNN", "NNNYNNNNNNNNNYYNNNNNNNNNNNNYYNNNNNNNNNNNNNNNNN" };
    int M = 420;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case54() {
    String[] roads = { "NYYYYYYNYYYYYYYYNYYNYNNNYNYYYYYNYYYYYNYYNNYYYN", "YNYNYYYYNYNNYYNYYYNYYYYYYYYYYYYYYNYNYYYNYYYNYY", "YYNYYYYNYYYYYYNNYNYYYYNYYYYYYYNNYNYYYYYYYNYYYY", "YNYNYNYYYYYNNYYYNNYNNYYYYNYNYYYYNYYYYYYNYNNNYY", "YYYYNYYYYYYYYYYYNYNYYYYYYNNYNYYYYYNYYNYYNYYYYN", "YYYNYNYYYYYYYNYNYNYNNNNYYYNYYYNYYYYNYYYYYYNYYY", "YYYYYYNYYYYYNYYNYYNYYYYYYYYYYYYYYYYNYYYNYYNNYY", "NYNYYYYNYYYYYNYYYYYNYNYNYYYYNYYYYYYYYYYNYYYYYN", "YNYYYYYYNYYYYYYYYNYNYNYNYYYYYNYYYYYNYNYNYNYYYY", "YYYYYYYYYNYYYYYYYYYYNYYNYYYYNYYYYYNYYYYYNYYYNY", "YNYYYYYYYYNYYYYYYYYYYYYNYYYYYNYNYYYNNYNNNNYYNN", "YNYNYYYYYYYNYYYYYYYYYYYYYYYYYYYYYYNYYNNYNYYYYY", "YYYNYYNYYYYYNYYNYYNYYYYYYNNYNNYYNYYYNYYYYYYNYY", "YYYYYNYNYYYYYNYYNYYYYYNNYYYYYYYYYYNYYYYYNNYYYN", "YNNYYYYYYYYYYYNYYNYYYYYNYYYYNYYYYNYYYYYYNYYYYY", "YYNYYNNYYYYYNYYNNYNNYNYYYYYYYYYYNYNNYYYYYYYNYY", "NYYNNYYYYYYYYNYNNNYYYYNYNNNNYYYYYYYYYYNYYYYNNY", "YYNNYNYYNYYYYYNYNNYYYYYYNNNYYYYYYNNNYYYYYYYYYY", "YNYYNYNYYYYYNYYNYYNYNYNYYYYYYYYNYYYYYYNYYYYYNN", "NYYNYNYNNYYYYYYNYYYNYYYYYNNYYNYYYYNNYYNYNNYYYY", "YYYNYNYYYNYYYYYYYYNYNNYYYYYYYYNYYNYYNYYNYYYYYY", "NYYYYNYNNYYYYYYNYYYYNNNYNYYYNYYYYYNYYNYYYYNYYN", "NYNYYNYYYYYYYNYYNYNYYNNYYYNYYNYYYNYYYYYNYYYNYY", "NYYYYYYNNNNYYNNYYYYYYYYNYYYYNYYNYNYYYYYNYYYYYY", "YYYYYYYYYYYYYYYYNNYYYNYYNYYYYYYYYNYNNYYYYYYYNN", "NYYNNYYYYYYYNYYYNNYNYYYYYNYYNYNYYYYYYYYYNNYYYN", "YYYYNNYYYYYYNYYYNNYNYYNYYYNYYYYYYYYYYYYYYYYYYY", "YYYNYYYYYYYYYYYYNYYYYYYYYYYNYYYYYYYYNNYYNYYYYY", "YYYYNYYNYNYYNYNYYYYYYNYNYNYYNYYYNYYYYYYYNNYNYY", "YYYYYYYYNYNYNYYYYYYNYYNYYYYYYNYYNYYNYYYYYYYYYN", "YYNYYNYYYYYYYYYYYYYYNYYYYNYYYYNYYNYNNYYYYYYYYY", "NYNYYYYYYYNYYYYYYYNYYYYNYYYYYYYNNYYNYYYYYYYYYY", "YYYNYYYYYYYYNYYNYYYYYYYYYYYYNNYNNYYYYYYNYYNNNY", "YNNYYYYYYYYYYYNYYNYYNYNNNYYYYYNYYNYYNNYYYYYYYY", "YYYYNYYYYNYNYNYNYNYNYNYYYYYYYYYYYYNYNYYYNYYYYY", "YNYYYNNYNYNYYYYNYNYNYYYYNYYYYNNNYYYNYNNYYYYYYN", "YYYYYYYYYYNYNYYYYYYYNYYYNYYNYYNYYNNYNYYYYYNYYN", "NYYYNYYYNYYNYYYYYYYYYNYYYYYNYYYYYNYNYNYNYNNYYY", "YYYYYYYYYYNNYYYYNYNNYYYYYYYYYYYYYYYNYYNNNYYYYY", "YNYNYYNNNYNYYYYYYYYYNYNNYYYYYYYYNYYYYNNNYYYYYY", "NYYYNYYYYNNNYNNYYYYNYYYYYNYNNYYYYYNYYYNYNYNYYY", "NYNNYYYYNYNYYNYYYYYNYYYYYNYYNYYYYYYYYNYYYNYNYY", "YYYNYNNYYYYYYYYYYYYYYNYYYYYYYYYYNYYYNNYYNYNYYY", "YNYNYYNYYYYYNYYNNYYYYYNYYYYYNYYYNYYYYYYYYNYNYN", "YYYYYYYYYNNYYYYYNYNYYYYYNYYYYYYYNYYYYYYYYYYYNY", "NYYYNYYNYYNYYNYYYYNYYNYYNNYYYNYYYYYNNYYYYYYNYN" };
    int M = 292;
    assertArrayEquals(new int[] { 33, 35, 36, 30, 36, 33, 38, 36, 35, 20, 9, 8, 8, 8, 8, 7, 7, 6, 7, 5, 7, 6, 6, 6, 9, 6, 7, 8, 7, 8, 7, 7, 8, 7, 8, 5, 9, 6, 9, 4, 7, 5, 6, 6, 9, 6 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case55() {
    String[] roads = { "NYNNYYYNNNYNNNNNNNYNYYNNYYNYNYNYNYYNNNNYNNNYNYNYNN", "YNNNNYNYNNNNNYYYNYNNYNNYYYNNYNYNYNYNNNNYYNNYNYNNYY", "NNNNYNNYYYNYNNNNNNYNNNNYNYNYYYNYNNYNYYNNYNNNNNNNNN", "NNNNNNNNNNYYNNYYYNNYYYYNNNYYYNNYNYNNYNNNYYYYNYNNYN", "YNYNNNYNNNYNYYNNNNYNYNYNYYYYYYNNNYYYYNYYYYNYNNYYYY", "YYNNNNNNYYYNYYYYNYYYYYNNNYYNNYNYNNNYYNYYYNYNNYNNYN", "YNNNYNNNNNYYYNNNYNNYNNNNYNNYYNNNNNYYYYYYYNYNNYYYNN", "NYYNNNNNNYYNNNNYNNYNNNNNYYNNNNNNNNNYYYYYYNYNNNYYYN", "NNYNNYNNNNNYNNYYNNNNNNNNYYNYYNYNNNNNNNYYYYNNNNYNNN", "NNYNNYNYNNNNYNNYNNYYNYNNYNYYNNYYNYYNNYYNNNNNNYNNYN", "YNNYYYYYNNNNNYYYNNNYYNYNNNNYYYYNNNYNNYNYNNNNYYNYYN", "NNYYNNYNYNNNNNYNNNNNNNNYYNNYNYYYNYNYNNYNYYYNYNNNNY", "NNNNYYYNNYNNNNNNYYYYNNYYYNNNNYNNYYNNNNYNNYNNNNNYNN", "NYNNYYNNNNYNNNNYYNYYNNNYNNNNYNNNNYNYNNYNNYYYYNYNNN", "NYNYNYNNYNYYNNNNNNNNNNNYYYYNNYNNNNYYYNYNYYYYNNYNYY", "NYNYNYNYYYYNNYNNNYNNNNYYNYYYNNNYYNYYNNYNYYYYYNYNNN", "NNNYNNYNNNNNYYNNNYNNYNYNYNNNNNYYYYNYNYNNNNYYNYYNNN", "NYNNNYNNNNNNYNNYYNYNNNNYNYNYYYYNNYNYYYNNNNNNYNYYNN", "YNYNYYNYNYNNYYNNNYNYNNNYNNNNNYNYYNNNNNYNNNNYNYNNNY", "NNNYNYYNNYYNYYNNNNYNYYYNYYNNNYNNNNNNNNNYNNNNNNYNYY", "YYNYYYNNNNYNNNNNYNNYNNNNYYNNNNNNNYNNYYNYYNYNYYYNNY", "YNNYNYNNNYNNNNNNNNNYNNYNNNYNYYNNNNYYNNNNYNNNNNYYNN", "NNNYYNNNNNYNYNNYYNNYNYNYYNNYYNYYNYNNNYNNYYNNNYNNYY", "NYYNNNNNNNNYYYYYNYYNNNYNYNYNYNNNNNYNYNNNNNYNNYNNYN", "YYNNYNYYYYNYYNYNYNNYYNYYNNNNNNNNYNYYNYNNNNYYYNNYNY", "YYYNYYNYYNNNNNYYNYNYYNNNNNNNNNNYNNNNNNYNNNYNNNYYNN", "NNNYYYNNNYNNNNYYNNNNNYNYNNNNYYNNNNNYYYNYNYYNNNYNNY", "YNYYYNYNYYYYNNNYNYNNNNYNNNNNNYNYNNNNNNNYYNNYYYYYNN", "NYYYYNYNYNYNNYNNNYNNNYYYNNYNNYYNNNNNYYYNNYNYYNYYNN", "YNYNYYNNNNYYYNYNNYYYNYNNNNYYYNYNNNNNNYNNYYNYYNNNNN", "NYNNNNNNYYYYNNNNYYNNNNYNNNNNYYNYYNNNNNNNYNYYYYNYNN", "YNYYNYNNNYNYNNNYYNYNNNYNNYNYNNYNNNNYNNNYYNNYNNNNNY", "NYNNNNNNNNNNYNNYYNYNNNNNYNNNNNYNNNNNNNNYYNNYYYYYNY", "YNNYYNNNNYNYYYNNYYNNYNYNNNNNNNNNNNNNYNNNYNYNYNNNYY", "YYYNYNYNNYYNNNYYNNNNNYNYYNNNNNNNNNNNNNNNNNYNNNYNNY", "NNNNYYYYNNNYNYYYYYNNNYNNYNYNNNNYNNNNNNYNNNYNYNNNNN", "NNYYYYYYNNNNNNYNNYNNYNNYNNYNYNNNNYNNNYNYNNNNYNNNNY", "NNYNNNYYNYYNNNNNYYNNYNYNYNYNYYNNNNNNYNYNYNYYYYNNNN", "NNNNYYYYYYNYYYYYNNYNNNNNNYNNYNNNNNNYNYNYYNNNNYYNYY", "YYNNYYYYYNYNNNNNNNNYYNNNNNYYNNNYYNNNYNYNYNNNYNNYYY", "NYYYYYYYYNNYNNYYNNNNYYYNNNNYNYYYYYNNNYYYNNYYNNNNYN", "NNNYYNNNYNNYYYYYNNNNNNYNNNYNYYNNNNNNNNNNNNNNYNYYNY", "NNNYNYYYNNNYNYYYYNNNYNNYYYYNNNYNNYYYNYNNYNNNYYNNNN", "YYNYYNNNNNNNNYYYYNYNNNNNYNNYYYYYYNNNNYNNYNNNYNYYNY", "NNNNNNNNNNYYNYNYNYNNYNNNYNNYYYYNYYNYYYNYNYYYNNNNYN", "YYNYNYYNNYYNNNNNYNYNYNYYNNNYNNYNYNNNNYYNNNYNNNNYNN", "NNNNYNYYYNNNNYYYYYNYYYNNNYYYYNNNYNYNNNYNNYNYNNNYNY", "YNNNYNYYNNYNYNNNNYNNNYNNYYNYYNYNYNNNNNNYNYNYNYYNYY", "NYNYYYNYNYYNNNYNNNNYNNYYNNNNNNNNNYNNNNYYYNNNYNNYNN", "NYNNYNNNNNNYNNYNNNYYYNYNYNYNNNNYYYYNYNYYNYNYNNYYNN" };
    int M = 437;
    assertArrayEquals(new int[] { 19, 21, 16, 21, 28, 26, 21, 18, 15, 19, 23, 19, 17, 18, 22, 25, 18, 19, 18, 18, 20, 14, 21, 18, 24, 17, 18, 21, 23, 21, 18, 18, 11, 11, 12, 14, 12, 13, 14, 14, 19, 12, 15, 16, 12, 14, 16, 13, 11, 11 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case56() {
    String[] roads = { "NNNNNNYNYYYYYYNNNNNYNYNYYYYYYNYYNYNYYNNYYYYYYNNY", "NNNYYYYNYYNYYYYYNNYYYYYNYNNYYYYNNYNYNYNYYYYNNYYN", "NNNYNNNYNNYYNYYNYYYNYYYYNNNNYYNYYYYNNYYYNNYNYYYN", "NYYNNNNYNYYNNNNYNYNYYYNNNYYNYNYNYNNNNYYYNNNYYYYY", "NYNNNYYYYYYYYNNNYYYNYNYYYYYNYYYNNYNYYYYNYNNYYYYN", "NYNNYNYYYYYYYYYYNYNNYYYYYYYNNNYYYNNYYYNNNYYYNYNN", "YYNNYYNYYYYNNNNYYNYNYYYNNNNNNYYNNYYNYYNYYYYYNYNN", "NNYYYYYNNYNNNYNYYYYYNNYNYYNYNYYYYNNNYNNNNNNYNYYN", "YYNNYYYNNYYNNNNYNNNYYYYYYNYYYYNNYYYYNNNNNYYNNNYY", "YYNYYYYYYNYNYNNYYNNNNYNYYNYNNYYYYNYYNNNYNYNNYNYY", "YNYYYYYNYYNNNYYNNNYNYYYNYYNYYYYNYYYNNNYYNYYNYNNY", "YYYNYYNNNNNNYNYYYYYYNYNYYYNNNYYNNYYYYNYYNYYNYNYN", "YYNNYYNNNYNYNYNNYNNYNYYNYYYYYYYYYNNYYYYYYYNYNNNN", "YYYNNYNYNNYNYNYYNYYNNYNYYYNYNYNYYNYYYYNNNYYNYNYY", "NYYNNYNNNNYYNYNNYYYNYNNYNNNNNNNNYNYYYYYNYYYYNYYY", "NYNYNYYYYYNYNYNNYNNYNYYNYYYYNNNNNYNNNNYYNYNNNYYY", "NNYNYNYYNYNYYNYYNNNNYYYYNNYNYYYNYYYNYYNYYYYYYYYN", "NNYYYYNYNNNYNYYNNNNNYNNNYYNYYNNNYYNYYYYYYYYYYYYY", "NYYNYNYYNNYYNYYNNNNNYYNNNYNYNYYNYYNYYYNYYYYNYNYY", "YYNYNNNYYNNYYNNYNNNNYNYNYYYYYYYNNYNYNYYNNYYYYNNY", "NYYYYYYNYNYNNNYNYYYYNYNNYYYNYYYYYYNNYNNYYYYYNNNY", "YYYYNYYNYYYYYYNYYNYNYNYNYNNYYYYNYYYYYNNYYNYYNNNN", "NYYNYYYYYNYNYNNYYNNYNYNNYYNYYYYNYYYYYNNNYYYNYNYY", "YNYNYYNNYYNYNYYNYNNNNNNNYNYNNNYNYYYNYYYNNYNYYNYY", "YYNNYYNYYYYYYYNYNYNYYYYYNYNYNYYYNNYYNYYYYYNNYYYY", "YNNYYYNYNNYYYYNYNYYYYNYNYNNYNNNNYNYYYYYYNYNYNYYY", "YNNYYYNNYYNNYNNYYNNYYNNYNNNYNNNYNYNYYYYYYYYYNYYY", "YYNNNNNYYNYNYYNYNYYYNYYNYYYNYYNYYYNNYYYNYNNNYYNY", "YYYYYNNNYNYNYNNNYYNYYYYNNNNYNYYNNYNYYYYNNYYYYNNN", "NYYNYNYYYYYYYYNNYNYYYYYNYNNYYNYNNYYNYYNYNYYNYYYY", "YYNYYYYYNYYYYNNNYNYYYYYYYNNNYYNNYNNYYYYNYNYNYYYY", "YNYNNYNYNYNNYYNNNNNNYNNNYNYYNNNNYYYNYNNYYYYNNYYN", "NNYYNYNYYYYNYYYNYYYNYYYYNYNYNNYYNNYYYNNYNNYNNNYY", "YYYNYNYNYNYYNNNYYYYYYYYYNNYYYYNYNNNNNYNYNYNYNNYY", "NNYNNNYNYYYYNYYNYNNNNYYYYYNNNYNYYNNYNYNNNYNYYNNN", "YYNNYYNNYYNYYYYNNYYYNYYNYYYNYNYNYNYNYYNNYYNYYYNY", "YNNNYYYYNNNYYYYNYYYNYYYYNYYYYYYYYNNYNNYYNNNYNYNY", "NYYYYYYNNNNNYYYNYYYYNNNYYYYYYYYNNYYYNNNNNYYYYNYN", "NNYYYNNNNNYYYNYYNYNYNNNYYYYYYNYNNNNNYNNYYNYYNYYN", "YYYYNNYNNYYYYNNYYYYNYYNNYYYNNYNYYYNNYNYNYYYYYNNY", "YYNNYNYNNNNNYNYNYYYNYYYNYNYYNNYYNNNYNNYYNYNNYYNY", "YYNNNYYNYYYYYYYYYYYYYNYYYYYNYYNYNYYYNYNYYNYNNNYY", "YYYNNYYNYNYYNYYNYYYYYYYNNNYNYYYYYNNNNYYYNYNYYYNN", "YNNYYYYYNNNNYNYNYYNYYYNYNYYNYNNNNYYYYYYYNNYNNYNY", "YNYYYNNNNYYYNYNNYYYYNNYYYNNYYYYNNNYYNYNYYNYNNYNN", "NYYYYYYYNNNNNNYYYYNNNNNNYYYYNYYYNNNYYNYNYNYYYNYY", "NYYYYNNYYYNYNYYYYYYNNNYYYYYNNYYYYYNNNYYNNYNNNYNY", "YNNYNNNNYYYNNYYYNYYYYNYYYYYYNYYNYYNYYNNYYYNYNYYN" };
    int M = 158;
    assertArrayEquals(new int[] { 27, 30, 26, 23, 31, 26, 4, 4, 4, 5, 5, 5, 4, 4, 3, 3, 2, 4, 3, 3, 5, 5, 4, 4, 4, 4, 4, 2, 5, 3, 5, 3, 3, 4, 1, 4, 3, 5, 3, 4, 3, 2, 3, 3, 4, 4, 4, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case57() {
    String[] roads = { "NYYYYNYYNYNYNYYYYNYYYYNYYYYYYNYYNYYNYNYYYYYYYYYY", "YNYYYYYNYNNNYYYYYYNYYYYYNNYNYNNYYYNYNNYYYYYYYYNY", "YYNNYNYYYYYYYYYYYYYYYYYYYNYYYYYYYYYYNNYYNYYYNYNY", "YYNNYYYYYYYYNYYYYYNNYYYYYNYYYYYYYYYYYYYYYYYYYNNY", "YYYYNYNYNYNYYYNYNYYYYYYYYYYYNYNYYYYYYNYYNYYYYYYY", "NYNYYNYYYNYYYYYYYYYYNYYYYYNYNYYYYYYYYYYYYYYNYYYY", "YYYYNYNYYYYYYYNYYYNNYNNYNYYNYYYYYYYYYYNNYNYYYYNY", "YNYYYYYNYYYYNYNNNYYYYYYNYYYYNYNYYYYYYYYYYYNYYYYY", "NYYYNYYYNYYYNYYYYYNYYYNNYYNNYYYYYNNYNYYNYNNYYNYN", "YNYYYNYYYNYYYNYYYYYYYYYYYYYYNYNYYYNYYYYNNYYYNYYY", "NNYYNYYYYYNYYYYYYYYYYYYYNNYNYYNYYYYYYYNNYNYYYYYY", "YNYYYYYYYYYNYYYNYNNYYYYNYYYYYYYYNYYYYYYYYNYNYYYN", "NYYNYYYNNYYYNYYYYYYNYYNYYYYYYYNYYYNNYYYYYYYYYYYY", "YYYYYYYYYNYYYNYYYYYYYYYNNYYNNNYNYYYYYYYYYYYYYYYY", "YYYYNYNNYYYYYYNYYYYNNYYNNNYYYYYYNYYYYYYYNYYYYYYY", "YYYYYYYNYYYNYYYNYNYYYNYYYNNYYYYYYYYNNNYNNYNYYYYN", "YYYYNYYNYYYYYYYYNYYYYYYNYYNYYNYNYNYNYYYYYYNYYYYY", "NYYYYYYYYYYNYYYNYNYYYYYYYNNYYNYYYYYNNYYYYYYYYYYY", "YNYNYYNYNYYNYYYYYYNYNYNYYYYYYNNYYYYNYYYYYYNYYYYN", "YYYNYYNYYYYYNYNYYYYNYYNYNYYYYYYYYYYYYYNYYYYYYNNY", "YYYYYNYYYYYYYYNYYYNYNNYNYYYYYYYYYNYYYYYYYYYNYYYY", "YYYYYYNYYYYYYYYNYYYYNNYYYYNYYNYNYYNYYYYNNYNYYYYY", "NYYYYYNYNYYYNYYYYYNNYYNYNNYNYYYYYYYYYYNYYYNYNYYY", "YYYYYYYNNYYNYNNYNYYYNYYNYNYNNNYYNYYYYYNYYYYYYYYY", "YNYYYYNYYYNYYNNYYYYNYYNYNYYYYYYYYYYYNNNYYYNNYYYY", "YNNNYYYYYYNYYYNNYNYYYYNNYNNYNYYYYNYYYYNYYYYNYNYN", "YYYYYNYYNYYYYYYNNNYYYNYYYNNNYYYYYYNNYYNYYNYYYYYN", "YNYYYYNYNYNYYNYYYYYYYYNNYYNNYYYYYYYYYYNNYYNYYYYN", "YYYYNNYNYNYYYNYYYYYYYYYNYNYYNNYNYYYYNYYYYYYNYNNY", "NNYYYYYYYYYYYNYYNNNYYNYNYYYYNNYYYNYNYYNYNYYYYYNN", "YNYYNYYNYNNYNYYYYYNYYYYYYYYYYYNYYYYNYYYYYYYYYYNY", "YYYYYYYYYYYYYNYYNYYYYNYYYYYYNYYNYYYNYYYYYYNNNYNY", "NYYYYYYYYYYNYYNYYYYYYYYNYYYYYYYYNYYYNYNYNYYYNYYY", "YYYYYYYYNYYYYYYYNYYYNYYYYNYYYNYYYNYYNNNYYYYYNYNY", "YNYYYYYYNNYYNYYYYYYYYNYYYYNYYYYYYYNNYYYYNYNYYYNY", "NYYYYYYYYYYYNYYNNNNYYYYYYYNYYNNNYYNNYYNYYYNYYYYY", "YNNYYYYYNYYYYYYNYNYYYYYYNYYYNYYYNNYYNYYNYYYNYNYY", "NNNYNYYYYYYYYYYNYYYYYYYYNYYYYYYYYNYYYNNYYYYYYYNY", "YYYYYYNYYYNYYYYYYYYNYYNNNNNNYNYYNNYNYNNYYYYNYNNY", "YYYYYYNYNNNYYYYNYYYYYNYYYYYNYYYYYYYYNYYNYYYYNNYN", "YYNYNYYYYNYYYYNNYYYYYNYYYYYYYNYYNYNYYYYYNYYYNYYN", "YYYYYYNYNYNNYYYYYYYYYYYYYYNYYYYYYYYYYYYYYNYYYYYN", "YYYYYYYNNYYYYYYNNYNYYNNYNYYNYYYNYYNNYYYYYYNYYYYY", "YYYYYNYYYYYNYYYYYYYYNYYYNNYYNYYNYYYYNYNYYYYNYYNY", "YYNYYYYYYNYYYYYYYYYYYYNYYYYYYYYNNNYYYYYNNYYYNYYY", "YYYNYYYYNYYYYYYYYYYNYYYYYNYYNYYYYYYYNYNNYYYYYNNN", "YNNNYYNYYYYYYYYYYYYNYYYYYYYYNNNNYNNYYNNYYYYNYNNY", "YYYYYYYYNYYNYYYNYYNYYYYYYNNNYNYYYYYYYYYNNNYYYNYN" };
    int M = 194;
    assertArrayEquals(new int[] { 37, 33, 39, 40, 38, 19, 5, 5, 4, 4, 3, 5, 4, 6, 5, 6, 5, 5, 4, 5, 5, 6, 5, 6, 4, 2, 5, 4, 4, 3, 3, 5, 4, 5, 4, 4, 3, 1, 5, 5, 3, 5, 5, 5, 4, 4, 2, 5 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case58() {
    String[] roads = { "NYNNYYYYYYYYNYYNYYNNNYNNYYYYNYYNYYYYNYNYNNYNNYY", "YNNNYNYNNNNNNYNYNYYNNYNYYNNNNNYYNYYYYYNYNYNYNNY", "NNNYYYYYNNYNYYYYYNYYNNYYYNYNYYNYYYYYNNNYNYNNNNY", "NNYNYYYNNNYNNNYNNYNYNYNYYYNYYYYYNYNYYNYYNYYNYYN", "YYYYNYNYYNYYNNNYNYNNYNNNYYNYNYNYNYNNNYNYYNYYNYY", "YNYYYNNNYNYNNYYNYNYYYNYNNNYYYYYYNNNYNNNYYYNYNYY", "YYYYNNNYNNYNYNNNYYNNNYYYNNNYYYYYNNYYYNYNNYYYYYN", "YNYNYNYNYNNNNNNNYYYYYYYNNYYNNNYYYYYNYYNYNYNNYYY", "YNNNYYNYNNYNNYNYNYNNNNYYYYNYYYYYNYNYNYYNYYYNYYY", "YNNNNNNNNNYNNNYYNYNYNNNYYYNNYYYNNYYYYYYNNNYNYNN", "YNYYYYYNYYNYYYNNYYNYNYNYYYYNYNYNNYYNYYYYYYNNNNN", "YNNNYNNNNNYNYNNNYNYYNNNYYNYNYNNNYNNNNYNNNNYNNYN", "NNYNNNYNNNYYNNYNNYYYNYYNYNYYNYNYNYNYYYNYYYNYYNN", "YYYNNYNNYNYNNNYNYYYYNNNNYYYNNYYNYNYYYYYYYNYNYYN", "YNYYNYNNNYNNYYNNYYYNNNYNNNNNYYNNNYNYYYNNNYYNYNN", "NYYNYNNNYYNNNNNNYYYYYYYYYYNNYNNYNYNYYYYNYYYNNYN", "YNYNNYYYNNYYNYYYNYNYNYYYNNNYYYYYNYNYYYNNNNYYYYN", "YYNYYNYYYYYNYYYYYNYYNYYYNNYNNYNNYYYYYYNYYYNYYNY", "NYYNNYNYNNNYYYYYNYNNYNNYNYYNNNNNNYNYNNYYNYYNYNY", "NNYYNYNYNYYYYYNYYYNNNNYYNNYYYYYYYNYYNYNYNYYNYNN", "NNNNYYNYNNNNNNNYNNYNNNYYNYNYNNNNNNNYYYYNYYYYYYY", "YYNYNNYYNNYNYNNYYYNNNNNYYNYYNNYNNNYNYYNYNNNNYYN", "NNYNNYYYYNNNYNYYYYNYYNNYNYYNYNYYYYNNNNYYNNYNYNN", "NYYYNNYNYYYYNNNYYYYYYYYNYNYYYNYYYNYNYYNYNYYYNNY", "YYYYYNNNYYYYYYNYNNNNNYNYNNYNNNYNNYNNYYYYYNNYNNN", "YNNYYNNYYYYNNYNYNNYNYNYNNNYNYNYNYNYNYNNNYNNYYYY", "YNYNNYNYNNYYYYNNNYYYNYYYYYNYYYYNNYNNNYNYYNYNNNY", "YNNYYYYNYNNNYNNNYNNYYYNYNNYNNNNYNYNYYYNYNNNNYNY", "NNYYNYYNYYYYNNYYYNNYNNYYNYYNNYNNNNNNYNNYNNNNNYN", "YNYYYYYNYYNNYYYNYYNYNNNNNNYNYNNYNNYNNNNNYYYYNYY", "YYNYNYYYYYYNNYNNYNNYNYYYYYYNNNNNNYNYYYYYYNYYYYY", "NYYYYYYYYNNNYNNYYNNYNNYYNNNYNYNNYYYYYNYYNNNYNYY", "YNYNNNNYNNNYNYNNNYNYNNYYNYNNNNNYNYYNNNYNYNYNNNY", "YYYYYNNYYYYNYNYYYYYNNNYNYNYYNNYYYNYNYNYNYNNYNNY", "YYYNNNYYNYYNNYNNNYNYNYNYNYNNNYNYYYNYNNYNYNNNNNY", "YYYYNYYNYYNNYYYYYYYYYNNNNNNYNNYYNNYNNNYYYNNNYYN", "NYNYNNYYNYYNYYYYYYNNYYNYYYNYYNYYNYNNNYNNNYNYYYN", "YYNNYNNYYYYYYYYYYYNYYYNYYNYYNNYNNNNNYNNYYNNYNNY", "NNNYNNYNYYYNNYNYNNYNYNYNYNNNNNYYYYYYNNNNNNYNYNN", "YYYYYYNYNNYNYYNNNYYYNYYYYNYYYNYYNNNYNYNNYNYNYNY", "NNNNYYNNYNYNYYNYNYNNYNNNYYYNNYYNYYYYNYNYNYNYYYY", "NYYYNYYYYNYNYNYYNYYYYNNYNNNNNYNNNNNNYNNNYNYYYNY", "YNNYYNYNYYNYNYYYYNYYYNYYNNYNNYYNYNNNNNYYNYNYYNN", "NYNNYYYNNNNNYNNNYYNNYNNYYYNNNYYYNYNNYYNNYYYNNNY", "NNNYNNYYYYNNYYYNYYYYYYYNNYNYNNYNNNNYYNYYYYYNNNY", "YNNYYYYYYNNYNYNYYNNNYYNNNYNNYYYYNNNYYNNNYNNNNNN", "YYYNYYNYYNNNNNNNNYYNYNNYNYYYNYYYYYYNNYNYYYNYYNN" };
    int M = 263;
    assertArrayEquals(new int[] { 29, 21, 27, 26, 25, 26, 26, 26, 27, 20, 29, 15, 4, 6, 5, 5, 7, 9, 5, 7, 3, 6, 5, 8, 9, 7, 6, 6, 8, 8, 9, 8, 4, 9, 7, 8, 6, 8, 5, 8, 4, 8, 7, 4, 5, 8, 7 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case59() {
    String[] roads = { "NNYNYYYYYYYYNYYNYNNYNYYNNNNYNYYYNYYNYNYYNYNNYYYNY", "NNYYYYNNNYYYNYYYYYNYYYYYYNNYNNNYYYYYYYYNYNYYYYYYY", "YYNYNYNYYYNYNNYYYYYYNNNYNNNNYNNYYYNYNNNYNNYNYNYYN", "NYYNNYNYYNNNYYNYNYNYNYYYNNYYNYYYNYNNYYYYNYYNNNYYY", "YYNNNYNYYYNYYNNNNYNNYYYNNNNNYYNYNNYYYYNNNYYYNYNYN", "YYYYYNYNYYYNYYNNYNYYNYYNNNYYYYYNNYYYNYYYYYNYYYNYN", "YNNNNYNYNYYYYNNYYYNNNYYNYNYNNNYNYYYYYYYYYYNNNYNYY", "YNYYYNYNYNYYYNNYYYYYYYNYNYYNNYNNNNYNNNYYYYYNNYYYY", "YNYYYYNYNYYYNNYNYYNYNYYYYYYNYNYYYYYYYYYYNNYYYYYYN", "YYYNYYYNYNYYYNYNYYYYYNNYYYNNYYYYNYNYYYNNYNYYYYYYY", "YYNNNYYYYYNYNNYYNYYYYYYYYYYNNNNYNNYYNNNNNYYNYNYNY", "YYYNYNYYYYYNYNNYYNYYNYYYNYYNYNNYNNYYNYYYYNYNYNNYN", "NNNYYYYYNYNYNYYYNNYYYNYNYNNNYNYYYYNNNYYNYNYNYYNYY", "YYNYNYNNNNNNYNNYNNNYYNNYNYNNNNNYYNNYYNYYYNYNYYNYY", "YYYNNNNNYYYNYNNNYYYYYYYYYYNYNYNYYYNNYYYNYYYYNNNNY", "NYYYNNYYNNYYYYNNYYYYNNYNNYYYNYYYYNNNNNNYNYNNYYYYN", "YYYNNYYYYYNYNNYYNNYNYYNYNYNYYYYYYYYNNYYYYNNNYNYYN", "NYYYYNYYYYYNNNYYNNYNYYYYYNNNNNYNYNYYYNYNNYNNNNNYN", "NNYNNYNYNYYYYNYYYYNNNYYYNYYNYYYYYNYYNYNYYNNYYNYNY", "YYYYNYNYYYYYYYYYNNNNYYNNYYNNYYYNYYYNYYYNYNNNYNYYN", "NYNNYNNYNYYNYYYNYYNYNNYYYYNYYYYYYYYYNYNNYYYNYNYNY", "YYNYYYYYYNYYNNYNYYYYNNYNYYYYNNNNYYYYYNNNYNYNNYYNY", "YYNYYYYNYNYYYNYYNYYNYYNYNYYNYYNNNYYNNYNNYNNNYYYNN", "NYYYNNNYYYYYNYYNYYYNYNYNNNYNNYYNYYYYYYNNNNYNYNYNN", "NYNNNNYNYYYNYNYNNYNYYYNNNYNNNYNNNYYYNNYYYYYNYYYNY", "NNNNNNNYYYYYNYYYYNYYYYYNYNYNYNNNYNNNNNYNNNYNYYYYY", "NNNYNYYYYNYYNNNYNNYNNYYYNYNYYYNYYYNYNNYYNYYNYNYNY", "YYNYNYNNNNNNNNYYYNNNYYNNNNYNNNNYYYYNNYNYYNNYNYNYY", "NNYNYYNNYYNYYNNNYNYYYNYNNYYNNNYYYYYYNYYYNNYYYNNYN", "YNNYYYNYNYNNNNYYYNYYYNYYYNYNNNYYNYNNYYYYNYNNNNYNY", "YNNYNYYNYYNNYNNYYYYYYNNYNNNNYYNYYNYNYNNYYNYYNNYYY", "YYYYYNNNYYYYYYYYYNYNYNNNNNYYYYYNYNNYYYYNNNYYNYNNY", "NYYNNNYNYNNNYYYYYYYYYYNYNYYYYNYYNYYNNNNYYYYNYNNNN", "YYYYNYYNYYNNYNYNYNNYYYYYYNYYYYNNYNYNNNYYNYYNYNYYN", "YYNNYYYYYNYYNNNNYYYYYYYYYNNYYNYNYYNNYYNYNYYYYNNYY", "NYYNYYYNYYYYNYNNNYYNYYNYYNYNYNNYNNNNYYYYYNNNNYNYN", "YYNYYNYNYYNNNYYNNYNYNYNYNNNNNYYYNNYYNNNYYYYNYNYYY", "NYNYYYYNYYNYYNYNYNYYYNYYNNNYYYNYNNYYNNYYYYNNNNYNN", "YYNYNYYYYNNYYYYNYYNYNNNNYYYNYYNYNYNYNYNYYYNNYNNYN", "YNYYNYYYYNNYNYNYYNYNNNNNYNYYYYYNYYYYYYYNNYYYYYYYY", "NYNNNYYYNYNYYYYNYNYYYYYNYNNYNNYNYNNYYYYNNNYNYYYYN", "YNNYYYYYNNYNNNYYNYNNYNNNYNYNNYNNYYYNYYYYNNNNYYYYY", "NYYYYNNYYYYYYYYNNNNNYYNYYYYNYNYYYYYNYNNYYNNYYNYNN", "NYNNYYNNYYNNNNYNNNYNNNNNNNNYYNYYNNYNNNNYNNYNYYNYN", "YYYNNYNNYYYYYYNYYNYYYNYYYYYNYNNNYYYNYNYYYYYYNNYYY", "YYNNYYYYYYNNYYNYNNNNNYYNYYNYNNNYNNNYNNNYYYNYNNYNY", "YYYYNNNYYYYNNNNYYNYYYYYYYYYNNYYNNYNNYYNYYYYNYYNNN", "NYYYYYYYYYNYYYNYYYNYNNNNNYNYYNYNNYYYYNYYYYNYYNNNY", "YYNYNNYYNYYNYYYNNNYNYYNNYYYYNYYYNNYNYNNYNYNNYYNYN" };
    int M = 48;
    assertArrayEquals(new int[] { 29, 14, 4, 3, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case60() {
    String[] roads = { "NYYYYYYYYYYNYYYYYYYNNYYNYYYYYYYYNYYYYYYYYYNYYY", "YNYNYYYYYYYYYYYYYYYYYNYNYYYYYYYNYYYYNYYYYYYNYY", "YYNYYYYYYNYNYYYYYYYYYYYYNYYYYYYYNYYYYYNYNYYYYY", "YNYNYYYYYYYYNYYYYYYYYYYYYNYYYYNYNNNNNYYYYYYNYY", "YYYYNYYYYYNYNYYYYYYYYYYNYNYYYNYNNYNYYYYNYYYYYY", "YYYYYNYYNYYYYYYYYYYNYYYYYYYNNYYYYNYYYYYNYYYYYY", "YYYYYYNYYYNYNYNYYYYYNYNYYYNYYYYNYYYYYYNYNYYYNN", "YYYYYYYNYYYYYNYYYNYYYYNYYYNNYYYYYYYYYNYYYYYYYY", "YYYYYNYYNYYYYYYNYYYYYNYYYNNYYYNYNNYYYYYYYYYYYY", "YYNYYYYYYNNYNYYYYNYYYYYYNNYNYYYNYNYYYYYYYYYNYY", "YYYYNYNYYNNYYYYYYYYYYYYYNYYYNYYYYYNNYNYYYNYYYY", "NYNYYYYYYYYNYYYYYYYYYYYYYYYYYYYYNYYYYYYYYNYYYY", "YYYNNYNYYNYYNYYYYYYYYYNYNYNYYYNYYYYYYYNYYYYYYY", "YYYYYYYNYYYYYNYYYYYNYYYYYYYYYYYYYNYYYYYYYYNYNY", "YYYYYYNYYYYYYYNYYYYYYYYYYYNYYYYNYYYYNYNYYYYYNY", "YYYYYYYYNYYYYYYNNYYNYYYYYYNYYYNNYNYYNNYYYYYYYY", "YYYYYYYYYYYYYYYNNYYNNYYNNNYYYYYNYYYYYNYNYYYYYY", "YYYYYYYNYNYYYYYYYNYYYYYYYYYYYYYYYYYYNYYNYNNYYY", "YYYYYYYYYYYYYYYYYYNYYNYYYYYYNYYYYYYNNYYYYYYYYY", "NYYYYNYYYYYYYNYNNYYNYNYYYYYYYYYYYYYYYNNYYYYYYY", "NYYYYYNYYYYYYYYYNYYYNYYYNYYYNYYYYNYYNYYYYYYYYY", "YNYYYYYYNYYYYYYYYYNNYNYYNNYYNYNYYYNYYYYYYNYYNY", "YYYYYYNNYYYYNYYYYYYYYYNYYYYYNYYYNNYYYYYYYYYYYY", "NNYYNYYYYYYYYYYYNYYYYYYNNYNYYYYNYYYYYYNYNNYYNY", "YYNYYYYYYNNYNYYYNYYYNNYNNNYYYYYYYYYNYYYYYYNYNY", "YYYNNYYYNNYYYYYYNYYYYNYYNNYNNYYNYYYYYYNNYYYYYN", "YYYYYYNNNYYYNYNNYYYYYYYNYYNYNNYYNYYYNYNNYYYNYN", "YYYYYNYNYNYYYYYYYYYYYYYYYNYNYYYYYNYYYYYYYYYYYY", "YYYYYNYYYYNYYYYYYYNYNNNYYNNYNYYNYNYYYYYNYYYNYY", "YYYYNYYYYYYYYYYYYYYYYYYYYYNYYNNYYYYYNYYYYYYYYY", "YYYNYYYYNYYYNYYNYYYYYNYYYYYYYNNYYYYYNYYYNYYNYY", "YNYYNYNYYNYYYYNNNYYYYYYNYNYYNYYNYYYNYYNYNYYYNY", "NYNNNYYYNYYNYYYYYYYYYYNYYYNYYYYYNYYNYYYYYYYYYN", "YYYNYNYYNNYYYNYNYYYYNYNYYYYNNYYYYNNYYNYNYYNNYY", "YYYNNYYYYYNYYYYYYYYYYNYYYYYYYYYYYNNYYYYYYYYYYN", "YYYNYYYYYYNYYYYYYYNYYYYYNYYYYYYNNYYNYYYYYYNYYY", "YNYNYYYYYYYYYYNNYNNYNYYYYYNYYNNYYYYYNYYYNYYNNY", "YYYYYYYNYYNYYYYNNYYNYYYYYYYYYYYYYNYYYNYYYYYNYY", "YYNYYYNYYYYYNYNYYYYNYYYNYNNYYYYNYYYYYYNYYYYYYY", "YYYYNNYYYYYYYYYYNNYYYYYYYNNYNYYYYNYYYYYNYNYNYY", "YYNYYYNYYYYYYYYYYYYYYYYNYYYYYYNNYYYYNYYYNYNYYN", "YYYYYYYYYYNNYYYYYNYYYNYNYYYYYYYYYYYYYYYNYNYYYY", "NYYYYYYYYYYYYNYYYNYYYYYYNYYYYYYYYNYNYYYYNYNYYY", "YNYNYYYYYNYYYYYYYYYYYYYYYYNYNYNYYNYYNNYNYYYNYY", "YYYYYYNYYYYYYNNYYYYYYNYNNYYYYYYNYYYYNYYYYYYYNY", "YYYYYYNYYYYYYYYYYYYYYYYYYNNYYYYYNYNYYYYYNYYYYN" };
    int M = 310;
    assertArrayEquals(new int[] { 39, 39, 39, 35, 36, 39, 34, 39, 37, 15, 7, 8, 6, 9, 9, 9, 10, 8, 10, 8, 7, 7, 7, 6, 8, 6, 6, 7, 8, 8, 7, 6, 4, 6, 7, 8, 7, 8, 7, 7, 7, 9, 8, 7, 8, 8 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case61() {
    String[] roads = { "NYNNNNNNNNNYNNNNYYNYYNYNNNYNNNNYNNYNYYNYNYNNNN", "YNYYNNNNNNNYNNYNNNYNNNNYNNNNNNYYNNNNNNNNYNNNNY", "NYNNNYYNNNNNNNNNYNYNYNNNNYNNNNNNNNNNNNYNNYNNNN", "NYNNNYNNNNNNNNYNNNNNNYNNNNYYNNNNNNYNNNNNNNYNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNYNNNYNYYYNNYNYNYNNNY", "NNYYNNNYNYNNNNNNNNNYNYNYYNNYNYYNNNNNNNNNNNNNNN", "NNYNNNNYNNNYYNNNYNNNYNNNNYNYNNYYYNNYNNNNNNNNNY", "NNNNNYYNNNNNNNYNYNNNNNNNNNNNYNYYNYNNNNNNYNNNNN", "NNNNNNNNNYNNNNNNNNNYNNNYYNNYNNNYNNNNNNYNNNNNNN", "NNNNNYNNYNNNNNNNYYNYYNNYYNYYNNNNNNNNNNNYYNNNNN", "NNNNNNNNNNNYNNNNNNNNNYYYYNNNNNNNYNNNNYNNNNNNNN", "YYNNNNYNNNYNNNNNNNNNNNNNYYNYNYNNNYNNNNYNNNNNYN", "NNNNNNYNNNNNNNNNNNNNNNNYNNNNYNYNNNNNNNNNNNYYNN", "NNNNNNNNNNNNNNNYNNNNNYNNNYNNNNNNNNNNNNNNNNNNNY", "NYNYNNNYNNNNNNNNNYNNYNNYNNNYNNNNNNNNNNNYNYNNNY", "NNNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNYNNNNNNYNNNY", "YNYNNNYYNYNNNNNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNNN", "YNNNYNNNNYNNNNYNNNNNYNNNNNNNNNYNYNYNNYNNNNNYNN", "NYYNNNNNNNNNNNNNNNNYNNNNNYNYYNYNNYNNNNNNNNNNNN", "YNNNNYNNYYNNNNNYNNYNNNYYNNYNYNNNNYNNNNNNNNNYNN", "YNYNNNYNNYNNNNYNNYNNNNNNNYNNNNNNNNNYNYNYYNNNNN", "NNNYNYNNNNYNNYNNNNNNNNYNNNNYNNNNNNNYNNYNYYNNNN", "YNNNNNNNNNYNNNNNNNNYNYNNNNNNYNNNNNNNYNNNNNNYNN", "NYNNNYNNYYYNYNYNYNNYNNNNYNNYNNNNNNNNNYNNNNNNNN", "NNNNNYNNYYYYNNNNNNNNNNNYNNNNYNYNNNYNNNNNNYNNNN", "NNYNNNYNNNNYNYNNNNYNYNNNNNNNYNNNNNNNNNYNNYNNNN", "YNNYYNNNNYNNNNNNNNNYNNNNNNNYNNYNYNNYNNNNNNNYNN", "NNNYNYYNYYNYNNYNYNYNNYNYNNYNNNNNYNNNNYNYNNNNYN", "NNNNNNNYNNNNYNNNNNYYNNYNYYNNNNNNNYNNYNNNNNNNNN", "NNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNYYNNNNYYYYNNNNN", "NYNNYYYYNNNNYNNNNYYNNNNNYNYNNNNNNNNNNNNNYNNYNN", "YYNNNNYYYNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNYNNNNNN", "NNNNYNYNNNYNNNNNNYNNNNNNNNYYNYNNNNNNYNNNYNYNNN", "NNNNYNNYNNNYNNNNNNYYNNNNNNNNYNNNNNNNYNNNNYYNNN", "YNNYYNNNNNNNNNNYNYNNNNNNYNNNNNNNNNNNYNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNYYNNNNYNNNNYNNNNNYNNYYNNNN", "YNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNYYYNNYNYNYYNNN", "YNNNYNNNNNYNNNNNNYNNYNNYNNNYNYNNNNNYYNNNYNNNNN", "NNYNNNNNYNNYNNNNNNNNNYNNNYNNNYNNNNNNNNNNNNNNNN", "YNNNYNNNNYNNNNYNNNNNYNNNNNNYNYNYNNNNYNNNNNYYNN", "NYNNNNNYNYNNNNNNNNNNYYNNNNNNNYYNYNNYNYNNNNYNNY", "YNYNYNNNNNNNNNYYNNNNNYNNYYNNNNNNNYNYYNNNNNYYNN", "NNNYNNNNNNNNYNNNNNNNNNNNNNNNNNNNYYNNYNNYYYNYNY", "NNNNNNNNNNNNYNNNNYNYNNYNNNYNNNYNNNNNNNNYNYYNNN", "NNNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NYNNYNYNNNNNNYYYNNNNNNNNNNNNNNNNNNNNNNNNYNYNNN" };
    int M = 45;
    assertArrayEquals(new int[] { 14, 9, 5, 4, 3, 5, 3, 2, 1, 2, 1, 3, 2, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case62() {
    String[] roads = { "NYYYYYYYYYNYYYYYYYYYYNYYYYNYYYYYYYYYYYYYYYYNYYY", "YNYNYNYYYYYNYYYNYNYNYYYYNYYYYYYYYYNNYYYYNYNYYYY", "YYNYYYYYYYYYYYYYYYNYNNYNYYYNYNYYYNNYYYYYYYYYYYY", "YNYNYYYYNYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYN", "YYYYNYYYYYYYYYYYYYYYYYYYYYYYYYYNYYYYYNYYYYYYYYY", "YNYYYNYYYYYYYYYYYNYYYYYYYNYYYNYYYYNYYNYNYYNYNYY", "YYYYYYNYYNNYYYYYYYYYYYNNYNNYYYNYYYYYYYYYNYYYNYY", "YYYYYYYNYYYYYYYYYYYYNYNYYYYNYYYYYYYYYNYYYYYYYYY", "YYYNYYYYNNYNYYYNYNYYYYNYYYYYYYYYYYYNYYYNNYYYNYY", "YYYYYYNYNNYYYNYYYYYNYYNYYYYYYYYYYYYYNYYNYYYYYNY", "NYYYYYNYYYNYNYNYYNYNYNYYYYYYYYYYYYNYYNNYYYNYYYY", "YNYYYYYYNYYNYYYYYYYYNYYNYYYYYYYYYYNYYYNYYYYYYYY", "YYYYYYYYYYNYNYNNYYYYYNYYYYYYYYYYYYNYYYNYNYYNNYY", "YYYYYYYYYNYYYNYYNYYNYYYYYNYYNYNYYNYYNYYYYYNYYNY", "YYYYYYYYYYNYNYNYYYYYNYYYYYYYYYYYYYYYYYYYYNYYYNY", "YNYYYYYYNYYYNYYNNYYNYYYYYYYYYYYNNYYNYYYYYYYYYNY", "YYYYYYYYYYYYYNYNNYYYYNYYNYNYYYYNYYNYYYNNYYYYYYY", "YNYYYNYYNYNYYYYYYNYYYYYYYYNYYYYYYYYNYNYYYYYYYNY", "YYNYYYYYYYYYYYYYYYNYYYYYYYYYYYYNYYYNYNYYYYYNYYY", "YNYYYYYYYNNYYNYNYYYNNYNYYYYYYYNYNYYNYYYYYYNYYYY", "YYNYYYYNYYYNYYNYYYYNNNYYYYYYYNYNYYYYYYYYYYNYYNY", "NYNYYYYYYYNYNYYYNYYYNNNYYNYYYYNYYNYNYYYYYYYYYYY", "YYYYYYNNNNYYYYYYYYYNYNNYNYYYNYYYYYYYYYYYYYYYYYY", "YYNYYYNYYYYNYYYYYYYYYYYNNYYNYNYYNYYYYNYYYYYYYYN", "YNYYYYYYYYYYYYYYNYYYYYNNNYYYYNYYYYYNYYYYYYYYYYY", "YYYYYNNYYYYYYNYYYYYYYNYYYNYYNNYYYYYYYYYNYYYYYYY", "NYYYYYNYYYYYYYYYNNYYYYYYYYNYYYYYYYNYYYYYYYYYNYY", "YYNYYYYNYYYYYYYYYYYYYYYNYYYNYNYNYYYYNYYYYYYYYYY", "YYYYYYYYYYYYYNYYYYYYYYNYYNYYNNYYYYYYYYYYYYYYYNN", "YYNYYNYYYYYYYYYYYYYYNYYNNNYNNNYNYYYNNNYYYYYYNYY", "YYYYYYNYYYYYYNYYYYYNYNYYYYYYYYNYYYYYYYYYYYYYYYY", "YYYYNYYYYYYYYYYNNYNYNYYYYYYNYNYNNYYYYYYYYYYYYYN", "YYYYYYYYYYYYYYYNYYYNYYYNYYYYYYYNNYYYYYYYYYYYYYY", "YYNYYYYYYYYYYNYYYYYYYNYYYYYYYYYYYNYYYYYYYYYYNYY", "YNNYYNYYYYNNNYYYNYYYYYYYYYNYYYYYYYNNYNYYYYYYYNY", "YNYYYYYYNYYYYYYNYNNNYNYYNYYYYNYYYYNNYYYNYYYYNYY", "YYYYYYYYYNYYYNYYYYYYYYYYYYYNYNYYYYYYNYYYYYYYYYN", "YYYYNNYNYYNYYYYYYNNYYYYNYYYYYNYYYYNYYNYYYYYYYYY", "YYYYYYYYYYNNNYYYNYYYYYYYYYYYYYYYYYYYYYNYYYYYNYY", "YYYYYNYYNNYYYYYYNYYYYYYYYNYYYYYYYYYNYYYNYYYYYYY", "YNYYYYNYNYYYNYYYYYYYYYYYYYYYYYYYYYYYYYYYNYYNYYY", "YYYYYYYYYYYYYYNYYYYYYYYYYYYYYYYYYYYYYYYYYNYYYYN", "YNYYYNYYYYNYYNYYYYYNNYYYYYYYYYYYYYYYYYYYYYNYYYY", "NYYYYYYYYYYYNYYYYYNYYYYYYYYYYYYYYYYYYYYYNYYNYYY", "YYYYYNNYNYYYNYYYYYYYYYYYYYNYYNYYYNYNYYNYYYYYNYY", "YYYYYYYYYNYYYNNNYNYYNYYYYYYYNYYYYYNYYYYYYYYYYNN", "YYYNYYYYYYYYYYYYYYYYYYYNYYYYNYYNYYYYNYYYYNYYYNN" };
    int M = 291;
    assertArrayEquals(new int[] { 42, 35, 38, 43, 44, 37, 37, 41, 7, 7, 6, 7, 8, 8, 8, 7, 8, 6, 7, 7, 6, 6, 6, 6, 7, 6, 6, 6, 8, 6, 7, 7, 8, 7, 5, 7, 8, 5, 8, 7, 6, 8, 6, 7, 6, 8, 6 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case63() {
    String[] roads = { "NNNYNYYNNYYNYNYYYYYNYYYYNYYYYYYYYYYYYYYYNYNNYN", "NNNNYYYNYNYYYYNYYYYYYYNYNYNYYYYNYYYNYYYYYNYYYY", "NNNYNYNYYNYYYNYYYYYYYNYNYYNYYNYYYNNYNYYYYYYYYY", "YNYNYNYYNYYYYYYNYYNYYYYNYYYYYYYYYNYYYYYYYYYYYY", "NYNYNNYYYYYYNYYNNYYYNYYYYNYNYNYYYYYNYYYYNYNYYY", "YYYNNNYYYYNNYNYYYYYYYYNYYYYNYYYYYYYYYYNYYNYYYY", "YYNYYYNYYYYYNYNNNYNYYYYYYYYYYYYNNNYYNYYYYYYYYY", "NNYYYYYNNYYYYYYYYNYYNYNYYYYYNYNYYYNYYYYNYYYYYY", "NYYNYYYNNYYYNNYYNYYYYNYNYYYYYYYYYYYNYYYYYYYYYY", "YNNYYYYYYNYYNYNYYYYYYNYYYYNYYNNNYYYYYYNYNYYYYY", "YYYYYNYYYYNYYNYYNYYNYYYYYNYYYYYYYYYYYYYYYYYYYY", "NYYYYNYYYYYNYYYNNYYYYYNYYYYYYYNYNNYYYYYYYNYYYY", "YYYYNYNYNNYYNYYYYNYYYYNYYYYNNYYYNYNYYYYYYYNYYY", "NYNYYNYYNYNYYNYNYNYYYNYNYNYNYYYYYYNNYNYNNYYYYY", "YNYYYYNYYNYYYYNNYNYYYYNYYNYYNYYYYYYYYYYYYYYYYY", "YYYNNYNYYYYNYNNNNYYYYNYYYNYYNYYNYNNNYYYNYYYNYY", "YYYYNYNYNYNNYYYNNYYYYYYYYYYYYYYYYYYYYNYYYNYYYY", "YYYYYYYNYYYYNNNYYNYYYYYYNYYNNYYYYNYYYYYYNYYYYY", "YYYNYYNYYYYYYYYYYYNYNNYYNNYNYYYNYYYNYYYYYYYYYN", "NYYYYYYYYYNYYYYYYYYNNYNYNYYYYYYYNYNNYYYYYYYYYY", "YYYYNYYNYYYYYYYYYYNNNNYNNYYYNYYYYYYYYYNYYYYYYY", "YYNYYYYYNNYYYNYNYYNYNNYYYYYYYYYYYYYYYYYNYNNYYY", "YNYYYNYNYYYNNYNYYYYNYYNYNYYNYYYYYNNYNNNNYYYYYY", "YYNNYYYYNYYYYNYYYYYYNYYNYYNYYYYYYNYNYNYYYYYNYN", "NNYYYYYYYYYYYYYYYNNNNYNYNYYYNYYYYNYYNYYYYYYNYN", "YYYYNYYYYYNYYNNNYYNYYYYYYNYYYYYYYYYNYNNYNYYYYY", "YNNYYYYYYNYYYYYYYYYYYYYNYYNNYYYNYNNYYYYYYYNYYY", "YYYYNNYYYYYYNNYYYNNYYYNYYYNNNYYYYYYYNYYNYYNYYY", "YYYYYYYNYYYYNYNNYNYYNYYYNYYNNNNYYNNYNYNYYYNYNY", "YYNYNYYYYNYYYYYYYYYYYYYYYYYYNNYNNYYYYYYYYYYYYY", "YYYYYYYNYNYNYYYYYYYYYYYYYYYYNYNYYYYNYYYYNYNYYY", "YNYYYYNYYNYYYYYNYYNYYYYYYYNYYNYNYNYYYYYYYYYYYY", "YYYYYYNYYYYNNYYYYYYNYYYYYYYYYNYYNNYYYNYYYYYYYY", "YYNNYYNYYYYNYYYNYNYYYYNNNYNYNYYNNNYYYYYYNYYYYY", "YYNYYYYNYYYYNNYNYYYNYYNYYYNYNYYYYYNNYNYYNYYYYY", "YNYYNYYYNYYYYNYNYYNNYYYNYNYYYYNYYYNNYNYNYNYYNN", "YYNYYYNYYYYYYYYYYYYYYYNYNYYNNYYYYYYYNNYYYYYYYY", "YYYYYYYYYYYYYNYYNYYYYYNNYNYYYYYYNYNNNNYNNYYYNY", "YYYYYNYYYNYYYYYYYYYYNYNYYNYYNYYYYYYYYYNNYNYYNY", "YYYYYYYNYYYYYNYNYYYYYNNYYYYNYYYYYYYNYNNNYYYYYN", "NYYYNYYYYNYYYNYYYNYYYYYYYNYYYYNYYNNYYNYYNYYNYY", "YNYYYNYYYYYNYYYYNYYYYNYYYYYYYYYYYYYNYYNYYNYYYY", "NYYYNYYYYYYYNYYYYYYYYNYYYYNNNYNYYYYYYYYYYYNYNY", "NYYYYYYYYYYYYYYNYYYYYYYNNYYYYYYYYYYYYYYYNYYNYY", "YYYYYYYYYYYYYYYYYYYYYYYYYYYYNYYYYYYNYNNYYYNYNN", "NYYYYYYYYYYYYYYYYYNYYYYNNYYYYYYYYYYNYYYNYYYYNN" };
    int M = 491;
    assertArrayEquals(new int[] { 32, 33, 32, 38, 32, 36, 35, 35, 36, 34, 40, 36, 34, 29, 37, 29, 36, 13, 15, 15, 15, 12, 11, 13, 15, 12, 14, 13, 13, 14, 14, 13, 14, 12, 12, 12, 15, 15, 15, 14, 13, 13, 14, 15, 17, 15 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case64() {
    String[] roads = { "NYNYYYYYYYYYNYNYYYYYYNYYNNYYYNYYYYNYYYYYYYYYYYNYY", "YNYYNYYYYNYYNYYYYYNYYYYNYNYYYNYYYYYYNYYNYYYYYYYYY", "NYNNYNNYYYYYNYYYYYNYYYYYYYNYYNYNYYYYYYYNYYYNYYYYY", "YYNNYYYYYNYYNYYYNYYYYYNYYYYYYYYYYNYYYYNYYYYYNYYYY", "YNYYNYYYNYNYYNYYNYYYYYYYYYNYYYYYYYYNYYYYYYNYYYYYY", "YYNYYNNYYYNYYYYNYYNYNYYYYNYYYYYNYYNYYNYYYYYNYYYNN", "YYNYYNNYYYYYYYYYYYNYYYYYYYNYNYYYNNYNNYYNYYYYYYYYY", "YYYYYYYNYYNYYNYYNYYYYYYNYYNYYYYNYYYYYNYYYYYNYNYNN", "YYYYNYYYNYNYYYYYNYYYYYYYYYYYYYYYYYYYYYNNYNNYYYYYY", "YNYNYYYYYNYYYYYYYNNYYYYYNYNYYYYYYYYYYNYYYYYNYYYYN", "YYYYNNYNNYNYYYYYNYYYYYYYYYYYYYYYNYNYYYYYYYYYYYYYY", "YYYYYYYYYYYNYYYYNNYNYNYYYYYNYYYYYYYNYNNYNYNYYYYYY", "NNNNYYYYYYYYNYYYYYNYNNYYYYYYYYYNYYNYYYYYYYYYYYYYY", "YYYYNYYNYYYYYNYYYYYNYYYNYYYNYYYNYYYYYYYYYYNYNYYNY", "NYYYYYYYYYYYYYNNYNYYYYNYYYYYYNNYNYYNYYNNYYYYYYYYY", "YYYYYNYYYYYYYYNNYYYYNNYYYYYYYYNYYYNNYYYYYYYNYYYYY", "YYYNNYYNNYNNYYYYNYYYYYYYYYNYYYYYYYYYYNYYYYYYYYYYY", "YYYYYYYYYNYNYYNYYNNYYYYYYYYYYYYYNYYYYYYYYYYNYNYYY", "YNNYYNNYYNYYNYYYYNNNYYNYNYYYYYNYYNNYYYYYYYYYYNYYY", "YYYYYYYYYYYNYNYYYYNNYYYYYYYYYYYYNYYYYYYYYYNYYYYYY", "YYYYYNYYYYYYNYYNYYYYNNYYYYYYYYNYYNYYYYNYYYYYYYYYY", "NYYYYYYYYYYNNYYNYYYYNNYYYYNYYYYYYYYYYYYYYYYNNYYYY", "YYYNYYYYYYYYYYNYYYNYYYNYYYYYYYNYNYNYYYYYYYNYYYYYY", "YNYYYYYNYYYYYNYYYYYYYYYNYYYNYYYYYYYYYYYYNNYYYYYNY", "NYYYYYYYYNYYYYYYYYNYYYYYNNYYYYYYYYYYYYYNYYYYYYYYY", "NNYYYNYYYYYYYYYYYYYYYYYYNNNNYYNYYYNYYNYNYYYYYYYYY", "YYNYNYNNYNYYYYYYNYYYYNYYYNNYYYYYYNYYYYYNYNNYYYNYY", "YYYYYYYYYYYNYNYYYYYYYYYNYNYNYYYNNYYYYYNYYYYYYYYNY", "YYYYYYNYYYYYYYYYYYYYYYYYYYYYNYYYYYYYYYYNNYYYYYYYY", "NNNYYYYYYYYYYYNYYYYYYYYYYYYYYNNYYYYNNYNYNYYYYNYNY", "YYYYYYYYYYYYYYNNYYNYNYNYYNYYYNNYYYYYNNYYYYYYYYNYY", "YYNYYNYNYYYYNNYYYYYYYYYYYYYNYYYNNYYYYNYYYYYNYYYYN", "YYYYYYNYYYNYYYNYYNYNYYNYYYYNYYYNNYYYYYYYYNYYYYNYN", "YYYNYYNYYYYYYYYYYYNYNYYYYYNYYYYYYNYYYYNNNYYNNYNYY", "NYYYYNYYYYNYNYYNYYNYYYNYYNYYYYYYYYNYYYYNYYYYYYYYY", "YYYYNYNYYYYNYYNNYYYYYYYYYYYYYNYYYYYNYYYNNYNYYYYYY", "YNYYYYNYYYYYYYYYYYYYYYYYYYYYYNNYYYYYNYYNYYNYNNYYY", "YYYYYNYNYNYNYYYYNYYYYYYYYNYYYYNNYYYYYNYYYYYYYYYNY", "YYYNYYYYNYYNYYNYYYYYNYYYYYYNYNYYYNYYYYNYYYYYYYYYY", "YNNYYYNYNYYYYYNYYYYYYYYYNNNYNYYYYNNNNYYNYYYYYNYYY", "YYYYYYYYYYYNYYYYYYYYYYYNYYYYNNYYYNYNYYYYNYNYYYNYY", "YYYYYYYYNYYYYYYYYYYYYYYNYYNYYYYYNYYYYYYYYNYNYYNYY", "YYYYNYYYNYYNYNYYYYYNYYNYYYNYYYYYYYYNNYYYNYNYYYNYY", "YYNYYNYNYNYYYYYNYNYYYNYYYYYYYYYNYNYYYYYYYNYNYYNYN", "YYYNYYYYYYYYYNYYYYYYYNYYYYYYYYYYYNYYNYYYYYYYNYNYN", "YYYYYYYNYYYYYYYYYNNYYYYYYYYYYNYYYYYYNYYNYYYYYNYYY", "NYYYYYYYYYYYYYYYYYYYYYYYYYNYYYNYNNYYYYYYNNNNNYNYN", "YYYYYNYNYYYYYNYYYYYYYYYNYYYNYNYYYYYYYNYYYYYYYYYNY", "YYYYYNYNYNYYYYYYYYYYYYYYYYYYYYYNNYYYYYYYYYYNNYNYN" };
    int M = 48;
    assertArrayEquals(new int[] { 39, 7, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case65() {
    String[] roads = { "NNNNNNNNNNNNNNNNNNNYNNNNNNNNNNYNNNNYNNNNNNNNNN", "NNNNYYNNNNNNNNNNNNYNNNNNNNNNNNYNNNNYNNNNYNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNYNN", "NNNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NYYNNNYNNNNNNNNNNNNNNNNNYNNNNNNNYNNNNNNNNNNNNN", "NYNNNNNNNNNYNNNNYNNNNNNNNNNYNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYYYNNNNNN", "NNNNNNNNNNNNNNNNYYNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNYNYNNNNNNNNYNNNNNNNNNNNNNYNYNNNN", "NNNNNNNNNNYNNNNNNNNNNNNNNNYNNNNNNNNNYNNNNNNYNN", "NNNYNNNNNYNNNNNNNYYNNNNNNNNNNNNNNNNNNNYNNNNNNN", "NNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNYNYNYNNNNNNYNNNNNNNNNNNYYNNYNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNYNN", "NNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNYNNNN", "NNNYNNNNNNNNYNNNNNNNYNNNNNNYNNNNNNYNNNYNNNNNNN", "NNNNNYNYYNNNNNNNNYNNNYNNNNNNNNNNNYNNNNNNNNNNNY", "NNNNNNNYNNYNYYNNYNNYNNNNNNNNNNNNNNYNNNNNNNNNNN", "NYNNNNNNNNYNNNNNNNNNYNNNNNNNNYNNNNNYNNYYNNNNYN", "YNNNNNNNNNNNYNNNNYNNNNNNNNNYNNNYNNYNNNNNYNNYYY", "NNNNNNNNNNNNNNNYNNYNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNYNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNY", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNYNNNNNYNNNNNNNNYNNNYNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNYNNYNNNNNNNNNNNYYNNNNNNNNNNNNNNNNNNNN", "NNNNNYNNNNNNNNNYNNNYNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNN", "YYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNN", "NNNNNNNYNNNYNNNNNNNYNNNYNNNNNNNNNNNNNYNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNYNYNNNNN", "NNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNYNYNNNNNNNNNNNNNNNNNYNNNNNNNN", "YYYNNNNNNNNNNNNNNNYNNNNNYNNNYNNNNNNNYNNNNNYNNN", "NNNYNNNNNYNNNNNNNNNNNNNNNNNYNNYNNNNYNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNYNNNNNNNYNNYNNNYNNNNNNY", "NNNNNNYNNNYNYNNYNNYNNNNNNNNNNNNNYNNNNYNNNNNNNN", "NNNNNNYNYNNNYNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNN", "NYNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNYNNNNNNYNNNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNYN", "NNNNNNNNNNNNNNNNNNYYNYNNNNNNNNNNNNNNNNNNNNNYNN", "NNNNNNNNNNNYNNNNYNNYNNYNNNNNNNNNNNNNNYNNNNNNNN" };
    int M = 191;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case66() {
    String[] roads = { "NYYNNNNNNNNNNYNYYYNYNNNNNNNNNYNNYYYNNNNYNNNYYNNYNN", "YNNYNNNNYNYNYYNYNYNYYNYNNNYNYNNYNNNYNNNNNNNYNYNNNN", "YNNNNYNYNYNNNNYYNYNNNYNYYYYNNNNNNYYYNNNNNNYNNNYNYY", "NYNNYNYNNNNYNNNNNNNYNNYNNNYYNYNYYYNNNNNNNYNNYNNNYN", "NNNYNNNNNNNYNNYYNNNNNYNNNYNNNNYYNNYNNYYNYNNNNNNNYN", "NNYNNNNNYNNNYYNNNYNNNYYNNNNNYNYNNYNYYNNNNYYNNYYNNY", "NNNYNNNNNYYNNNYYNYNNNNNNNNNYNYNYNNNNNYNNNNNNNNNNNN", "NNYNNNNNNNNNYYNYYNNNYNNNNNNYNNYYNNYNNNNYNNYNNYNNNN", "NYNNNYNNNNNNYNNNNNNYNNNYNNYNYYYNNNYNYNNNYNNNNNNNNN", "NNYNNNYNNNYNNNNNNNNNNYNNNYNNNNNNNNYNYNYNYYNNNNYNYY", "NYNNNNYNNYNNYNNYYNNNNNNYNNNNNYNYYNNNNNNNNYNNNNNYNY", "NNNYYNNNNNNNNNNNYNNYYNYNNYNNNYNNYNNNYNYNYNNNNYNYNY", "NYNNNYNYYNYNNYYNNNNNNYYYNNYNNNNNNYNNYNNNNNNNNNYNNY", "YYNNNYNYNNNNYNNNNNNYNNNNNNNYNNNYYNNNYYNNNNNYNNNNNY", "NNYNYNYNNNNNYNNYNYYYNNNNYYYNYYYYNYNYNYNNYNYYNNNNNY", "YYYNYNYYNNYNNNYNYNNYNNYYNYNYNNNNNYNNNNNNNNNYNNNNNN", "YNNNNNNYNNYYNNNYNNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNN", "YYYNNYYNNNNNNNYNNNNNNYNNNNNNYNYYYNNYNYYYNNNNNNNYYY", "NNNNNNNNNNNNNNYNNNNNNNNNNNYNNNNNYYYNNNNYNNYNNNYNNN", "YYNYNNNNYNNYNYYYNNNNNNYNNNYNNNYNNNNNNNYNNYNYNNNYNN", "NYNNNNNYNNNYNNNNNNNNNNNNYNNYNNNNNYNYYYNYNNNYNYNNYN", "NNYNYYNNNYNNYNNNNYNNNNNNNNYYNNNNNYNNNNNNNYNYYNNNNN", "NYNYNYNNNNNYYNNYNNNYNNNYYYYNYNYNNYNNNNNNYNNNYNNNYN", "NNYNNNNNYNYNYNNYNNNNNNYNYNNNNNYNNNYNYNNNNNYYNNYNYN", "NNYNNNNNNNNNNNYNNNNNYNYYNNNNNYNYNYYNNNNNNYNYNNNNYN", "NNYNYNNNNYNYNNYYNNNNNNYNNNNNNNNNNNNNYYYNYNNYNYNNNY", "NYYYNNNNYNNNYNYNNNYYNYYNNNNNNNNNYYNNNNNNNNNNNNNNNN", "NNNYNNYYNNNNNYNYNNNNYYNNNNNNNYNNNNYNYNNNYYNNYNNNNY", "NYNNNYNNYNNNNNYNYYNNNNYNNNNNNNYYNNYNYYNNNNYYNNNYNN", "YNNYNNYNYNYYNNYNNNNNNNNNYNNYNNYNYNYNNYNNNNNNNNNNNN", "NNNNYYNYYNNNNNYNNYNYNNYYNNNNYYNNNNNNYNNNNNYNNNYNNN", "NYNYYNYYNNYNNYYNNYNNNNNNYNNNYNNNNNNNNYYNYYNNNNNYNY", "YNNYNNNNNNYYNYNNNYYNNNNNNNYNNYNNNNNNNNNYYYYNNYNNNN", "YNYYNYNNNNNNYNYYNNYNYYYNYNYNNNNNNNYNNNYNNNNNNYYNYN", "YNYNYNNYYYNNNNNNYNYNNNNYYNNYYYNNNYNNNNNNNNNNNNNNNN", "NYYNNYNNNNNNNNYNNYNNYNNNNNNNNNNNNNNNNYNNYNNYYNNNNY", "NNNNNYNNYYNYYYNNNNNNYNNYNYNYYNYNNNNNNNNNNYNYYNNYNN", "NNNNYNYNNNNNNYYNNYNNYNNNNYNNYYNYNNNYNNNNYNNNNNNNNN", "NNNNYNNNNYNYNNNNNYNYNNNNNYNNNNNYNYNNNNNYYNNNYNNNNY", "YNNNNNNYNNNNNNNNNYYNYNNNNNNNNNNNYNNNNNYNNNNYNNYNNN", "NNNNYNNNYYNYNNYNNNNNNNYNNYNYNNNYYNNYNYYNNNYYYNNNYY", "NNNYNYNNNYYNNNNNNNNYNYNNYNNYNNNYYNNNYNNNNNNNNYNNNY", "NNYNNYNYNNNNNNYNNNYNNNNYNNNNYNYNYNNNNNNNYNNNYNNNNY", "YYNNNNNNNNNNNYYYNNNYYYNYYYNNYNNNNNNYYNNYYNNNYNNNNN", "YNNYNNNNNNNNNNNNNNNNNYYNNNNYNNNNNNNYYNYNYNYYNNNNYN", "NYNNNYNYNNNYNNNNNNNNYNNNNYNNNNNNYYNNNNNNNYNNNNNNNY", "NNYNNYNNNYNNYNNNNNYNNNNYNNNNNNYNNYNNNNNYNNNNNNNNYN", "YNNNNNNNNNYYNNNNNYNYNNNNNNNNYNNYNNNNYNNNNNNNNNNNNN", "NNYYYNNNNYNNNNNNNYNNYNYYYNNNNNNNNYNNNNNNYNNNYNYNNY", "NNYNNYNNNYYYYYYNNYNNNNNNNYNYNNNYNNNYNNYNYYYNNYNNYN" };
    int M = 214;
    assertArrayEquals(new int[] { 15, 17, 19, 15, 13, 17, 10, 13, 12, 13, 13, 15, 15, 13, 22, 16, 7, 18, 1, 8, 3, 6, 6, 5, 2, 6, 6, 5, 6, 7, 6, 9, 6, 7, 7, 5, 6, 5, 4, 3, 5, 4, 4, 5, 2, 4, 4, 4, 5, 9 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case67() {
    String[] roads = { "NYYNYYYNYYYYYYYYYYYYYYYYYYYYYNYYNYYYYYYNYYYYYYYY", "YNYYYYYYNYYYYYYNYYYYYYYYNYYYYYYYYYYYYYYYYYYYYYYY", "YYNYYYYYYYYYNYYNYYYYYNNYYNYNYYYYNYYYNYYYYNYYNYNY", "NYYNYYYNYYYNYYYYNNYNYYYYYYYYYYYYYYYYNYYNYYYNNYYY", "YYYYNNNNYYYNYYYYYNNNYNYYNYYYYYYYYNYYYYNYNYNYYYYY", "YYYYNNYYYYYYYNYNYYYYYYYYNYYYYYYYYYNNYYYYNYYYYYNY", "YYYYNYNYYYYYYYNYYYYNYNYNNYYYYNYYNYNYNYYNYYYYYYYY", "NYYNNYYNYYYNYYYYYYNNYYYYNYNYYYNYYYNYYYYYYYYYNNNY", "YNYYYYYYNYYYYYYYYYNYYYYYYYYYYYYYYYYYYYYYYYYNYYYY", "YYYYYYYYYNYNYYYNYYYNYYNYYYNNYYYYYYYYYNYYYYNYNYNY", "YYYYYYYYYYNYYYYYYNYYYYNYYNYYYYYYNYYYNYYYYNYYYYYY", "YYYNNYYNYNYNYNYNYNYYYYYYYYNYNYYNYYYYYYYYNYYYNYNY", "YYNYYYYYYYYYNYYYNYYYYYYYYYYNYNYYNYYYYYYNYYYYYYYY", "YYYYYNYYYYYNYNYYYYNYYNYYNYYYYYYYYYNYYYNYYNYNYNYY", "YYYYYYNYYYYYYYNYYYYNYYYYYYYYYYYYYYNYYYYYYNYYYYYY", "YNNYYNYYYNYNYYYNYYYYNYYNYNYYYYYYYNYYYYYYYYYYNYNN", "YYYNYYYYYYYYNYYYNYNYYYYYNNYYYYYYYYYYYYNNYYNNYNNY", "YYYNNYYYYYNNYYYYYNNYYYYYYNYYYYYYYNYYYNYNYNYYYYYY", "YYYYNYYNNYYYYNYYNNNYYYYYYYYYYNYNYYYYYYYYYYYYYYNY", "YYYNNYNNYNYYYYNYYYYNYYYYYYYYYYYYYYYNYYYYYYYYYYYY", "YYYYYYYYYYYYYYYNYYYYNYYNNNYNYYYYYYYNNYYNYYYYYYYY", "YYNYNYNYYYYYYNYYYYYYYNYNNYYYYYYYYYYYYYYYYYYYYYNY", "YYNYYYYYYNNYYYYYYYYYYYNNYYNYYYYYYNYYYNYNNYNYNNYY", "YYYYYYNYYYYYYYYNYYYYNNNNYYNNYYYYYNYYYNNNYYYYYYYY", "YNYYNNNNYYYYYNYYNYYYNNYYNYYYYYYYYYYNYYNYNYYYYYYY", "YYNYYYYYYYNYYYYNNNYYNYYYYNYYNYYYYYYYNYYYNYYYYYYY", "YYYYYYYNYNYNYYYYYYYYYYNNYYNNYYYYYYYNYYYYYYNYYYYN", "YYNYYYYYYNYYNYYYYYYYNYYNYYNNYYYYYNNNYNNYYNYNYYYY", "YYYYYYYYYYYNYYYYYYYYYYYYYNYYNNNYYYYNNYYYYYYYYYYY", "NYYYYYNYYYYYNYYYYYNYYYYYYYYYNNYNYNYYYYYYYYNYYYYY", "YYYYYYYNYYYYYYYYYYYYYYYYYYYYNYNNNNYYYYYYNYYYYYYY", "YYYYYYYYYYYNYYYYYYNYYYYYYYYYYNNNYYYYYYYNYYNYNYYY", "NYNYYYNYYYNYNYYYYYYYYYYYYYYYYYNYNYYYNYYNYNYYYYNN", "YYYYNYYYYYYYYYYNYNYYYYNNYYYNYNNYYNYNYYNYNYYYYNNY", "YYYYYNNNYYYYYNNYYYYYYYYYYYYNYYYYYYNNYYNNNYNYYYYY", "YYYYYNYYYYYYYYYYYYYNNYYYNYNNNYYYYNNNYNNYYYYYYYYY", "YYNNYYNYYYNYYYYYYYYYNYYYYNYYNYYYNYYYNNNYYYYYYYYN", "YYYYYYYYYNYYYYYYYNYYYYNNYYYNYYYYYYYNNNYYNNYYYNYN", "YYYYNYYYYYYYYNYYNYYYYYYNNYYNYYYYYNNNNYNYYYYNYYYY", "NYYNYYNYYYYYNYYYNNYYNYNNYYYYYYYNNYNYYYYNYYYYYYYY", "YYYYNNYYYYYNYYYYYYYYYYNYNNYYYYNYYNNYYNYYNYYNYYNY", "YYNYYYYYYYNYYNNYYNYYYYYYYYYNYYYYNYYYYNYYYNYNYYYY", "YYYYNYYYYNYYYYYYNYYYYYNYYYNYYNYNYYNYYYYYYYNNYYNY", "YYYNYYYYNYYYYNYYNYYYYYYYYYYNYYYYYYYYYYNYNNNNYYYN", "YYNNYYYNYNYNYYYNYYYYYYNYYYYYYYYNYYYYYYYYYYYYNYNY", "YYYYYYYNYYYYYNYYNYYYYYNYYYYYYYYYYNYYYNYYYYYYYNYY", "YYNYYNYNYNYNYYYNNYNYYNYYYYYYYYYYNNYYYYYYNYNYNYNY", "YYYYYYYYYYYYYYYNYYYYYYYYYYNYYYYYNYYYNNYYYYYNYYYN" };
    int M = 133;
    assertArrayEquals(new int[] { 42, 44, 36, 16, 4, 4, 4, 2, 3, 4, 4, 3, 3, 4, 4, 2, 3, 3, 4, 3, 4, 3, 3, 3, 2, 2, 3, 2, 3, 2, 3, 3, 1, 3, 3, 3, 2, 3, 3, 2, 3, 2, 3, 3, 2, 3, 2, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case68() {
    String[] roads = { "NNYNNYYYNNYNNNNNNNYNYYNNYNNYYYNYYNNYNYNYNYNNYN", "NNYNYNNNNNNNNNYYNNNNNYYYNYYNNYNNYNYNNNYNYNNYYY", "YYNNYNNYNNYNYYNYNNYNNNNYNYYYYNNNNNNNNNNNNNNNNY", "NNNNNYYNNNYYNYNNYYNNNNNNNNYYYNYNYYNNYNNNNNYYNN", "NYYNNNYNYYYYYNNNYNYYNYNNYYNYYYNYYYNYYYNYYNYYYY", "YNNYNNYNNYYYYYNNNNNNYYNYYYYYYYYNNNNYYNNNNNNYYY", "YNNYYYNYYNYNYYNYYYYNYYYYYNYNNYNYNNNNYNYYYNYNNY", "YNYNNNYNYYYNNNNNYNYNNYNNYNNNNYNYYYYYYYNNYYYNNN", "NNNNYNYYNYYNNNNNYNNNNNYNYYYYNNYNYYNYNNYNNYYNNN", "NNNNYYNYYNNNYNNNYYYYYNNNNNNNYYYNYYNNYYYNYYNNYN", "YNYYYYYYYNNNNNYNNNNNNYNYYYNNYYNNYNYYNYNYNNNNYN", "NNNYYYNNNNNNNYNYYYNYNNNYNYNNYNNYNNNYYYYNNYNYYY", "NNYNYYYNNYNNNNNYNYYNNYNNNYNNNNNYYYNNNNNNNNYYNY", "NNYYNYYNNNNYNNNNNYYNYYYYYYNYNYYNNYNYYNNNYYYNNN", "NYNNNNNNNNYNNNNNNYYYYNNYNNNYNNYYYNNNYNNYNNNNYY", "NYYNNNYNNNNYYNNNYNYNYNYNYNNNYYNNNYYYYNNYNNNNYY", "NNNYYNYYYYNYNNNYNYYYYYNNNYNNNNNYNNYYYYNNYNNNYY", "NNNYNNYNNYNYYYYNYNNNNYYYNYNNYYYYYNNNNYNNYYNNNN", "YNYNYNYYNYNNYYYYYNNYNNNYNNYNYYNYNNNNYYNYYYYNNN", "NNNNYNNNNYNYNNYNYNYNYNNYNNYNYNNYNNNYNNYYYNNNNY", "YNNNNYYNNYNNNYYYYNNYNNYYNNYYNNYNNNYYNYNNYNYNYN", "YYNNYYYYNNYNYYNNYYNNNNNYNNNYNYYNYNNYYYNNNYNNNY", "NYNNNNYNYNNNNYNYNYNNYNNYYYNNNYNNYYNNNNNYYNYNYN", "NYYNNYYNNNYYNYYNNYYYYYYNYYNYYYNNYYYNNYYYYNYYYY", "YNNNYYYYYNYNNYNYNNNNNNYYNYNYNYNYNNYNNYYNYNNYNY", "NYYNYYNNYNYYYYNNYYNNNNYYYNNYNNYNYNYYNYNNYNYNNN", "NYYYNYYNYNNNNNNNNNYYYNNNNNNYYYNYYNNNNYYYYNNNYY", "YNYYYYNNYNNNNYYNNNNNYYNYYYYNNYYNNYNNYNYNNNNNYN", "YNYYYYNNNYYYNNNYNYYYNNNYNNYNNNYYNNNYYNYNNYNYNY", "YYNNYYYYNYYNNYNYNYYNNYYYYNYYNNNYYYNNYNNNNNYYYY", "NNNYNYNNYYNNNYYNNYNNYYNNNYNYYNNNYNNYYNYYYNNNYY", "YNNNYNYYNNNYYNYNYYYYNNNNYNYNYYNNYNYNNYYYYYYYYN", "YYNYYNNYYYYNYNYNNYNNNYYYNYYNNYYYNNNNYYYNYYYNNN", "NNNYYNNYYYNNYYNYNNNNNNYYNNNYNYNNNNYYYYNYYNNYYN", "NYNNNNNYNNYNNNNYYNNNYNNYYYNNNNNYNYNNYNYNYNYNYY", "YNNNYYNYYNYYNYNYYNNYYYNNNYNNYNYNNYNNNNNNNYNYYN", "NNNYYYYYNYNYNYYYYNYNNYNNNNNYYYYNYYYNNYNNNNNYYN", "YNNNYNNYNYYYNNNNYYYNYYNYYYYNNNNYYYNNYNNNYNYYNY", "NYNNNNYNYYNYNNNNNNNYNNNYYNYYYNYYYNYNNNNNYNNNNY", "YNNNYNYNNNYNNNYYNNYYNNYYNNYNNNYYNYNNNNNNNYNNYN", "NYNNYNYYNYNNNYNNYYYYYNYYYYYNNNYYYYYNNYYNNYYYNN", "YNNNNNNYYYNYNYNNNYYNNYNNNNNNYNNYYNNYNNNYYNNYNN", "NNNYYNYYYNNNYYNNNNYNYNYYNYNNNYNYYNYNNYNNYNNNYN", "NYNYYYNNNNNYYNNNNNNNNNNYYNNNYYNYNYNYYYNNYYNNNN", "YYNNYYNNNYYYNNYYYNNNYNYYNNYYNYYYNYYYYNNYNNYNNN", "NYYNYYYNNNNYYNYYYNNYNYNYYNYNYYYNNNYNNYYNNNNNNN" };
    int M = 162;
    assertArrayEquals(new int[] { 19, 17, 15, 16, 29, 23, 27, 21, 11, 4, 8, 3, 4, 4, 1, 3, 5, 2, 5, 1, 3, 6, 3, 4, 6, 5, 6, 6, 5, 6, 2, 4, 5, 3, 2, 4, 5, 3, 2, 3, 4, 2, 4, 4, 4, 5 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case69() {
    String[] roads = { "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNYNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNYNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNYNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNYNYNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNYNNNNNNNNNNNYNYNNNNNNNNNNNNNNYNNNNN", "YNNNNNYNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN", "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN" };
    int M = 301;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case70() {
    String[] roads = { "NYYYYYYYYYYYNNYYYYNNNYYYNYYYYYYYYYYYYYYNYYYYYYNY", "YNYYNYYYYYYYYNYYYYYYYYYYYYNYYNYYYYYYYYYNNYYYNYYY", "YYNYNYYYYYYYYYYYYYYYNYYNYYYNYYYNNYYYYYYYYYYYNYYY", "YYYNYNYYYYYNYYYYYYYYYYYYYNYYYNYYYYYYYYYYYNYYYYYN", "YNNYNYYNYYYYYNNYYYYYYYYYYYYNNYYYNYYYYYYNYYYYYYYY", "YYYNYNYNYYYYNYYYYYYNYYYYYYYYYYNNYYYYYYYYYYYYYYYY", "YYYYYYNNYYYYYYYYYYYYYYYNYYYYYYYYYYYYYYNYYYYYYYYY", "YYYYNNNNYYYYYYYYYYYYYYYYYYYYYNYYYYYNYYYYYYYNYYNY", "YYYYYYYYNYYYYYYNYYYYYYYYYYYYNYYNYYNYYYYNYYYYYYYY", "YYYYYYYYYNYYNYYYYYYYYYYYYYYYYYYYYNYYYYYYYYYYYYNY", "YYYYYYYYYYNYYYNNYYYYYYYNYYYYYNYYYYYYYYYYYYYYYYYY", "YYYNYYYYYYYNYNNYYYYYYYYYYNYYYYYYYYYYNYYYYYYYYYYY", "NYYYYNYYYNYYNYYYYYYYYYYYYNYYYYYYNYYYYYYYYYNYYYNN", "NNYYNYYYYYYNYNYYYNYYYYYYYYYYYYNYYNYYYNYYYYYYYYYY", "YYYYNYYYYYNNYYNYYYYYYYYYYYYYYYYYYYYNYYYYYYYYYYYY", "YYYYYYYYNYNYYYYNNYYYYYYYYYYYYYYNYYYYYYYYYNYYYYYN", "YYYYYYYYYYYYYYYNNYYYYYYYNYYYYYYYYYYNNNYYYYYYYYYY", "YYYYYYYYYYYYYNYYYNYYYYYYYYYYYNYYNYYYYYYYYYYNYYYY", "NYYYYYYYYYYYYYYYYYNNYYYYYNYYNYNNYYYYYYYYYYNYYYYN", "NYYYYNYYYYYYYYYYYYNNYYYYYYYNNYYYYYYYYNYYYYYYYYNY", "NYNYYYYYYYYYYYYYYYYYNYYYYYYYYYYYYNYYYYYYYYNYNYYY", "YYYYYYYYYYYYYYYYYYYYYNYNYYNYYYYYYYYYYYYNNYNNYYYY", "YYYYYYYYYYYYYYYYYYYYYYNYNYYYYYYYYYNYYYYYNYYYYYYY", "YYNYYYNYYYNYYYYYYYYYYNYNYYYYYNNYYYYYYNYYYYYYNNYY", "NYYYYYYYYYYYYYYYNYYYYYNYNYYYYNYNYYYNYYYYYYYYYYYY", "YYYNYYYYYYYNNYYYYYNYYYYYYNYYYYYYYYYYYYNYYYYYYNYY", "YNYYYYYYYYYYYYYYYYYYYNYYYYNYYYNYYYYYYYYYYYYYYYYY", "YYNYNYYYYYYYYYYYYYYNYYYYYYYNYYYYYYYYYYYYNYYYYYYY", "YYYYNYYYNYYYYYYYYYNNYYYYYYYYNYNYYYYYYYNYYNYYYYYY", "YNYNYYYNYYNYYYYYYNYYYYYNNYYYYNYNYYNNYYYNYNYYYYYY", "YYYYYNYYYYYYYNYYYYNYYYYNYYNYNYNYNYYYYYYYYYNNYYYY", "YYNYYNYYNYYYYYYNYYNYYYYYNYYYYNYNNNYYYYYYNYYYNYYY", "YYNYNYYYYYYYNYYYYNYYYYYYYYYYYYNNNYYYYNNYYYYYYNYN", "YYYYYYYYYNYYYNYYYYYYNYYYYYYYYYYNYNNYYYYNNYNYYYYY", "YYYYYYYYNYYYYYYYYYYYYYNYYYYYYNYYYNNYNYYNYYYYYYYY", "YYYYYYYNYYYYYYNYNYYYYYYYNYYYYNYYYYYNYYYNYYNYYYYY", "YYYYYYYYYYYNYYYYNYYYYYYYYYYYYYYYYYNYNYYNYYYYYYYY", "YYYYYYYYYYYYYNYYNYYNYYYNYYYYYYYYNYYYYNYNNYYYYYNN", "YYYYYYNYYYYYYYYYYYYYYYYYYNYYNYYYNYYYYYNNYYYNYYYY", "NNYYNYYYNYYYYYYYYYYYYNYYYYYYYNYYYNNNNNNNYNYYNYYY", "YNYYYYYYYYYYYYYYYYYYYNNYYYYNYYYNYNYYYNYYNYYYYYYY", "YYYNYYYYYYYYYYYNYYYYYYYYYYYYNNYYYYYYYYYNYNYYYYYN", "YYYYYYYYYYYYNYYYYYNYNNYYYYYYYYNYYNYNYYYYYYNYYNYY", "YYYYYYYNYYYYYYYYYNYYYNYYYYYYYYNYYYYYYYNYYYYNYYYY", "YNNYYYYYYYYYYYYYYYYYNYYNYYYYYYYNYYYYYYYNYYYYNYYY", "YYYYYYYYYYYYYYYYYYYYYYYNYNYYYYYYNYYYYYYYYYNYYNYY", "NYYYYYYNYNYYNYYYYYYNYYYYYYYYYYYYYYYYYNYYYYYYYYNY", "YYYNYYYYYYYYNYYNYYNYYYYYYYYYYYYYNYYYYNYYYNYYYYYN" };
    int M = 92;
    assertArrayEquals(new int[] { 39, 40, 16, 3, 1, 3, 3, 3, 3, 3, 3, 3, 2, 1, 3, 3, 3, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2, 1, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case71() {
    String[] roads = { "NNYYNNNNNYNYNYNNNNYYYYYNYYYNNNNNNYYNNNNYYNNYYNNNYN", "NNYNYNNNNYYNYNYNNYNYNYNYNYNNYNYNNYYYNNNNYYYNNNNYNN", "YYNNNYNNYYYNYNYYNNYNNYYNYYYYNNNNNNYNNNYNYNNNNNYNYN", "YNNNYNYNNNYNNNYNYNYNNNNNYNYNYYNYNNNNYNNYNNNYNNNNNY", "NYNYNNYYNNNNNNNNNYNYNYNNNYYYNNNYNNYYNNNNNNYNNNNNNY", "NNYNNNYYYYNNNYNNNYYNNYNYNYNNNYNYNYNYNYYNYYNYYNNNYN", "NNNYYYNNYYNNNYNYYNNYNNYYYYNYNNNYYNYNNNNNNYNYNNNYNY", "NNNNYYNNNYNNNNYNYYNNNNNNYNNNNYNNYNNNYNYYYNYNYYNNNN", "NNYNNYYNNNNNNNNNYNYYNNNNNNYNYNYYYYNYYYYNYNNNYNNNNN", "YYYNNYYYNNYYYNNNYYNNNNNNYNYYYNNNYNNNNNNYNNYYYYNNYN", "NYYYNNNNNYNYYNYYNNNNNNNYNYYNNNNYYNYNNYYNYYNNYNYNYY", "YNNNNNNNNYYNYNNNNNNNNNNNNNNNNNYYYNNNYNNNYNNYNNYNYN", "NYYNNNNNNYYYNNNNNNNNNNNNNYYYNYYNYNYYYNNNYNYNYYNYYY", "YNNNNYYNNNNNNNNYNNNYNYNNYYNYNNNYYNYYNYNNNYNNNYNYYN", "NYYYNNNYNNYNNNNYNNYNNYYNYNNYYNYNYYNYNNYYNYNYNNNNNY", "NNYNNNYNNNYNNYYNNYYYNNYYYNYYNYNNYNNNNYYYNNYYYYNNNY", "NNNYNNYYYYNNNNNNNNYYNNYNNYYYYNYYYNNYYYNNNNYNNYNNYN", "NYNNYYNYNYNNNNNYNNNNYNYYNYYYYYYNNNNNYYNNYYYYYYYYNN", "YNYYNYNNYNNNNNYYYNNNYNNNYNNYYYYNYNNYYNYYNYYNYNYYNN", "YYNNYNYNYNNNNYNYYNNNNNYNYYNNNNYNNNYYNNNYYNNYYYYYYN", "YNNNNNNNNNNNNNNNNYYNNYYNNNYNYYYNYYNNNYNNYNNNYYYNNY", "YYYNYYNNNNNNNYYNNNNNYNYNNYNNNNYYYYNNYYNNYYNNYNYYNY", "YNYNNNYNNNNNNNYYYYNYYYNNNNYNNNNYYNYYNNYYNYNYNNYYYN", "NYNNNYYNNNYNNNNYNYNNNNNNNNNYNYNYNNYYYYNNYNNNYNYYNY", "YNYYNNYYNYNNNYYYNNYYNNNNNNYYNYYYNNNNYNYNYYYNYYYYYY", "YYYNYYYNNNYNYYNNYYNYNYNNNNNYNYNYYNNNNNNNYNNYNNNYNY", "YNYYYNNNYYYNYNNYYYNNYNYNYNNYYYNNYYNYNNNNNNYNNYNNNN", "NNYNYNYNNYNNYYYYYYYNNNNYYYYNNNYYNYYYNNNNNYNNNYYNYY", "NYNYNNNNYYNNNNYNYYYNYNNNNNYNNNNNNYYYYYYNYYNNYNNYNN", "NNNYNYNYNNNNYNNYNYYNYNNYYYYNNNYNYYNYYYYYNYYYYYNNNN", "NYNNNNNNYNNYYNYNYYYYYYNNYNNYNYNNNYNNNNNNYYYNYNNNYN", "NNNYYYYNYNYYNYNNYNNNNYYYYYNYNNNNYYYNYNYYYYNNYNYYNN", "NNNNNNYYYYYYYYYYYNYNYYYNNYYNNYNYNNNYYNNYNYYNYNNYNY", "YYNNNYNNYNNNNNYNNNNNYYNNNNYYYYYYNNNNYNNNNYNNNYNYYN", "YYYNYNYNNNYNYYNNNNNYNNYYNNNYYNNYNNNNNNYYYYYYYNYNYY", "NYNNYYNNYNNNYYYNYNYYNNYYNNYYYYNNYNNNNNNNNNYYNYNYNY", "NNNYNNNYYNNYYNNNYYYNNYNYYNNNYYNYYYNNNNYYNNYNNNNYYN", "NNNNNYNNYNYNNYNYYYNNYYNYNNNNYYNNNNNNNNYYNNNYNNNNNN", "NNYNNYNYYNYNNNYYNNYNNNYNYNNNYYNYNNYNYYNYYNYNYNYYNY", "YNNYNNNYNYNNNNYYNNYYNNYNNNNNNYNYYNYNYYYNNYYNNNYNNN", "YYYNNYNYYNYYYNNNNYNYYYNYYYNNYNYYNNYNNNYNNNYYYNNYNN", "NYNNNYYNNNYNNYYNNYYNNYYNYNNYYYYYYYYNNNNYNNYNYYNYYN", "NYNNYNNYNYNNYNNYYYYNNNNNYNYNNYYNYNYYYNYYYYNYYNNNNN", "YNNYNYYNNYNYNNYYNYNYNNYNNYNNNYNNNNYYNYNNYNYNYYNYYY", "YNNNNYNYYYYNYNNYNYYYYYNYYNNNYYYYYNYNNNYNYYYYNNYYNY", "NNNNNNNYNYNNYYNYYYNYYNNNYNYYNYNNNYNYNNNNNYNYNNNNNN", "NNYNNNNNNNYYNNNNNYYYYYYYYNNYNNNYNNYNNNYYNNNNYNNNYY", "NYNNNNYNNNNNYYNNNYYYNYYYYYNNYNNYYYNYYNYNYYNYYNNNYN", "YNYNNYNNNYYYYYNNYNNYNNYNYNNYNNYNNYYNYNNNNYNYNNYYNN", "NNNYYNYNNNYNYNYYNNNNYYNYYYNYNNNNYNYYNNYNNNNYYNYNNN" };
    int M = 525;
    assertArrayEquals(new int[] { 20, 20, 21, 16, 15, 22, 21, 16, 18, 22, 22, 12, 21, 18, 21, 23, 21, 25, 24, 22, 17, 22, 22, 18, 27, 21, 22, 25, 20, 25, 20, 26, 27, 18, 24, 22, 21, 15, 23, 19, 25, 25, 23, 23, 27, 17, 17, 22, 19, 18 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case72() {
    String[] roads = { "NYYYYNYYYYYYNNNYYYYYNYYYNNYYYYNNYNNYNNNYYYYYNYYYYY", "YNYYYNYNNYYNYNYNNNYYYYYYYNYYYNYNNYNYYYYYYYNNNYNNYY", "YYNYNYNNYNNNYNYYNNYNYNYNYNNYYNYYYYYYYYYYNYYYYNNYYY", "YYYNYYYYYYNNNYYYYYYNYNNNNYYNNYNYNYYYNYYNNYYYYYNNNN", "YYNYNYYNYYYNNYYYNYYYNNYNYYYYYYYNNYNYYNYNNYYYYYYNYN", "NNYYYNYYYNYYYYYNYNYYYNYNYYNYYNNYYYYNYYYNYYYYNYYYNY", "YYNYYYNYNYYYNYYYNYYNYNYNYYNYYYNYYYYNYNYYYNYNYYYYNY", "YNNYNYYNYNYNYYNNYNYYYNNYYNYNYYYNNYNYYNYYNYNNNYNYYN", "YNYYYYNYNYYNYYYNNNYYNNNYYYYYYNYYYNYNYYNYYYNNYNYNNN", "YYNYYNYNYNYYYNYNYYYYYNNNYYYYYNYNNYNNYYYYYYNYNNYYYY", "YYNNYYYYYYNYNYNYYNNYNNYYYYYYYNYYYYNYYYNNYYNNYYNNYN", "YNNNNYYNNYYNYYNYYYYYYNYYYYYNNNYYNYNYYYNNYYYYNNYYYY", "NYYNNYNYYYNYNYYYYYYNNYYYYYNNYYNYYNNYYNYYYYNYYNYNYY", "NNNYYYYYYNYYYNNYYYYYYYNYNYNNYYYNYNYNNYYNYYYYYYNNNY", "NYYYYYYNYYNNYNNYYNYYYNNNYNYYNYYYNNNNYYYNNYNYYYYYYN", "YNYYYNYNNNYYYYYNYNNNYYYYYYYYYYYYYYYYYYNNNYNYYYYNYY", "YNNYNYNYNYYYYYYYNYYNYYYNYYNYYYNYYYNYYNYNYYYNYYNYNY", "YNNYYNYNNYNYYYNNYNNYYYYYNNNYNNYYYYNYYYYNNYYYNNYYYN", "YYYYYYYYYYNYYYYNYNNNYYYYNYNNYYYYNYNNYNNYYNNYNYNYNY", "YYNNYYNYYYYYNYYNNYNNNYYYYNYYNYNNYNNYYNYNNYYYYNYYYY", "NYYYNYYYNYNYNYYYYYYNNYYYNNYYYYNYYNYYYYYNYNNYYNYNNY", "YYNNNNNNNNNNYYNYYYYYYNYNNNNYNNYNNYNYNYNYYYYNYNYYYN", "YYYNYYYNNNYYYNNYYYYYYYNYYNYYNYYNYYNNNNNYNYNYYNYNNN", "YYNNNNNYYNYYYYNYNYYYYNYNNYYYYNYYYYNYYYYYNNNYYYNNYY", "NYYNYYYYYYYYYNYYYNNYNNYNNYYYNNYYNYYYNYNNYYYYNYNYNN", "NNNYYYYNYYYYYYNYYNYNNNNYYNYNYNNYYYYYYNYYYYYYYYNNYY", "YYNYYNNYYYYYNNYYNNNYYNYYYYNNYYNNYNYNNYYNYNNNYYNNYY", "YYYNYYYNYYYNNNYYYYNYYYYYYNNNNNYYYNYYYNYYYYYYYYNNYY", "YYYNYYYYYYYNYYNYYNYNYNNYNYYNNYYYNNNYYYYYYNYYNYNNYN", "YNNYYNYYNNNNYYYYYNYYYNYNNNYNYNYYYYYNYYYNYNYYNYYYYY", "NYYNYNNYYYYYNYYYNYYNNYYYYNNYYYNYYYYNYYNNYYYNYNYNYY", "NNYYNYYNYNYYYNYYYYYNYNNYYYNYYYYNNYNYYNYNYNYNYNYNNY", "YNYNNYYNYNYNYYNYYYNYYNYYNYYYNYYNNNNYYYYYYYNYNNYYNN", "NYYYYYYYNYYYNNNYYYYNNYYYYYNNNYYYNNYNNNYNYNYYYYNYYN", "NNYYNYYNYNNNNYNYNNNNYNNNYYYYNYYNNYNNNYYNNYNYNYYNYN", "YYYYYNNYNNYYYNNYYYNYYYNYYYNYYNNYYNNNYYYNYNYYYYYYYY", "NYYNYYYYYYYYYNYYYYYYYNNYNYNYYYYYYNNYNYNYNYNYYNYYNY", "NYYYNYNNYYYYNYYYNYNNYYNYYNYNYYYNYNYYYNNYNNNNYYNYYY", "NYYYYYYYNYNNYYYNYYNYYNNYNYYYYYNYYYYYNNNYYYYYYNYYYY", "YYYNNNYYYYNNYNNNNNYNNYYYNYNYYNNNYNNNYYYNYYYNNNYYYY", "YYNNNYYNYYYYYYNNYNYNYYNNYYYYYYYYYYNYNNYYNYNYYNNYYN", "YYYYYYNYYYYYYYYYYYNYNYYNYYNYNNYNYNYNYNYYYNYYYYYYYY", "YNYYYYYNNNNYNYNNYYNYNYNNYYNYYYYYNYNYNNYYNYNYNNNYYN", "YNYYYYNNNYNYYYYYNYYYYNYYYYNYYYNNYYYYYNYNYYYNNYYYYY", "NNYYYNYNYNYNYYYYYNNYYYYYNYYYNNYYNYNYYYYNYYNNNYYYNN", "YYNYYYYYNNYNNYYYYNYNNNNYYYYYYYNNNYYYNYNNNYNYYNNYNY", "YNNNYYYNYYNYYNYYNYNYYYYNNNNNNYYYYNYYYNYYNYNYYNNYNY", "YNYNNYYYNYNYNNYNYYYYNYNNYNNNNYNNYYNYYYYYYYYYYYYNYY", "YYYNYNNYNYYYYNYYNYNYNYNYNYYYYYYNNYYYNYYYYYYYNNNYNN", "YYYNNYYNNYNYYYNYYNYYYNNYNYYYNYYYNNNYYYYYNYNYNYYYNN" };
    int M = 64;
    assertArrayEquals(new int[] { 34, 25, 6, 4, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case73() {
    String[] roads = { "NNNNNYYNYNNNYYNNNYNNNNNNYYYYYYNNNNYYNNNNYYNNNN", "NNNYNNNNNNYYNNNYYNYYNNYNNNYYNYNNNNNYNYYNYNNNNN", "NNNNNNYNNNNNNNYNYNYYNNNNNNNNNYYYNNNNNYNYNYNYYN", "NYNNNYYNYNNYNNNNNNYNYNNNYNNNNYYYNYNYNNNNNNNYNY", "NNNNNNYNNNYNNYNNNYNNNNYNNYNNYNYYNNNYNNNNYYYNYN", "YNNYNNYNYNYYYNYNNNNYNYNNNNYNNNNNNNNNNNYYNYYNNY", "YNYYYYNNNNYNNYYYNNYYYYNNNNYNNYNYYNYNNNNYYNNNNN", "NNNNNNNNYNNNNYNNNYYNNNYYNNYNNNNYNNNNNYNYYNNNYY", "YNNYNYNYNNNYYNYYNYNNYNYNNNNNYNNNNNYNNYNNYNNYYN", "NNNNNNNNNNYNNNNNYYNYYYYNNYYYNNNNYNNNYYYNNYYYYY", "NYNNYYYNNYNNNNNNNYNNNNNNNNNYNNYNNNNNNYNYNNYYNN", "NYNYNYNNYNNNNNNNYYNNNYYNNNNYYNNNNNNNNNYNNNYYNN", "YNNNNYNNYNNNNYNNNNNYNYNYNNNNNNYNNNYYYNNNYYNNNN", "YNNNYNYYNNNNYNNNNNNNNNNYNNNNYNNYNNNNNNNYNNYYNN", "NNYNNYYNYNNNNNNNNNNNYYYNNNNNYNYYYNNNNNYYNNYYYN", "NYNNNNYNYNNNNNNNNNNNNNYNNYNNNYNYNNYYNNYYNYYNNY", "NYYNNNNNNYNYNNNNNNNNYNYNNNNNNYNNNYNYYNYNNNNYYY", "YNNNYNNYYYYYNNNNNNNNNNYYYYYNNYNNYYYNYYNNNNYYNY", "NYYYNNYYNNNNNNNNNNNYYYYYNNNNNYNNNYNYYNYNNNYYNN", "NYYNNYYNNYNNYNNNNNYNNYNNNNNNNNYNYYNNNNNYNYYNYN", "NNNYNNYNYYNNNNYNYNYNNYNYNNNNNNNYYNYYNYNNNNNNYY", "NNNNNYYNNYNYYNYNNNYYYNYNYNNNYNNNNNYYNYYNYYNNNN", "NYNNYNNYYYNYNNYYYYYNNYNNYYYYNNYNNYNYNNNNYNNNNN", "NNNNNNNYNNNNYYNNNYYNYNNNYNNYNNNYNNNNYYYNYNNNNY", "YNNYNNNNNNNNNNNNNYNNNYYYNNNYNNYYYNNNYYYYNYNNNY", "YNNNYNNNNYNNNNNYNYNNNNYNNNNNNNYNNYNNNNNYYYYNNN", "YYNNNYYYNYNNNNNNNYNNNNYNNNNYYNYNNNNYNYYNNNNYNN", "YYNNNNNNNYYYNNNNNNNNNNYYYNYNYNNNNNNNYNNNNNYNYN", "YNNNYNNNYNNYNYYNNNNNNYNNNNYYNNNYNNNNYNNNYNNNNN", "YYYYNNYNNNNNNNNYYYYNNNNNNNNNNNYNNYYNNNNNYYNNNY", "NNYYYNNNNNYNYNYNNNNYNNYNYYYNNYNNYNNNNNNNYYYNNN", "NNYYYNYYNNNNNYYYNNNNYNNYYNNNYNNNYYNYYYYNNNNNNY", "NNNNNNYNNYNNNNYNNYNYYNNNYNNNNNYYNNNNYNNYNYNYNY", "NNNYNNNNNNNNNNNNYYYYNNYNNYNNNYNYNNYNNNNYYNYNNY", "YNNNNNYNYNNNYNNYNYNNYYNNNNNNNYNNNYNYYNNYNNNYNN", "YYNYYNNNNNNNYNNYYNYNYYYNNNYNNNNYNNYNYNNNNNYYNY", "NNNNNNNNNYNNYNNNYYYNNNNYYNNYYNNYYNYYNYNNNNYNYN", "NYYNNNNYYYYNNNNNNYNNYYNYYNYNNNNYNNNNYNYNNYYYYN", "NYNNNYNNNYNYNNYYYNYNNYNYYNYNNNNYNNNNNYNYYYYNYN", "NNYNNYYYNNYNNYYYNNNYNNNNYYNNNNNNYYYNNNYNNNNNNN", "YYNNYNYYYNNNYNNNNNNNNYYYNYNNYYYNNYNNNNYNNYNYNN", "YNYNYYNNNYNNYNNYNNNYNYNNYYNNNYYNYNNNNYYNYNNYYN", "NNNNYYNNNYYYNYYYNYYYNNNNNYNYNNYNNYNYYYYNNNNYYN", "NNYYNNNNYYYYNYYNYYYNNNNNNNYNNNNNYNYYNYNNYYYNNN", "NNYNYNNYYYNNNNYNYNNYYNNNNNNYNNNNNNNNYYYNNYYNNN", "NNNYNYNYNYNNNNNYYYNNYNNYYNNNNYNYYYNYNNNNNNNNNN" };
    int M = 364;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case74() {
    String[] roads = { "NNNYNNNNYNNNNNNNYNNNNNNNNNNNYNNNNNNYYNNYYYNYNNNN", "NNNYNYNNNYNNNYYNYYNYNNNYNNNNNNNNYYNNYNYYNYYNNNYN", "NNNNNNNNNYNNYNNNYYNNNNNNNYNNYYNNYNNNNNNNYNNNNYYN", "YYNNNNNNNNNYYNNNNNNNYNNNYNNNYNNNNYYNNNYYNNNNNNNN", "NNNNNYNNNYYNNNNYNYNNNYNNNYNYNNNYNNNNNNNYYNNNYNNN", "NYNNYNYNYYNNYNNNNNYYNNYNNNNNNNNNNYNNNYNNNNNYYYNN", "NNNNNYNYYYNNNNNNNNNNNNNNNYYYYNYNNNNNNYYNNNYNYNYY", "NNNNNNYNNNYNNNNNNNYNYNNNYNNNNNYNNNYNYNNNNNYNNYNY", "YNNNNYYNNNNYNNNNNNYNNNNNNNNNNYNNNNNNNNNYNNNNNNYN", "NYYNYYYNNNNYYYNNNNNNNNNYNNNNNNNYNNNYNNNNYNNNNNNN", "NNNNYNNYNNNNNNNNNNYNNYNNNNNNYNNNNNNNYNNNNNYNNYNY", "NNNYNNNNYYNNNYNNNNYNYNNNNNNNNNNYYNNNNNNNYNYNNNNN", "NNYYNYNNNYNNNNNNNNNNYNNNYNNYNNNYNNNNNNYYYYYYYYNN", "NYNNNNNNNYNYNNNNNNYNNNNNNNNNYNYNNNYYYNYNNNNYNYNN", "NYNNNNNNNNNNNNNNNNNYNYYNNNNNNNNNNNNNYYNNNNNNNYNN", "NNNNYNNNNNNNNNNNNNNNNNNYNNYYNNYYNNNNYNNNNNNYNYNN", "YYYNNNNNNNNNNNNNNNNNYNNNNNYNNNYNYNNNNNYNNYNNNNYN", "NYYNYNNNNNNNNNNNNNNNNNNNNYNNNNYNNNNNNNYNNNNYNYNN", "NNNNNYNYYNYYNYNNNNNNYNNNNYNYNNNNNYYYNNNNNNNNNNYN", "NYNNNYNNNNNNNNYNNNNNNNNYNYNNNYYNNYNNNNYNNNNNYNNN", "NNNYNNNYNNNYYNNNYNYNNNYYNNYYNNYNNNNNNNNNNNYYNNNN", "NNNNYNNNNNYNNNYNNNNNNNNYNNNYYNNYNNYNNNNNNYNNNNNN", "NNNNNYNNNNNNNNYNNNNNYNNNNNNNNNNNNNNNNNNNYNNYNNNN", "NYNNNNNNNYNNNNNYNNNYYYNNNYNNNNYYNNNNNYNNNYNYYNNY", "NNNYNNNYNNNNYNNNNNNNNNNNNNNNYNNNNYNNNYNNNNNNNNNN", "NNYNYNYNNNNNNNNNNYYYNNNYNNNNYYYNNNNNNNNNNYYYNNNN", "NNNNNNYNNNNNNNNYYNNNYNNNNNNNNYNYNNNYYNYYNNNNNNNN", "NNNNYNYNNNNNYNNYNNYNYYNNNNNNNNNNNNNYNNNNYYYYNYNY", "YNYYNNYNNNYNNYNNNNNNNYNNYYNNNNNNNNNYYYYNNNNNYNNN", "NNYNNNNNYNNNNNNNNNNYNNNNNYYNNNNNNNNNNNYNNYNNNYNY", "NNNNNNYYNNNNNYNYYYNYYNNYNYNNNNNNNNNNNNNNNNNYNNNN", "NNNNYNNNNYNYYNNYNNNNNYNYNNYNNNNNNYNYNNNNNYYYNNNN", "NYYNNNNNNNNYNNNNYNNNNNNNNNNNNNNNNNNYNNNNNNNYNNNN", "NYNYNYNNNNNNNNNNNNYYNNNNYNNNNNNYNNNNNNNNNNNYNYNN", "NNNYNNNYNNNNNYNNNNYNNYNNNNNNNNNNNNNNNNNYNNNYNNYN", "YNNNNNNNNYNNNYNNNNYNNNNNNNYYYNNYYNNNYNNNYNNNNNNN", "YYNNNNNYNNYNNYYYNNNNNNNNNNYNYNNNNNNYNYYNNNNYNNNY", "NNNNNYYNNNNNNNYNNNNNNNNYYNNNYNNNNNNNYNYYNNNYNNNY", "NYNYNNYNNNNNYYNNYYNYNNNNNNYNYYNNNNNNYYNNYNNYYNYN", "YYNYYNNNYNNNYNNNNNNNNNNNNNYNNNNNNNYNNYNNNYNNNYNN", "YNYNYNNNNYNYYNNNNNNNNNYNNNNYNNNNNNNYNNYNNNNNYYNN", "YYNNNNNNNNNNYNNNYNNNNYNYNYNYNYNYNNNNNNNYNNNNNNNN", "NYNNNNYYNNYYYNNNNNNNYNNNNYNYNNNYNNNNNNNNNNNNNNNN", "YNNNNYNNNNNNYYNYNYNNYNYYNYNYNNYYYYYNYYYNNNNNYNNN", "NNNNYYYNNNNNYNNNNNNYNNNYNNNNYNNNNNNNNNYNYNNYNNNN", "NNYNNYNYNNYNYYYYNYNNNNNNNNNYNYNNNYNNNNNYYNNNNNYN", "NYYNNNYNYNNNNNNNYNYNNNNNNNNNNNNNNNYNNNYNNNNNNYNN", "NNNNNNYYNNYNNNNNNNNNNNNYNNNYNYNNNNNNYYNNNNNNNNNN" };
    int M = 69;
    assertArrayEquals(new int[] { 10, 17, 11, 11, 12, 8, 5, 1, 2, 4, 1, 1, 2, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 2, 2, 1, 1, 2, 1, 2, 4, 3, 2, 1, 1, 1, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case75() {
    String[] roads = { "NYYNYNNYYYNNNNNYNNYNYNNYYNNNNNNNYNYYNNYYNYYNYNNNYY", "YNYNNNYNNYNNYYNNYNNNNNYNNYYNYNNYNYNYNNYNNNYYYYNNYN", "YYNNYNNNYNNYYYYYYNNYYYNYYYYNYNNYYYYYNNNNNNNYNNNYNY", "NNNNYYNNNNNYYYNNNNYNNNYNYNNYNYYNYYYNYYYYYYNYYNNYYN", "YNYYNNYYNNNNYNYYYNNNYYNYYNYNNYNNNYNNYNYYYYYYNYNYNY", "NNNYNNYNYNNNYNNNNYNNYNNNYNYNNYYYYNNYNNYYNYYYYNYYNY", "NYNNYYNNNYYNYYNNYYNNNYYNNYNYNNNYYNYNNNYYNYYYNNYNNN", "YNNNYNNNNNYYNNNNYYYYNNYNNNYNYYNYYYNYNYNYNNYNYNNYNY", "YNYNNYNNNNYNNYYYNNYYNNNYNYNYNYNNNNYNYYYYYYYYYYNNNN", "YYNNNNYNNNYYNYYYNYYYNNYYYNYNNNYNNNYYYNYNNNNYNNYYYN", "NNNNNNYYYYNYYNNNYYNYNYNYNNNYNNNYYYNNNYNYNYNNNYYNYY", "NNYYNNNYNYYNYYYNYYYYYNNYNNYNNYYNNNYYYNNYYNNYYYNYYN", "NYYYYYYNNNYYNYYNYYNNYYNYNYYNYNNNNNNNNNNNYYNYNNNYNY", "NYYYNNYNYYNYYNYYNNYNNYYNNNYNNYNNYYNYYYNYNYYYYYYYNN", "NNYNYNNNYYNYYYNNNNYYNNNYNYYNYYNYNNNYNYYYNYYNNNYYNN", "YNYNYNNNYYNNNYNNYNYNNYYYYNNNNYNYNYNYNNYNYYNYNYYNYY", "NYYNYNYYNNYYYNNYNNYYYNYNNNNNNYYYNYYYYYNNNNYNYYYYYN", "NNNNNYYYNYYYYNNNNNYNNNNNNNYYYYNNYNNNYNNNYYYYNYNYYY", "YNNYNNNYYYNYNYYYYYNNYYYNNYNNYNNNYYNYYYYNYNYNYYYYNN", "NNYNNNNYYYYYNNYNYNNNNNNNYYYYYYYYYNYNYNNYNYNNNNYNYY", "YNYNYYNNNNNYYNNNYNYNNNNYYYNYYNNYYYNNYYYNNYYNNNYYNN", "NNYNYNYNNNYNYYNYNNYNNNNYNNNYYNNNYNNNYNYNNNYYNYNYYN", "NYNYNNYYNYNNNYNYYNYNNNNNNYYNYNYNYNYYNYNYYNNNNNNYYY", "YNYNYNNNYYYYYNYYNNNNYYNNNNYYNNNYNNNNYYYYYNYYYYYNNY", "YNYYYYNNNYNNNNNYNNNYYNNNNYYYNNYYYNYNYNNNYYNYYYYNYN", "NYYNNNYNYNNNYNYNNNYYYNYNYNYNNYYYYYNYNNNNNYYNNYNYNY", "NYYNYYNYNYNYYYYNNYNYNNYYYYNNYNNYNYYNNYYYNNYYYNNYYN", "NNNYNNYNYNYNNNNNNYNYYYNYYNNNYYYYNYNNYNNYYNNYNNNYYY", "NYYNNNNYNNNNYNYNNYYYYYYNNNYYNYYNNYYYNYYYNYYNNYNYYN", "NNNYYYNYYNNYNYYYYYNYNNNNNYNYYNYNYYYYNNNNYNYYYNYYYN", "NNNYNYNNNYNYNNNNYNNYNNYNYYNYYYNNYNNYYYNYYNYYNNYYNY", "NYYNNYYYNNYNNNYYYNNYYNNYYYYYNNNNNYNYYNNYYYNNNNNYYN", "YNYYNYYYNNYNNYNNNYYYYYYNYYNNNYYNNYNYYNYYYYNYNNYNNY", "NYYYYNNYNNYNNYNYYNYNYNNNNYYYYYNYYNNNNNYYNYNYYYNYNY", "YNYYNNYNYYNYNNNNYNNYNNYNYNYNYYNNNNNYYNYYNNNNYNNNYY", "YYYNNYNYNYNYNYYYYNYNNNYNNYNNYYYYYNYNNNNYNNYYYYYNNN", "NNNYYNNNYYNYNYNNYYYYYYNYYNNYNNYYYNYNNYYYYNNNYNYNYN", "NNNYNNNYYNYNNYYNYNYNYNYYNNYNYNYNNNNNYNYYNYNYYYNYNN", "YYNYYYYNYYNNNNYYNNYNYYNYNNYNYNNNYYYNYYNNNYYNNNYNYY", "YNNYYYYYYNYYNYYNNNNYNNYYNNYYYNYYYYYYYYNNNYNYYNYYYN", "NNNYYNNNYNNYYNNYNYYNNNYYYNNYNYYYYNNNYNNNNNNYNNNNYY", "YNNYYYYNYNYNYYYYNYNYYNNNYYNNYNNYYYNNNYYYNNYYNNYNYY", "YYNNYYYYYNNNNYYNYYYNYYNYNYYNYYYNNNNYNNYNNYNYYYYYYN", "NYYYYYYNYYNYYYNYNYNNNYNYYNYYNYYNYYNYNYNYYYYNYNYNYN", "YYNYNYNYYNNYNYNNYNYNNNNYYNYNNYNNNYYYYYNYNNYYNNNNNN", "NYNNYNNNYNYYNYNYYYYNNYNYYYNNYNNNNYNYNYNNNNYNNNNNYN", "NNNNNYYNNYYNNYYYYNYYYNNYYNNNNYYNYNNYYNYYNYYYNNNNNN", "NNYYYYNYNYNYYYYNYYYNYYYNNYYYYYYYNYNNNYNYNNYNNNNNYY", "YYNYNNNNNYYYNNNYYYNYNYYNYNYYYYNYNNYNYNYYYYYYNYNYNY", "YNYNYYNYNNYNYNNYNYNYNNYYNYNYNNYNYYYNNNYNYYNNNNNYYN" };
    int M = 50;
    assertArrayEquals(new int[] { 21, 14, 7, 8, 2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case76() {
    String[] roads = { "NNYY", "NNYY", "YYNN", "YYNN" };
    int M = 5;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case77() {
    String[] roads = { "NYNNY", "YNNNY", "NNNNN", "NNNNY", "YYNYN" };
    int M = 4;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case78() {
    String[] roads = { "NYYN", "YNYN", "YYNY", "NNYN" };
    int M = 3;
    assertArrayEquals(new int[] { 2, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case79() {
    String[] roads = { "NYNNNNNNNYYNNNYYNYYNNYYYYYYYNNYNYYNNYNYYNNNNYYYYYY", "YNYNYYNNYNYYYNNNNYNYYNNNNNYYNNNYYNNNYNNYYNNNYYNYNY", "NYNNNNYYNNNNYNYYYYNNNNNYNYYNYYNYNYYYYNNYYNYNYYYYNY", "NNNNYYYYYYYNYNNNYNNNNNYNYYNYNNNYYYYNNNNYNYNNNYYNYY", "NYNYNYNNYNYNYNYNYNYNYNNNNYNYYNNYNNYYYNYNNYNYYNNYNY", "NYNYYNYYYYYYNYNYYYYNYYYYYNNYYYNNYYYYYYNYNYNYNYYYNN", "NNYYNYNYYYNNNNYNNYYNNNYYYYYYYYYNYYYNYYNYYNNYYYNNNY", "NNYYNYYNNNYYNYNYYYNNYNNNYNYNYNYYNYYYNNNNYYYYYYYYNN", "NYNYYYYNNNYYNNYYYNYYYNYNYNYNYYNNYNNNNYYYYYYYNNYNNN", "YNNYNYYNNNYNNYYYNYNNNYYYYNYNNYYYNNYYNNYYNYYYNYNYNY", "YYNYYYNYYYNNNYYNNYYYNYYYNNYNYNYYYNYNYNYYYNNNYNYNYY", "NYNNNYNYYNNNYNYYYYNYYNYYYYYYYNYYYYYYYYNNYYYYNYYYNY", "NYYYYNNNNNNYNYYNYNYNYYYNYNYNNNYYYNYYYYYYNNNNNNNYYN", "NNNNNYNYNYYNYNYNNNNYNNNYYYYYNYNYYNYNYNNYYNYYYYYNYN", "YNYNYNYNYYYYYYNYYNNNYYYYYYNNNNNYYYYNYYYYYNNYYYNNYY", "YNYNNYNYYYNYNNYNYNYNNYYYYNYNYNNYYYNNYYNYYYYYYNNYNN", "NNYYYYNYYNNYYNYYNNYNNNYNYYYNYNYYNNNYYYYYYYYNYYNYNY", "YYYNNYYYNYYYNNNNNNYYYYYNNNNYNNNNYYYYYNNYYYNYYYYNNN", "YNNNYYYNYNYNYNNYYYNNYYNNYYYNNYYNYYNNNYNYYYYNYYNYYY", "NYNNNNNNYNYYNYNNNYNNYNNYYNYNYYNNNYYNNNYYNYNNYNYNYY", "NYNNYYNYYNNYYNYNNYYYNNYNYNNYYNNYYNNYYYNNYNYYNYYYNY", "YNNNNYNNNYYNYNYYNYYNNNNYNYYNNNYYYNNNNNNYYYNYYNYNYN", "YNNYNYYNYYYYYNYYYYNNYNNNYYNNNNYYYNYNYYYNNNNYNYNYYY", "YNYNNYYNNYYYNYYYNNNYNYNNYYYNYNYYNNNNNYNNNNNNNNYYYN", "YNNYNYYYYYNYYYYYYNYYYNYYNYNYNNNNNYNNNNNNNNNNYYYYNY", "YNYYYNYNNNNYNYYNYNYNNYYYYNYYYYYYYYNNNNYYNNNNYYNYNN", "YYYNNNYYYYYYYYNYYNYYNYNYNYNYYNYYNNNNYNNYYYNYNYYYYN", "YYNYYYYNNNNYNYNNNYNNYNNNYYYNYNYYYYYNYYYYNYYNYNNNYY", "NNYNYYYYYNYYNNNYYNNYYNNYNYYYNNYYYYNNYYNYYYNNYYNNYY", "NNYNNYYNYYNNNYNNNNYYNNNNNYNNNNYYYYNYNYNNNYYYNYYYYN", "YNNNNNYYNYYYYNNNYNYNNYYYNYYYYYNYNYYYYNYYNYYYYNYNYY", "NYYYYNNYNYYYYYYYYNNNYYYYNYYYYYYNNYNYYYYNYYNNNNYNYY", "YYNYNYYNYNYYYYYYNYYNYYYNNYNYYYNNNYYYYYNYNNNYYNYNYY", "YNYYNYYYNNNYNNYYNYYYNNNNYYNYYYYYYNNNNYYNYNNYNNYYNY", "NNYYYYYYNYYYYYYNNYNYNNYNNNNYNNYNYNNNNYNYNYNNNNYYNN", "NNYNYYNYNYNYYNNNYYNNYNNNNNNNNYYYYNNNYYNYYYNNYYNNNN", "YYYNYYYNNNYYYYYYYYNNYNYNNNYYYNYYYNNYNYNYYYYNYYYYYN", "NNNNNYYNYNNYYNYYYNYNYNYYNNNYYYNYYYYYYNYYYYYNNNNYNN", "YNNNYNNNYYYNYNYNYNNYNNYNNYNYNNYYNYNNNYNYYYNNNYNYYN", "YYYYNYYNYYYNYYYYYYYYNYNNNYYYYNYNYNYYYYYNYNNNNYNYYY", "NYYNNNYYYNYYNYYYYYYNYYNNNNYNYNNYNYNYYYYYNYNNYYYNYY", "NNNYYYNYYYNYNNNYYYYYNYNNNNYYYYYYNNYYYYYNYNYYYNYYYN", "NNYNNNNYYYNYNYNYYNYNYNNNNNNYNYYNNNNNYYNNNYNYNNYNYN", "NNNNYYYYYYNYNYYYNYNNYYYNNNYNNYYNYYNNNNNNNYYNYYNNNY", "YYYNYNYYNNYNNYYYYYYYNYNNYYNYYNYNYNNYYNNNYYNYNNYNYY", "YYYYNYYYNYNYNYYNYYYNYNYNYYYNYYNNNNNYYNYYYNNYNNNYNY", "YNYYNYNYYNYYNYNNNYNYYYNYYNYNNYYYYYYNYNNNYYYNYNNYNY", "YYYNYYNYNYNYYNNYYNYNYNYYYYYNNYNNNYYNYYYYNYNNNYYNNN", "YNNYNNNNNNYNYYYNNNYYNYYYNNYYYYYYYNNNYNYYYYYNYNNNNN", "YYYYYNYNNYYYNNYNYNYYYNYNYNNYYNYYYYNNNNNYYNNYYYYNNN" };
    int M = 500;
    assertArrayEquals(new int[] { 26, 22, 26, 23, 23, 34, 29, 27, 27, 27, 30, 34, 25, 25, 32, 28, 30, 27, 29, 21, 27, 22, 28, 22, 18, 13, 17, 10, 13, 8, 12, 17, 17, 12, 15, 10, 16, 12, 10, 18, 15, 13, 10, 14, 15, 16, 14, 15, 11, 15 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case80() {
    String[] roads = { "NYYN", "YNYY", "YYNY", "NYYN" };
    int M = 3;
    assertArrayEquals(new int[] { 2, 2, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case81() {
    String[] roads = { "NYYYNYYYYYNNYYNYNYNNNYNYNNNYNNNNNYYYNYNNYNNYYNNYNY", "YNNYYNYYYYYYYYNYNYNNYYYNNNYYNNYNNYYNNYNNYNYNNYYYYN", "YNNYYYYNYYYYNYNYYYNYNYNYYYYYYNNYYYNNYYYYNNNYYNYNYY", "YYYNYNNNYYYYNNYNYYNYYNNYNYYNNNYYNNNNYNNNNYNNYNYNYN", "NYYYNNYYYYNYNYYYYNYNNNYNNYYNNNNYYNNNNYNNNNYYNNYNYY", "YNYNNNNYYYYYNYNNNNYYYYNYYYYYYYNNYNNYYNNYYNNNNNNNNN", "YYYNYNNYYYYYYYYNYNNNNYNYYNYNYYYYNNYYNYNYYYNNNYYYYY", "YYNNYYYNYNYYYYNYNYYNYYNNYYNYYNNNYNNNYYYNNNYNYNNYNY", "YYYYYYYYNYYNYNYNNNYYNYNYYNYNYYNNNYNNNNYNYYNYYYYNNY", "YYYYYYYNYNYYNYYYYYYYYYYNYYYNNYNYYNNYYNYYYNYNNNYNNY", "NYYYNYYYYYNNYYNYNYNNYNYNNNNNYYYNNNNYYYYYNYNNNNYNYY", "NYYYYYYYNYNNYYYYYYYYYYYYYYNNNYYNNNYYYYNYNNYNNYYYNY", "YYNNNNYYYNYYNNYYNNNYNYNNNNNNNYYYNYYNYNYYYYYYYYNYYY", "YYYNYYYYNYYYNNNYNYYNNYNYNYYYNNNYNYYNNYYYYYYYYNNNYY", "NNNYYNYNYYNYYNNNNNYNNNYNNNYYYNYNYYNYNNNYNYYYYYNNYY", "YYYNYNNYNYYYYYNNYNNYYYYYNYYYYYNNYYYNYNNYNNNYNYYYYN", "NNYYYNYNNYNYNNNYNNYNYYYYYNNYYYNYNNNNYYYYYYNYYNNYNN", "YYYYNNNYNYYYNYNNNNNYYNYNNNNNYYNNYYNNNYYNYYNYNNNYYN", "NNNNYYNYYYNYNYYNYNNNNYNYNYNNNYNYNYYYYYYNYNYYNYNNNN", "NNYYNYNNYYNYYNNYNYNNYYNYNNYYYYNNNNNNYYNNNNNYYNYNNY", "NYNYNYNYNYYYNNNYYYNYNYYNYYNYYNYYYNNNNYNYNNYYYYNYNN", "YYYNNYYYYYNYYYNYYNYYYNYYNNNYNYYNYNNNYNNNNYNYNNYYYN", "NYNNYNNNNYYYNNYYYYNNYYNNNNNNYYNNYYYYYNYNNYNYNNNNYN", "YNYYNYYNYNNYNYNYYNYYNYNNNNNNNYNYYYYYYYNYNYNNYYNNNY", "NNYNNYYYYYNYNNNNYNNNYNNNNNNNNYYNYYYNYYNYYNYNYNYYNY", "NNYYYYNYNYNYNYNYNNYNYNNNNNYYNNYYNNYYYNNYYYNNYYNYYN", "NYYYYYYNYYNNNYYYNNNYNNNNNYNYYYYNNNYNNYYYNNYYNNNNYY", "YYYNNYNYNNNNNYYYYNNYYYNNNYYNNYNYNYYYNNYYYYNYYNYNYN", "NNYNNYYYYNYNNNYYYYNYYNYNNNYNNYYNYNYNYNNYNYYYNNNYYY", "NNNNNYYNYYYYYNNYYYYYNYYYYNYYYNYNNYNNYYYYNNNYYYNYNY", "NYNYNNYNNNYYYNYNNNNNYYNNYYYNYYNYNNYNYYNNNNNNYNYNYN", "NNYYYNYNNYNNYYNNYNYNYNNYNYNYNNYNNYNYYYYYNYYNYNYNYN", "NNYNYYNYNYNNNNYYNYNNYYYYYNNNYNNNNNNYNYNNYNYYYNYNYY", "YYYNNNNNYNNNYYYYNYYNNNYYYNNYNYNYNNYYYNNNYNYYYNNNNY", "YYNNNNYNNNNYYYNYNNYNNNYYYYYYYNYNNYNYNNYNYNNNYYNNYY", "YNNNNYYNNYYYNNYNNNYNNNYYNYNYNNNYYYYNNNNYNYYNYYNYYN", "NNYYNYNYNYYYYNNYYNYYNYYYYYNNYYYYNYNNNNYNNYNYNNYYYN", "YYYNYNYYNNYYNYNNYYYYYNNYYNYNNYYYYNNNNNYNNYYYYNNNNY", "NNYNNNNYYYYNYYNNYYYNNNYNNNYYNYNYNNYNYYNYYNYYNYYYYY", "NNYNNYYNNYYYYYYYYNNNYNNYYYYYYYNYNNNYNNYNNYNNYNNYYN", "YYNNNYYNYYNNYYNNYYYNNNNNYYNYNNNNYYYNNNYNNNYNYNYYYN", "NNNYNNYNYNYNYYYNYYNNNYYYNYNYYNNYNNNYYYNYNNNNNYYYNN", "NYNNYNNYNYNYYYYNNNYNYNNNYNYNYNNYYYNYNYYNYNNYNYYYNN", "YNYNYNNNYNNNYYYYYYYYYYYNNNYYYYNNYYNNYYYNNNYNYYYNYY", "YNYYNNNYYNNNYYYNYNNYYNNYYYNYNYYYYYYYNYNYYNNYNYYYYY", "NYNNNNYNYNNYYNYYNNYNYNNYNYNNNYNNNNYYNNYNNYYYYNNYYY", "NYYYYNYNYYYYNNNYNNNYNYNNYNNYNNYYYNNNYNYNYYYYYNNNYY", "YYNNNNYYNNNYYNNYYYNNYYNNYYNNYYNNNNNYYNYYYYYNYYNNNY", "NYYYYNYNNNYNYYYYNYNNNYYNNYYYYNYYYNYYYNYYYNNYYYYNNY", "YNYNYNYYYYYYYYYNNNNYNNNYYNYNYYNNYYYNNYYNNNNYYYYYYN" };
    int M = 132;
    assertArrayEquals(new int[] { 24, 28, 33, 23, 24, 10, 4, 4, 6, 6, 4, 5, 2, 5, 2, 4, 3, 4, 2, 2, 2, 3, 2, 3, 1, 3, 4, 3, 1, 1, 2, 3, 2, 3, 2, 1, 2, 4, 1, 1, 2, 1, 2, 3, 3, 1, 4, 2, 4, 3 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case82() {
    String[] roads = { "NYYYN", "YNYYY", "YYNYY", "YYYNY", "NYYYN" };
    int M = 4;
    assertArrayEquals(new int[] { 3, 2, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case83() {
    String[] roads = { "NYYNNNN", "YNYNNNN", "YYNNNNN", "NNNNYYY", "NNNYNYY", "NNNYYNY", "NNNYYYN" };
    int M = 6;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case84() {
    String[] roads = { "NYYYN", "YNYNY", "YYNNN", "YNNNN", "NYNNN" };
    int M = 4;
    assertArrayEquals(new int[] { 3, 2, 1, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case85() {
    String[] roads = { "NYNNN", "YNNNN", "NNNYY", "NNYNY", "NNYYN" };
    int M = 4;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case86() {
    String[] roads = { "NYYYNN", "YNYYNN", "YYNYNN", "YYYNNN", "NNNNNY", "NNNNYN" };
    int M = 6;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case87() {
    String[] roads = { "NYNY", "YNNY", "NNNY", "YYYN" };
    int M = 3;
    assertArrayEquals(new int[] { 2, 1, 1, 2 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case88() {
    String[] roads = { "NYYNYYYN", "YNNNNYYN", "YNNNYNNN", "NNNNNNYY", "YNYNNNNN", "YYNNNNYY", "YYNYNYNY", "NNNYNYYN" };
    int M = 10;
    assertArrayEquals(new int[] { 5, 3, 2, 2, 2, 2, 3, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case89() {
    String[] roads = { "NYNYN", "YNYNN", "NYNYN", "YNYNY", "NNNYN" };
    int M = 4;
    assertArrayEquals(new int[] { 2, 2, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case90() {
    String[] roads = { "NNNNYYN", "NNYNYNN", "NYNYYNY", "NNYNNNY", "YYYNNYY", "YNNNYNY", "NNYYYYN" };
    int M = 6;
    assertArrayEquals(new int[] { 2, 2, 3, 1, 2, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case91() {
    String[] roads = { "NYYYN", "YNYNN", "YYNNN", "YNNNY", "NNNYN" };
    int M = 4;
    assertArrayEquals(new int[] { 3, 1, 1, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case92() {
    String[] roads = { "NYYNN", "YNYNN", "YYNNN", "NNNNY", "NNNYN" };
    int M = 4;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case93() {
    String[] roads = { "N" };
    int M = 0;
    assertArrayEquals(new int[] { 0 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case94() {
    String[] roads = { "NYYYN", "YNYYN", "YYNYN", "YYYNY", "NNNYN" };
    int M = 5;
    assertArrayEquals(new int[] { 3, 2, 2, 2, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case95() {
    String[] roads = { "NYYNN", "YNYNY", "YYNYN", "NNYNN", "NYNNN" };
    int M = 4;
    assertArrayEquals(new int[] { 2, 2, 2, 1, 1 }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case96() {
    String[] roads = { "NYNN", "YNNN", "NNNY", "NNYN" };
    int M = 3;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

  @Test
  public void case97() {
    String[] roads = { "NYNNNN", "YNNNNN", "NNNYYY", "NNYNYY", "NNYYNY", "NNYYYN" };
    int M = 5;
    assertArrayEquals(new int[] {  }, bestroads.numberOfRoads(roads, M));
  }

}
