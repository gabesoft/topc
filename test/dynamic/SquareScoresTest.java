package topc.test.dynamic;

import junit.framework.*;
import org.junit.Test;
import static org.junit.Assert.*;
import topc.dynamic.*;

public class SquareScoresTest {
    double DELTA = 1.0e-09;
    SquareScores squarescores = new SquareScores();

    @Test
    public void case1() {
        int[] p = { 1, 99 };
        String s = "aaaba";
        assertEquals(8.0, squarescores.calcexpectation(p, s), DELTA * 8.0);
    }

    @Test
    public void case2() {
        int[] p = { 10, 20, 70 };
        String s = "aa?bbbb";
        assertEquals(15.0, squarescores.calcexpectation(p, s), DELTA * 15.0);
    }

    @Test
    public void case3() {
        int[] p = { 10, 20, 30, 40 };
        String s = "a??c?dc?b";
        assertEquals(11.117, squarescores.calcexpectation(p, s), DELTA * 11.117);
    }

    @Test
    public void case4() {
        int[] p = { 25, 25, 21, 2, 2, 25 };
        String s = "a??b???????ff??e";
        assertEquals(21.68512690712425, squarescores.calcexpectation(p, s), DELTA * 21.68512690712425);
    }

    @Test
    public void case5() {
        int[] p = { 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4 };
        String s = "??????????????????????????????";
        assertEquals(31.16931963781721, squarescores.calcexpectation(p, s), DELTA * 31.16931963781721);
    }

    @Test
    public void case6() {
        int[] p = { 4, 3, 4, 3, 8, 2, 4, 3, 4, 4, 3, 2, 4, 4, 3, 4, 2, 4, 7, 6, 4, 4, 3, 4, 4, 3 };
        String s = "makigotapresentfromniko";
        assertEquals(23.0, squarescores.calcexpectation(p, s), DELTA * 23.0);
    }

    @Test
    public void case7() {
        int[] p = { 100 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(500500.0, squarescores.calcexpectation(p, s), DELTA * 500500.0);
    }

    @Test
    public void case8() {
        int[] p = { 1, 99 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(89209.52402946686, squarescores.calcexpectation(p, s), DELTA * 89209.52402946686);
    }

    @Test
    public void case9() {
        int[] p = { 1, 50, 29, 20 };
        String s = "??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????aaaaaaaaaaaaaa?aaaaa??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????bbbabbbccb??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????cccccccccc????????????????????????????????dddddddddd???????????????????????????????????????????????";
        assertEquals(1843.7907943416449, squarescores.calcexpectation(p, s), DELTA * 1843.7907943416449);
    }

    @Test
    public void case10() {
        int[] p = { 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0 };
        String s = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
        assertEquals(500500.0, squarescores.calcexpectation(p, s), DELTA * 500500.0);
    }

    @Test
    public void case11() {
        int[] p = { 1, 2, 2, 3, 7, 0, 17, 7, 2, 3, 2, 11, 2, 4, 14, 1, 3, 1, 10, 5, 3 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1103.0895334301772, squarescores.calcexpectation(p, s), DELTA * 1103.0895334301772);
    }

    @Test
    public void case12() {
        int[] p = { 15, 20, 30, 35 };
        String s = "???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????d????????????????????????????????????????????????????????";
        assertEquals(1393.3424032857401, squarescores.calcexpectation(p, s), DELTA * 1393.3424032857401);
    }

    @Test
    public void case13() {
        int[] p = { 17, 17, 15, 17, 9, 13, 12 };
        String s = "?b?ggggggggggggggggg??gg?ga??a?aaaeeeeeeeee?eee?eeee?f?ffffffffb?bbbbbbbeeeeee?e??ee??ee?eeee?eebbggg??g?gggfff?fa?aaeeee?eeeggg?ggg?gggggffff?ee?eeeee?ee?e??eee??eeeeeeeeee?eebbbb?b?bbb?fcc?cc?cccceeeeeeeeeeeeee?eccc??cdebbaa?aa?aaaaa?aaaffe?eeffffffff?fffffffceee?ee?e?eeee?e?g?gcc??g?g?g?gge??eeee?eeeeee??eeee?eeeeee?eeegaaaaaaaaggeeeefff????fffff??ffffff?fffbbbaaa???b?b?f?fa???a??aa?ag?a?aeee?bbb?bbbbcc?c?ccc?ccccggc?cccccc?c?ccgggg??g";
        assertEquals(1275.8299198346726, squarescores.calcexpectation(p, s), DELTA * 1275.8299198346726);
    }

    @Test
    public void case14() {
        int[] p = { 0, 0, 0, 50, 0, 0, 0, 0, 0, 50 };
        String s = "b?cfffjic?cicaeaihh??ifbb?dd?i??haabeee?de?i??i?cceggj?jj?ecaa?f?da?h?hf?ba??ad?ac?d??d?iggej?hae??add?dffbbbee?bghg?gge?aa?adcf?ffcbhhhhgg?dgeaaa?h?ee?eeii?jjji?hcgggg???i?ejjjcid?ic??c???jja?hf?a?ahhhe?eea??e?h";
        assertEquals(291.3125, squarescores.calcexpectation(p, s), DELTA * 291.3125);
    }

    @Test
    public void case15() {
        int[] p = { 3, 8, 6, 3, 5, 4, 6, 5, 7, 6, 7, 4, 4, 11, 5, 5, 2, 2, 4, 3 };
        String s = "????????b???b???????????b??????b??????????p????p????????????????p???p??p???p???????????p???????????????????p???????????????????pp?????????????????p??p???p????????????????????p????p??pp??????pp???????????????????p?????p?????????d??????m????m???????????????m?m???b?????????k??????????n????j?????????g??????g??g??????????????????g?????g????????????????????????????????????s?????????????????s??????gr???????i????nn?c?????c???g??????????g??????????n????????????????????????c???c??t?????t??";
        assertEquals(518.6243530789806, squarescores.calcexpectation(p, s), DELTA * 518.6243530789806);
    }

    @Test
    public void case16() {
        int[] p = { 11, 11, 1, 3, 2, 10, 11, 5, 8, 0, 0, 6, 4, 6, 7, 6, 1, 4, 4 };
        String s = "dd?ddrg";
        assertEquals(9.239999999999998, squarescores.calcexpectation(p, s), DELTA * 9.239999999999998);
    }

    @Test
    public void case17() {
        int[] p = { 18, 15, 7, 10, 10, 11, 15, 14 };
        String s = "de????cf????f?gd?d?gb??a????ga???b????ff??h??a?????h???aeah??b??aeh??b????aac?b??fcec??d??efe??e?gb????edcb?g?h????h?dhh???gdg???h?c??d?????c?db?fe?eg????d?c???aa?a????e??ea???a?c?a?cb?e?c?d?fcbfgb??h???gg??f?g?g????dfg??????d?d?c??g??g??c????da?ee?b??e??g?dbbb??dd????hccba??g?????e?c??????hdg?e????ef???h???ddbh?hd?????df?b?d??ee???fe?e???f???a???aa?c??bg";
        assertEquals(417.4204988795838, squarescores.calcexpectation(p, s), DELTA * 417.4204988795838);
    }

    @Test
    public void case18() {
        int[] p = { 57, 0, 0, 4, 31, 0, 5, 0, 2, 0, 1, 0 };
        String s = "??bbbbbbb?b???bbbbbbb?bb??bb??bb???bbbbb?bb?bbb?bbbbbbbbbbbbbbbbb?bbbbbbb?bb?bb?bbb??bbbbbb??b??bbbb?bb?bbbbbb?bb?bbbbbbbbbbbbbbb??bb?bbbb?b?bbbbb?bb?bbb??bbbbbbbbbbbbbbbbbb?bbbbbbbbbbb?bbbbbb??bbbbb???bbb??bb?bb??bbbbb??b?b?bbbbb?bbb?lllllllll?ll?lllll?l?llll?llllllllllllll??l?l?llllll?lllllllll?ll?llllllllll?l?l?ll?lllllll?lll?llll??ll???lll????lll??llllll??lllll?lll??ll?ll?l??lllll???l?llll??llll?llll??lllll?lll?ll??lllll?l?llllll?ll?ll?ll?llll?l?ll?lll?lllllllllllllllllllllllllllll?lllll??ll?ll?l?ll???llll?ll??lllll?llllllllll?ll???lll??lll?llll?llllllllll?l??llllllll?hhhhhhhh?h?hhh?hhh??hhhh?hh?hhhh?h";
        assertEquals(2282.352242199999, squarescores.calcexpectation(p, s), DELTA * 2282.352242199999);
    }

    @Test
    public void case19() {
        int[] p = { 0, 21, 9, 26, 24, 20 };
        String s = "???????d?a?aaff??f?fff???f?f??f??";
        assertEquals(46.706090763861106, squarescores.calcexpectation(p, s), DELTA * 46.706090763861106);
    }

    @Test
    public void case20() {
        int[] p = { 13, 9, 17, 8, 0, 1, 17, 1, 16, 4, 6, 8 };
        String s = "?dddlkllcf?ffcc?ced?djeaaaaai?aaaac?cc?b";
        assertEquals(66.39780000000002, squarescores.calcexpectation(p, s), DELTA * 66.39780000000002);
    }

    @Test
    public void case21() {
        int[] p = { 6, 9, 12, 1, 10, 3, 8, 13, 3, 11, 3, 14, 7 };
        String s = "gggggf?f?ffhfgffjccg?ghd?kilff?ffff?ll??lc??c??c?iiila?m?m?mmm?keellllbbii?iiimmm??mkkcaaddgggcbikkkkkk?d?ddddd?dila?ee?ehkk?jlbgdmmm?mdlla?aa?lleggd??dddee?ejiiggiekiiim?d?l?m?m?mdddd?d?dlkkkkkkggd?d";
        assertEquals(322.1367125763992, squarescores.calcexpectation(p, s), DELTA * 322.1367125763992);
    }

    @Test
    public void case22() {
        int[] p = { 1, 2, 2, 3, 7, 0, 17, 7, 2, 3, 2, 11, 2, 4, 14, 1, 3, 1, 10, 5, 3 };
        String s = "?klj?ehgn?n?c?f?naj??r???rune???aleemto?r??spmjguqrhttu?biq?q??rub?s?d?mpaktgb?dgkmt?koldem?asggl?ii??euq?hosu??lbendkc??l??b?mqk?tka????tk?qodb?f??j?mgt?p?i?k??h?ulh?ffcgfj?qrpdj?auqk?oac?smpijrbti?lod?l??jqrk?rhuqba??asi?ia?l??aern?mrifufr?bfuf?eukombm?cbbfulgl?lcflq?m?j?uccr?bujpf?hggs?ne?nund?qosu?????lm????kt?ahkpto?lsnq?jps??cihu?hhuus?ejrqnphr??qbdjenl?bh?mm?????t?akecbhopuhl?ps?c?gsct?ibposcnhkuslnn?emn?ishslnb?ijqbnhmnna???u?ltq?mmg?pfucpcsr??j?i?qjcufc?bolftros??a?dku?t?mldlmr?mq?pgkbhilp?htblbn?d?elgt??dgmgrqucnu?gch?sf?oc?h??m??giqunr?g??jghtg?c?c";
        assertEquals(593.2016755758827, squarescores.calcexpectation(p, s), DELTA * 593.2016755758827);
    }

    @Test
    public void case23() {
        int[] p = { 1, 6, 7, 19, 12, 11, 41, 3 };
        String s = "feghhb??bdb???bdaehacb?hdd?gafaf??dfgbae?hhdd?fd??gaaeecbhd?gaadbhaachghhhgaehgcfeabhhbadf?dgbc?fhee??aeh?c?cahehh?cbaaa?afdefg?aeaffe?f?ged?dhb?fdegebeh?cea?f";
        assertEquals(185.502474, squarescores.calcexpectation(p, s), DELTA * 185.502474);
    }

    @Test
    public void case24() {
        int[] p = { 3, 0, 12, 0, 1, 0, 5, 0, 12, 0, 0, 3, 0, 15, 0, 43, 6 };
        String s = "nn??n??n?a??f????????g?k???a?ooi?l????????n??o?b?b????e??q?????????b?od?????b??????????????????gi??o?k???????????k?f?f???m?a????a????????????a?m???????f?h??????h?????h????????????????ijjd??dd??de?????i?i?g?k?k?????k???g?e???n?????o??????????n??cp?????ccc?c?apn??fo?old??????q?????????qq?n??????????b????j??bo?????q??q????qkkb?b???g????q?d??????dp?g?q?q?????q?qq?q?????qg??????????q?c?c????g?????p?kd?????q??????ni???????i?cee???????bbb?d????p??ppg?g??g??g???????gg???g????g?g????gg??????a??e??????e?????a?a?f??f???f???f??????e?o????oqq???q?q???e?????????e????e?e?m???mm?j?add??dm????g???nn?nne????e?????e?????pj??j?????q?????q????qo????n?nmm????dd??d??????????j???l????????lch???h?m????q??h?????k??????????k??k???k??l?????l?l???l??????????m?gg???g??g???mm?????????h?mf?????j?j???jm??m???m?p?i????i????????i?????????q?????qf??????m???h?h?l?l???lddpp???p?dd??l???b?b???g";
        assertEquals(1075.7353521132477, squarescores.calcexpectation(p, s), DELTA * 1075.7353521132477);
    }

    @Test
    public void case25() {
        int[] p = { 0, 0, 7, 27, 0, 0, 8, 7, 2, 5, 1, 0, 0, 2, 0, 8, 0, 15, 14, 2, 0, 2, 0, 0 };
        String s = "?rr????????r??r??x??w?w??kd???????d???dd????x???????????v???u?jn??u???b???vx?x??g??g?ggvu?u???????uu???mr??????dvv???k???k?k????????kk??k???????????f??bks????s???????????s?????s?t?t??????q?q?q??q????p?pp?ppp?w??????w???p?pp??????p????p????j??d????g??g??l??t?j?j??qd????d??????????dc???????????x?????q?g???n???rm?mw???oo????opp?m?mk?k??k?j?m?????s???????f?p?w????f?ff???f?????f???m???l?????l?v????q?mm?????????mmgg?????g?g??g???g??f??f????";
        assertEquals(505.9340399725128, squarescores.calcexpectation(p, s), DELTA * 505.9340399725128);
    }

    @Test
    public void case26() {
        int[] p = { 7, 3, 3, 6, 6, 5, 6, 3, 5, 9, 5, 2, 0, 5, 14, 16, 5 };
        String s = "jgbapcngaiikomb??bqceeffqqqdhhhkjbaoj?hhhhhhpkjjhhoojbeep??qmqbedhhhaa?dpdgggneeahhnnmachdce??dfggg??q?i?mkggpffbbkkffcqfkkkmmp?eeodnoo?nfgg?ogagkddkajjke?blbfijjjm?kck?klloo?fjiiiqkkeiiqiq?qkddpeeci?dkkqqcnoqoh???hh?habafqqlehhjdqqoh?ppb?qq?qpblmnk?k?oall?jfefdkddllppnpnnhnn??bfggpg?q?qj?jdfppicceeeedaemnfqcccqddjllbmh?okaamg?p?cfnffbbbbelhbocfffdnbbp";
        assertEquals(467.379091239999, squarescores.calcexpectation(p, s), DELTA * 467.379091239999);
    }

    @Test
    public void case27() {
        int[] p = { 8, 4, 6, 11, 18, 1, 6, 7, 8, 5, 5, 4, 8, 9 };
        String s = "g?n?ni?kji?i?n??e?gjjkhg?hgkfiifkjfab?gg??nj?fkndhmmk????k?m?gcbbg?agcchgmeamjc?dk????eeadjkkegc?chiige?egj?hi?cmgggij";
        assertEquals(135.11400483500006, squarescores.calcexpectation(p, s), DELTA * 135.11400483500006);
    }

    @Test
    public void case28() {
        int[] p = { 17, 18, 23, 20, 22 };
        String s = "d?????????c?b???be???e?e?e?ed???aa???a??aa??????aa??????d?a??c?????abcaa?e???b?e?b??cc?cee?e???e???????e?e???ed?d???c????cc??c?c?????b?b??bb??b???b?b??bbd?d??d??d?a??ddd?????c?b??be??e???d????dbb?????b?c?cc?c????c????eeea?a?aa?a???a???????bcc???????c??aa?aa???e??e?ee???a?dc??c?c?cee?ee?????ee???e?b??bc????????c????c?????c??cb??b???aa?a?????b???b?a?a?c????b?c??ca???????ac?c?c??c???????????cc??ccc?????e??bb????bb??b?bb???b?bec?c??c?ccc???c?dd???d?c?c?????b??a?a??bb??????b?a????accc?????????c?c???c??bbbd??e?b??b??c????????eed????b??b???d?d?b??e??ee??????eee?????ecc?????cc???c?c???c?dee????e??e??e???ee?cd?cda?aa???a????aad?dd?d?????d????d??dd??e?ee??ee?aa?d?????????????a?a???????ab?d???c?d?e??e?e?d????ee??a??a??a???a????a???aaa?a??cc?c???c??c?c?cc???c??c????eece???????e?????a?ee???e?aaac??c??????????????cc?eeeb???b??????????b?????c?cc???cd??daa?a????a??d??dddd??e?eab?bbcc?d?d???d????d??????b??b?????bb???b????";
        assertEquals(1256.4296282614887, squarescores.calcexpectation(p, s), DELTA * 1256.4296282614887);
    }

    @Test
    public void case29() {
        int[] p = { 6, 6, 2, 4, 0, 15, 2, 4, 12, 8, 0, 0, 0, 4, 7, 3, 3, 2, 0, 5, 4, 1, 1, 11 };
        String s = "ggg?ggcf?f?ffmmq?q?hhhhhh?g?hk?kkiiii?iiihfffg???g???gt?tjjnnnjj???j?j?jjcxxre??b?w?wrrjdd?d??jjjjjj?ju??oowu?u?uu???c???c?cee???e??ee?e???eeii?inddr?r?j?jj?qqq?qqll?vvvk???khnl??l?l??wwwwwojfbbd??h?h??g?g?urv???v??vvqq?kkj??v?v??v?lll?g?ggg?ddallll?a?uuu??us?r?fn?k?k???k??o?o?o??o?uu??uutttn?i?ssspp?xx???xx?x?ghbe?edddd?hmh?xx??w????nllb?v?rbbb??e?eee?uuupprrq??q?q?qqe??e??e??o?oqnngq???q?q???q??e??k?i?pp?ppp??ddm???????g??ggggppkkkk?xgrv?ve?eg?ufftttvpssa?bbb?b?bbna?a?axfb?b????b?bam??m?m??ii?tvvitt?ttttfffll?lnxx??e?ans??ssddh?hk?kn?nnb??bb?b??aaiitl?ll??";
        assertEquals(776.1974145249136, squarescores.calcexpectation(p, s), DELTA * 776.1974145249136);
    }

    @Test
    public void case30() {
        int[] p = { 100 };
        String s = "a?aaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaa?a?aaaaaaaaaaa?aaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?aa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?aaaa?aaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?aaaa?aaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?a?a?aaaaaaa?aaaaaaaaaaaaaaaa?aaa?aaaaaaa?aaaaaaaaaaaaaa??aaaaaaaaaaaaaaaaaaa?aaaaaaa?aa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaa??aa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa??aaaaa?aaaa?aaaaaaaaaaaaaa?aaaaaaaaaaaa?aaaaaaaaaaaaaa?aaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaa?aaaaa?aaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaa?aa";
        assertEquals(380628.0, squarescores.calcexpectation(p, s), DELTA * 380628.0);
    }

    @Test
    public void case31() {
        int[] p = { 18, 17, 7, 11, 14, 18, 15 };
        String s = "??????????????e??e????g?gcccd??????????d?????????b?????a????d????????d????c?d??????d???de?d???ag?????g?g???????g???g?????????????cc?abccce?e???c??cc???????????c??d????a????a???c?b?e??e???c????c??c??c?c?????g??g???e?e????e?e??????????e??????????ed??ee?????e?a??a???ddda??ac????c???c??????c????a???f???????d?????eb?????b?b????b??????????b???????cce????ed???????d???dd????d??d?d??c????????????????????c???????????????????a?????????a?aa?a????????????????????a?????a???ad???????????????????d??d???????????daff?af???????fg??????????c??????a????a???????a??????????????g????g?fg?g??c??c?????????????????c?????????e???????";
        assertEquals(731.8159123758453, squarescores.calcexpectation(p, s), DELTA * 731.8159123758453);
    }

    @Test
    public void case32() {
        int[] p = { 45, 20, 21, 14 };
        String s = "???b??????????bc????c????????c?c???????????????????d??d?????????????????????????d?dd?????bc????d???????a?ba???ac??c?c???????c??c?d??d??add??d??????c????????????c???c????c???????c?d???????????a???????b?b??b??b?????bb??????????????d????????????????a?aa?a????c???????????c?????????????bc???aa?aa?a?b?????????d???d??a??????b???b????????a????????????????????a????bb??????aadc???c????????????a??????a????b?b????b??d????d??b?????b????bb???????????b????d?????a?????????????????c???????????????a?a????????d?da??????a??????????b??????????d?d???dd???dd?d???????????bb????a?cd??????d??????d?d????bccc????a???a?ad???d?c????d?????????c??cc??????????b?????????a?ad??????????d???d????????????d????????????????????????????????d???a??????????????a??b??????c??????????c??????????c?????????????????a?ab????????????b????b????bb?b??c???b?b??????b?b?????ad???b??????????b????a?????a????????????b?b????????????b?b????????????????????????aa???";
        assertEquals(1348.9799428725883, squarescores.calcexpectation(p, s), DELTA * 1348.9799428725883);
    }

    @Test
    public void case33() {
        int[] p = { 6, 94 };
        String s = "b?b??bb?abab??b???bbaaa???b?b???aaaa??bab?b?bb??bbbba?a?ab?????????a?a?ab????bbbb?b?bbb??b??b???b?ba??abbaaab???a?a??a?b?bbaa?a??aaa????bbba?ba?aaaa??bbba?a?a?bbb??bbaaaa?ab?b?b?aa?baa?ab?b?a?aaa?ba???b?baa?b?aa?a??bbbb???bbaabbba?abb??bbbb?aaa?aaaaa?bbaaaabb???bbb?bbb?bb???b???b?bbb?b??babb?b?b?b?baabaaabb?bab??a??ab?b?????bbaaba?abaa?";
        assertEquals(1486.3479292015522, squarescores.calcexpectation(p, s), DELTA * 1486.3479292015522);
    }

    @Test
    public void case34() {
        int[] p = { 37, 29, 34 };
        String s = "ca??accb?b??bbb?baccccccaa??a??cc?ccab?bbaaaaaaaaaaba?acaaacacb??b?cab?a?bbbccc?c?cccabbb??c??bbcacccc?cc?aaab??bba?bcbbbbabacba??aaaa?c?bbaa??bcacc?baaaacaaaaaa?a?a?aacbb?b?b?cbaa?acbc??aa?bc??caaaac?b??bccc?aa???aaa??bccc????aaaaaaaa?aaccccc?aaaaa?caaa?b????c?b??bccaaab?bbbba?b??a?c?a?ca????aacccccc?c?c?abbac??cbba?aaa??cc?cc?a?b?baaccc?b????a?aaa??aabbbb?b?a???a?acbc?b?b?caaac??bcc?b?bbb?aa?baabaa?a?bbaabcacb?b??b?a??aaaa?b?bbab?c?cca?a?aa?aa?a?b?aaabbab?bbcccbac?bb???cabbbccccbccbbbba?a???aaacc?cacbcccca?aaaabbaaa???bbb??bbab??c????c??cb?caaaac?cb?c?cba?a?a???ccc?a?ccbbac???cbccbbc?cbaaaaa?cb??bbcaaabb??bbba?ac??cc?ccc?c??cccab?bb?caaaaa??aa??aa?????ccbaa?a??a?bb";
        assertEquals(1336.743709457849, squarescores.calcexpectation(p, s), DELTA * 1336.743709457849);
    }

    @Test
    public void case35() {
        int[] p = { 18, 18, 22, 29, 13 };
        String s = "??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????e??????????????????????????????????????????????????????????????????";
        assertEquals(235.9181165893461, squarescores.calcexpectation(p, s), DELTA * 235.9181165893461);
    }

    @Test
    public void case36() {
        int[] p = { 0, 0, 0, 0, 19, 0, 0, 20, 20, 0, 0, 0, 17, 0, 0, 0, 24 };
        String s = "????q??????????????g?????????????";
        assertEquals(40.675949097012406, squarescores.calcexpectation(p, s), DELTA * 40.675949097012406);
    }

    @Test
    public void case37() {
        int[] p = { 8, 0, 16, 0, 5, 12, 3, 5, 6, 8, 1, 5, 10, 21 };
        String s = "hhhhb??aaggneee?eeacnnne?ee?ef?fffjdddcl?hgl??ll?lfjhdimkkkkfdmff?nn?h?hh?hbk?ccdd?d?ddn??nmcffddb?b?knlj?l??lii??heeedbaiiicnbeejd?ddmd?i?k???l?bbbbhheedgbbnlllmm?mmh?af?ffkg?h?eljj?j?eedhhbi??liiiiilfmmm?bh?h?h?hhhk??l?llekaaa?agdnnnlfff?ill?ll?";
        assertEquals(351.14946126000075, squarescores.calcexpectation(p, s), DELTA * 351.14946126000075);
    }

    @Test
    public void case38() {
        int[] p = { 6, 0, 2, 7, 2, 6, 12, 3, 4, 3, 0, 5, 6, 5, 7, 4, 4, 2, 3, 5, 6, 4, 4 };
        String s = "???????????????????????????????f?f??????????q?????????????????????????????????????q???????????????????????????????????????????????????q?????????????????????????????????????????????????????????????????????????????????????????????????????????q???????????????q????????????????????????????????????????????????????q????????????????????q???????????????????????????????????????????????????????a???????????????????????????????????o??????????d?????????????????????????????????????????????????????????????????????????????????????????????????d?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????d???????????????????????d?????????????????????????????????????????????????????????????????????q????????????????????????????????????????????q?????????s??????????s?????????????????????????????????????????????";
        assertEquals(929.2481952481833, squarescores.calcexpectation(p, s), DELTA * 929.2481952481833);
    }

    @Test
    public void case39() {
        int[] p = { 3, 13, 8, 1, 3, 6, 1, 2, 3, 0, 4, 2, 0, 7, 2, 3, 7, 8, 5, 7, 9, 1, 5 };
        String s = "?v????g????????h???h?hv????v??????????????ff???????w????????????????d?o????hm?????????d?????m?????r???r??ff???n?????????????????????r?????u?uu???u??u?????u??h??k????????????????????kk?k??qo????????mm????j?j??bbt?k????b???bh?????eb?r???n?d?????????????????????????????e??o?????????u???o???s?????????????h?????i?d????vv???d??r?d???d?????????r????r??p????u?????u????l????a???f??v???tt????????t???e???e??e???rj?????d??tt?t????me?????????????";
        assertEquals(474.4972151227298, squarescores.calcexpectation(p, s), DELTA * 474.4972151227298);
    }

    @Test
    public void case40() {
        int[] p = { 8, 2, 16, 1, 10, 8, 3, 8, 4, 5, 1, 6, 5, 6, 9, 8 };
        String s = "??k???????????????????k??????????p??h???m?k?????????????m?????????c?????????????j???b????????????????f???c??????????????o?p????????p???????h????????????????l?????????ngc?????c?????cc????????????????i??d?????????????????????????????k???????????????????k??c?e?????????i???????????????f???f???????????????????????g?c???????????dd??????????????d????n?j???????????m?p??????h?????????b??????b??????????f?g?????????????????????f???dd????d????????????????????????d????p??n?n???o?????????????a????????e?????????????????????b?????????k?????k??o?????????????????????m??????????????b??????????????????????????????k???h?????????j????????????????????????a?????????c?hf?????????????????n??o???????a?a?????????????????????ol?????????????????g?????";
        assertEquals(799.1033259308307, squarescores.calcexpectation(p, s), DELTA * 799.1033259308307);
    }

    @Test
    public void case41() {
        int[] p = { 7, 7, 9, 10, 8, 9, 9, 7, 16, 9, 9 };
        String s = "???ci????bhh??k?k??j???????????f??f??i?b?????aa?ichh??????i?e??ab?b??b???bcc??h???j?k?k??????ib?????????gg?ff?ih??i??e?j????g???eii??????ii??j?jee??e????a??????cb??b?gj?j????j?????j?jggggg??g???ggda????ai??f??e?????e?b?c?c?e???????????????ek??e??????????ff?b???b??c?j??jaii?g???c?k??kj???h?????i?j?e?????????d?c?i????e?c???????j?d??????d?k?";
        assertEquals(396.61433014552495, squarescores.calcexpectation(p, s), DELTA * 396.61433014552495);
    }

    @Test
    public void case42() {
        int[] p = { 3, 1, 5, 23, 13, 10, 2, 10, 1, 4, 8, 10, 8, 2 };
        String s = "??????????gd???????????????m??????k?????????????????k?????????????????????e??????????????????e????e?????????????????????????e???????ddg????????b?b????????????????b??b??????????????????????????????????????????????????????b???????????????bm?????m????m??????????????????????n??????????????g????????????????i??m??j?????????j??n?nn???????????????c????????d?????????????g????????????????????????????????i??????????????????????????????i???i??????i???????k??????????????????????????c????????????????????????????????c??????????????c?????j??n??f??ih???a?a?a???c??????c????e????";
        assertEquals(640.7340240364689, squarescores.calcexpectation(p, s), DELTA * 640.7340240364689);
    }

    @Test
    public void case43() {
        int[] p = { 8, 3, 9, 9, 9, 16, 1, 16, 4, 5, 6, 14 };
        String s = "????ea?????????????????????????????????????f??????????????????????????f??f???????f?????????f????f????????d???f??????????????????????????????f???e?????j??????????j??????j?j???jj???j??????j???????????????????j???j?????????????????????????????ig???g??h???b?????????????????????????j???????????????????j???j???????????????????????????????j???????????l??a???????????????????????a???????f?f??????????????????f????i????i?????i??e?d??????b????b???????b???????i???i???d??d????????????????e???????????????e?????e???????????????e???ee?????????e???e?e????i??????????cj??j?j??k?k???????????a?????????????????????????????????????????????????????????????aa?????????????????????ad???????????????????????????";
        assertEquals(776.5293121725329, squarescores.calcexpectation(p, s), DELTA * 776.5293121725329);
    }

    @Test
    public void case44() {
        int[] p = { 7, 17, 28, 9, 0, 23, 16 };
        String s = "a????a????????????????????????b?f????a???d?c????????c??????b??????f???d????????b?b???g???c??f?g??a?????d?????df?cc???c?c?f?f??????????????????f????ee?????a?cc?g??????????a??????a??a??f????????g?????????????c??????????b???????a????a?g??????????????????????????f?a?d???ea??????f???????????cc?????e?????????e????????e?b????????cd?????????g????????b????????f???g???e?a??a?d???e???cd???ed?????d?????????f??d????e????e????????????eed?????????b?b?????????????????b???c??c??b???c????gg?g???g???c????????????a??????????????g??????????d??????g?";
        assertEquals(663.680625001737, squarescores.calcexpectation(p, s), DELTA * 663.680625001737);
    }

    @Test
    public void case45() {
        int[] p = { 13, 8, 12, 13, 23, 13, 18 };
        String s = "??e?c?c??cc???e?e?e???gg????b???bb???b???b?????????a?cc???cf?f??f????????cccc????????c??cc???cc??c???c?c??c??c??f??f???f?????????f???ffg?g??f????ff??????????????d???d????d???b?bb?b??????bb??b??????b??b??b???a???a??????a?a?a??a??a????????????f??f???f???????fa?ab?b?bb??a?a??????????c??????c??c??c??c????gg?g???g?g??e?????????b?b????bb?????????????????????bb??b?b??b??b??b??g??????????b?????b?bb???????bbbb?e?e?????????e????c??????c???c????c????c?c???cc?c???c?ca?????a?d?????d???????ddd??dd??d????????dc??????e????e?e?????e???????e?????????????????e??e??c??ccc??f???????????f????ff?f??f??f???ff??f???????????f??ff??ff????ff???????f??f?f??f?????fd??d?d???d??d???d?????????????g??gg??g??????????g?g??????dd?d????dd????d???????d????d?d?d??c?c???????c????c??c?c?????";
        assertEquals(942.9317271437236, squarescores.calcexpectation(p, s), DELTA * 942.9317271437236);
    }

    @Test
    public void case46() {
        int[] p = { 1, 2, 10, 5, 2, 3, 2, 7, 1, 1, 3, 3, 7, 1, 0, 4, 3, 5, 3, 3, 15, 2, 13, 4 };
        String s = "???????c?cwl?h?????lg???x??h?xt????????????d??h??q???????q?ql?????b?c??????m????a???n??c??mww??mfr?????e?w????w???m??q??????o?????h?h?h????kga??????a???amc????????c??in?????njnn?sp???p????????n????f????ii??uccaaemd????l????????????ll???l?l?h??oo???o????i??k??f???f??i??fp?????????????g???kl?ao???????tt??tb??dng??t?xxx???n????????h?????????????????????e??????k??s????u??k???qk?k????????????w?qv???o?s??????s??g?v?????????h?????x???e?k??u?????us???r???v?????b????????????bl?bee????????o????xxn????j???j?????j??gi????f??????x???n??s???l?r??????np?c?m????????xwu?u??uvw?vgl?f????????ti???i?????w?in???????o???????h???????tum?????c????l?mgq?qo??????????w??i???eq?a????x?x?u????dga?r?c?tki???pt????????av???rs???????s?q?????a????d?d??u???????d?????u???q??????????u?n?";
        assertEquals(823.5183561146489, squarescores.calcexpectation(p, s), DELTA * 823.5183561146489);
    }

    @Test
    public void case47() {
        int[] p = { 26, 1, 8, 4, 14, 7, 19, 9, 12 };
        String s = "??????????h?h??????????????????a??????????????c????????h????????????hh???c??";
        assertEquals(90.84444690603519, squarescores.calcexpectation(p, s), DELTA * 90.84444690603519);
    }

    @Test
    public void case48() {
        int[] p = { 24, 1, 0, 1, 0, 27, 1, 14, 0, 5, 0, 0, 17, 0, 0, 0, 0, 3, 5, 2 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(128.66493079310686, squarescores.calcexpectation(p, s), DELTA * 128.66493079310686);
    }

    @Test
    public void case49() {
        int[] p = { 11, 23, 0, 0, 3, 0, 2, 17, 16, 23, 0, 0, 0, 0, 0, 0, 2, 0, 0, 2, 1, 0 };
        String s = "kkkkkkkkkkk?kkkkkkkkkkkk?kkrrrrrrrrrrrrrrrrrvvvvvvvvvvvvvvvvvvvvv?vvvvvvvvvvvvpppcccccccccccccccccccccccccccfhhhttt?tt?tttkkkkkkkk?kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk?kkkk?kkkkkkkkkkkkk?k?k?keeeeiiiii?iiiiiiiiiiiiiiiiiii?iiiiiiiiiiiiiiiiiiiiiiii?iiiiiiijjjjjjjjjjjjjjjjjjj?jjjjqqqqqqqqqqqqqqa?aaaaaaaaaaaaaaaaaaaaaaaaa?aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaahhhhheeeeeeeeeee?eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee?aaaaaaaaaaaaaaaaatttttttttttt?ttttttkkkk?kkkkkkkkkkkkkkkk?kkooooooooooooohhhhhhhhhhhhhhhhhhhhhhh?hhhhhhhhhhhhhhhhhhhhtttttttt?ttttttt?tttttttttttttttlllllllllllllll";
        assertEquals(6409.326007999998, squarescores.calcexpectation(p, s), DELTA * 6409.326007999998);
    }

    @Test
    public void case50() {
        int[] p = { 7, 0, 25, 10, 5, 0, 2, 4, 12, 0, 4, 5, 8, 10, 1, 0, 3, 4 };
        String s = "nf?bpp??qljg?p?rqnnf?l?a?df?jji??iicjkj?l?qae???iccio??lc?hap?qn??ikkkkhnn?e?hhpppp?e?ghffmg?df?f?gq?e?een?r?n?n?e?ebhhqcbp?qbljed?f?jj?jjqfddnck?bfg?hhl?cendahkjkk?ii?f?opccrjkng?eq???abee??jjnll?lg?bogb?cahgjo?qrcj?da?ccddqr?gllll??raaa??pb?mapjmqpackik?qjf?r??li?lk?c";
        assertEquals(322.15045900000086, squarescores.calcexpectation(p, s), DELTA * 322.15045900000086);
    }

    @Test
    public void case51() {
        int[] p = { 0, 0, 5, 0, 31, 18, 10, 11, 11, 0, 1, 5, 8 };
        String s = "eee????????kk????kkk??k???ke?el?l?????cc?c?b?b?bb?b?????bh????h???hh?d?d?i????jhc????cce?ff?f????ff???f?gf????fll?l?lf???f??f?a???a???a???a??????d??eeem?ddd?d?d?dj?l?l??cccf?ff????fff???g?gkd???mmm??m?d?djj?j?jjj?ji??ii?i???i???iii??ii??g??a??????a?h?k??????f??????ffff??f?f?f????fb??b?m???mm?mh?lkf?????f??f??kk?k??c?g??g??d?d??dd?d?mm????m??m???m?gg????g????ggg?g????g???gi??iff?ff??dd?d?d??ahh?ff????f?b??j??j???j?ff?j??mkkkk???lm?j???jj???jj?j??j??m?m??d?c??b??bb??b????i???i?i????i????ii?i?ff?b???b??b?bi??i??i??d????dd?d??d??dd?dc??e?ii??i????ii?i?id?dd?gb??d???d???ccccc?cc?l???ll???????l??j?bb??????????bbb????aa?gj?jj?????je?????eelcc??c???ddj?j?jj????j???f?f???????f??j?jj???j??jjj??j";
        assertEquals(885.5259600692015, squarescores.calcexpectation(p, s), DELTA * 885.5259600692015);
    }

    @Test
    public void case52() {
        int[] p = { 13, 14, 34, 0, 14, 25 };
        String s = "eeeaaaafbb?bb??bbbcccccceeadfaaaaeddddddd?d?dfe?a?bbb??bebaaacccccadddf?ccceee?c?cddddd?ddeedddaddd?dddefa?eeedaccfaaaaaaaace?ffffff?d?beeeee?e?aabbbbbb?ff??feeccc?f?e?ddd?ac?aaaadddd?ddc?c?c??cbbbedf?d?cccc?bfffffffffffdbcc?ccc???ccaaaa?a??adddddddd?ddcc???fccceeed?ddd??ddaadff?ff?a?aacc??cdfd??ddd?dddbbbb?baaaff?aaaaaaaaec??ceeeeeb?acfadddceeebbbaaaaff?fffcc?cceaaaa?aacc?caaaaffff?fccccc?caaaeeeeeeeeeeed?ddddeeeaaaae?f?fcccccccbbbbbb?aaa?aaaaaaadd?dd?ddff?fff??ffc?cc??ccccceeaaa?aaa?aaffff?ffff?f?a??a?b?caaaaaaaacbbbfddaccc?ccad?d?ddeeeaccc??c?caaaaacc?aa?afffbcc?ccbbee?ee????eeeeceddddeeeeeecec?cccceeeee?eeee?eeeeeeeeeeeeeeeeee?ceeee?eeeaee?ebb?b?ba??add?acccccbbbbbbaa?aa?a?e?eebeeaaaaccce?ebeee?bbbd?d?dddd?d?f???d?d??c?cffffeef?ff?fffffc?bbbc?eeeeeeeee???eeaaaaaa?aaa?aacdddccc??ccc?ccc?ceee??eeee?cc?caabccea?aaa?abbbb?cc??ffffbb?b";
        assertEquals(2075.6704678960014, squarescores.calcexpectation(p, s), DELTA * 2075.6704678960014);
    }

    @Test
    public void case53() {
        int[] p = { 7, 9, 5, 12, 11, 3, 2, 5, 4, 0, 8, 12, 7, 5, 4, 6 };
        String s = "???p?ab????f?????f???f???????????????nn?????i?m??mmmm?a?ff????f????????jl??m??????????m??m?il??n?ff?fg??n?n???f?fg??????o??????o??oj??pj?j??a?????a???fm?n??nn????dd?k?od?l?????pc????i???i??c?l?e?ee??m?????mhe??e?j???j??h???e?g?o??g?g??l???????l??in??be??e?e???n?o????????k?k?????ko????????ocj?e?????g?????????????oo???obo??c??????j?j?n?o???????????oi???????i?????n?p?e??a???????a????o???odg??n?ncjl??ni?????????cc?p????l?p???p???p??p??????fcl?????l??????nb??be?e??b??b??h???o?lg???ig??com?m?????ll?????l??p?p??????p???pf??ll????l?hd????de??ee?n???n??p????g???????cd?????????d???l?????????doo?il???l?i?????????i?eo?o????fe??gnn??n????do??????g????bl??l???????c????a??aa???????h??f??b????l??????k????????c???n?e???nff????mp??????k???????c?dc??????????ccp?ff?je?hk???kf?????a?i??????????e????ba?????am??c?c???a?dd???j?????g????????????????g??g??pl????jo????p?j??????o???cj??dod??????m????????????j?b????b???c???c";
        assertEquals(1001.9506422891415, squarescores.calcexpectation(p, s), DELTA * 1001.9506422891415);
    }

    @Test
    public void case54() {
        int[] p = { 66, 34 };
        String s = "???bbaaabb??ba?ab?b?bb?bb?aa?a?bb?a??b?bbbaaa??aa?ba??ab???a?baa??a?a?b????aaaaa?a?ab?b??bbbbabbaaaba?abaaaabaa?a???aa??aa??aaaaabbb?bbba?aa?aa????a?abb???baa?bbbba??abb?bbba??????a?aa?aaaab?abbb?bb?bb???aaa???aaa?aaaaaa???ab??bbbb?b??b?bb?bbbb?bb?b??baaa?b???a?aabbab?a?bba???aaa??aaaaa?aa??b?aa?a??a?aa?bb??b?bba??a?aaaaaaba?aaa?a?b?b??aa??a?aab?????bbb?baaaba??ab?aaa?a?b?bb?bb??b?bb?babb?bb??b?bba?bbb??b?b???bbaab?bbbbaaa?b?aabbbababbaa?abbbbbb??bb???bbbbbbbaabbb?ba???aa??aabbb?aabab?b?baaabbb?b?baa??aa?bb???aabaaa?abbbba?aa??aaaa?b?aa??ba??b??b???baa???aa??abb?b??bbbbb?bbb?b??baaaaaaaa??a?a?bbbbbb?b?baa?a??a?aabb??bbbb?b";
        assertEquals(1722.1484373797473, squarescores.calcexpectation(p, s), DELTA * 1722.1484373797473);
    }

    @Test
    public void case55() {
        int[] p = { 0, 100, 0, 0, 0, 0, 0, 0, 0 };
        String s = "db?c???cfffe??ii??ighf?f?aafb??d?e?d??dhd?dde?ccaaeef?aacccaec?cibeb?f?iggfd?c??cdaag?hff?c?cghh??hadgh??eef??e?g?bi?hh?dbeb?h??d??bbia?c?ce?dd?ebg??gid?g?e?h?c??gc??d?gaih?he?f?bb?h?aii?f?hh??di??c?adii??b???a??df??fbg?fh?fiaaad??fagghcgaggchh?h?a?dba??hha??aecd??aeib??cceigfef?b?eei?cha???a?g?eehiec?bbi?edefaic?fgd?g??aa?aaf?daaac?d?hg??igeg??hdfi?i??eehb??ba?ggeg?h?hfdhfhf?fd?f???if??fff?fgh?iafiaiiida??b?e?e?ee?d???bb??b?bffgg??gffdai?ga??aib???ddc??ab?ddba?de??dd?i?iff?e?hgggdg?hig?bg?gace?eid??f???ec??cah?de?df?ba?b?hhi?ffghfef?eg?ih?hid?e?i?igfi?ie??b?h?h??g?g?d?da?a?bbb?ihibb???d??gchhh?bg?iidc?ihaa?bi?dgbeighb?acc?da??gia?dfaa?ad?????ia??hfc?ac??bc??bbiaei?iii?g?igaif?bcdif??fhbehg?daih?d?a?ce???d?dh???ghcdba?d??b?b???aehg????i??c?id?d?ddff?hee?ia?fhacfb?ahcchdg???ic?e??eff???g?gad??ff???ib?i??eh?cahe??f?fiee??e?e??i??";
        assertEquals(1182.0, squarescores.calcexpectation(p, s), DELTA * 1182.0);
    }

    @Test
    public void case56() {
        int[] p = { 1, 40, 0, 11, 48 };
        String s = "aa?ab?bbb?bccc??cb?bd?a?add??db?cccc?ce??eaaaaea?aa?aad???ddccc?eee?e?eee??aaa?a?cccaa?e?eee??abb????bee?eeeeeee?e?edccb?ee??e?eabb?b?dca?ddd?bbbb?b?????b??bbbbaa?aaa??a?aaaaee?e?eadddbbaddddd?dccc?aaab??c??????c??c?c?abbb?bbdcc?bbbbbbbbb???bbeeeaaab?ba?e?abb?bcaad?dd?b?bb?aaa?ddb?bc?cddd?dddceeeeeaaa???ab?bcbc?caaa?aaa?bb?b?bbc?ccae??ecc??aa?a??e?b?b?aaaaa??dd?d??d?ebbbb?aad?daaee?ddd?a?a?aaca???a?aaaaeb";
        assertEquals(796.2044727317872, squarescores.calcexpectation(p, s), DELTA * 796.2044727317872);
    }

    @Test
    public void case57() {
        int[] p = { 10, 11, 11, 5, 14, 7, 17, 14, 11 };
        String s = "cc????c?c?????????????????c??????c?????c??c??????????c????c?c?????????????c????c????c????c???c??c???????c??c???cc???c??????c?h?h????????????????h??h??????????????????h??h??h???????????h?????d???????d???dddd????dg?g?g??gg????ggg???????????gg????gggg??????g???g?????????gi????ic????cc?cc?a??a????????????????????a??a??a?aa???????????????a??a??a???a????aa????a????a???????a?aaa?????aa?????aa??aa?????????h??h?????h???h????????????????h??h?????h?h?h???????hh?????h??????h??h???h???????????h????h?h?h???????????h??h?h?h?h????hh??????h??h?hh????hh??????????h??????h???h???i??i?i?i?????????iiii????i??i?????????????ii?i?????ii?????i????i???i??i???????????ii??????ii??i?i???i??????????i?????????????i??i???????i?????????????i?i??";
        assertEquals(872.6151270044576, squarescores.calcexpectation(p, s), DELTA * 872.6151270044576);
    }

    @Test
    public void case58() {
        int[] p = { 8, 2, 19, 1, 11, 9, 16, 6, 7, 13, 7, 1 };
        String s = "lllllll???llllkaa?aaahhhggjjkkk?kk?cccccc?cccccbbbbb?bbbh?hhh?jchhhh?hhiiib?";
        assertEquals(180.379575, squarescores.calcexpectation(p, s), DELTA * 180.379575);
    }

    @Test
    public void case59() {
        int[] p = { 3, 1, 7, 5, 7, 8, 3, 4, 5, 2, 8, 1, 6, 1, 0, 2, 12, 3, 1, 12, 2, 0, 4, 3 };
        String s = "?g?p????????kp?mm???l??c???????????l??v??????????r?????ij?fq???v??????c?c??????ekss?d????d??????????c?d??vg?agt?????tl?sg??jt?????t?????lnr????a??a?d?ggk????p?pln????u??m??g??q???s??b?o????h???h??g?qh??h??u??u?m?vh????v?cks???l??m??uqmd???o?o??plb????k???m?xam?n?vu??gh?tv??nrf???h??b???????x???xh??p?a??a???f?rh?ct??pp???????h?k??l??gr??j???s??d??????????c???????p?q?n?????n???m???????????l?????ew????w?o?????????j???h??eo????x???t???t?km????jw????aq?w??????m????u???fx?xd?ls?s???bih??????dqwp?????vc??a?s?????c???w?l?t???s????????t???qonw????p??vrqews??s?????????uu?u?????f???i?????n?p??v??lb???a???w?????????w????j??m??u?w????vukg??hh??h?????v?p??????oa?????h????????c???r??j?f??????if?c?c???l??r??x????ro?????????f?u?n?????fsk?d?f??vutum???sv??ij??g?????v??v?s???f???dcr??????n??gj?k?";
        assertEquals(834.956924255197, squarescores.calcexpectation(p, s), DELTA * 834.956924255197);
    }

    @Test
    public void case60() {
        int[] p = { 8, 12, 20, 13, 6, 19, 18, 4 };
        String s = "?d?dd??dd?d?d??dd??dd?d???ee???????eehhhh?hd?d?dd?df???f???f?????ffddc???c????c???c?????c?????????c?ccc??c?cc?c???????c?????c????????c??cc?????cccc?c???c?c?c??e??e???e?????e???e??e??????e?eee???e???e?e??hh??h?hhhhhhbbeeeee?ee????????e?e??????ee??eee???";
        assertEquals(360.85677360911416, squarescores.calcexpectation(p, s), DELTA * 360.85677360911416);
    }

    @Test
    public void case61() {
        int[] p = { 24, 24, 6, 5, 5, 2, 1, 9, 17, 7 };
        String s = "???e???????ii????????????????????????????ii???????i?????????????????????????????i???????????????????????????????????i????????????????????i??????????????????i??????????????????????????i???????????????????????????????????????ii?????????????????????????????????i????????????i???????????????????????i???????????i????????????????i?i??????????????????????i???????i?????????i???????????i????????????????????????????????i?i?????????????????i????????";
        assertEquals(536.5274923794661, squarescores.calcexpectation(p, s), DELTA * 536.5274923794661);
    }

    @Test
    public void case62() {
        int[] p = { 45, 55 };
        String s = "bbbbba?abaaaaaaabbbbbbbabbb?bbaaabaaab?baaaaaa?aaabb?bbbbabb?bbabbbba?a?ba?baaabaaaaab?bbbbbaabbbbaaabb?baaaabaaaaaabbbbaabbbbaab?bb?baaaabbaaaabbb?babaabbaa?aaaba?bbaaaaaab?baabb?abbaa?baa?baabb?aabbbabbbbb?abba?a?abbbbabbaaaaaabbabbbbb?baab?bbbaaabbb?baa?aa?aaaaabbabababbb??bbaa??aaaaabaa?abbbbba?abbbbbb?ba?ab?abbbabb?bbbbbbbbabbaa?ba?bbbbb?abbbaaa?aabbab?babbbbbbabbbbabbbaabbbbaaabbbba?aaa?aaaaaaaaaaabbbaaaabbbbb?abbbbbaaabaaba?aabb?baa?a?abaaaaa?baaaaaaaaaa?aaaabaabbbaaabbbbbabbbaabbaabbbaaa?aaabbaababbbbabb?bbaaabbba?abaaaaaaa?aabbbbba??abbb?aab?bbabbbba?aaaabbaaaaabbaaaaaa?abaaabbaaabbaaabbbbbbaaabaababaabbaaba?b???bbabbbbbabaaaabbbbbbb?b?ba?aaaab?baaa?baaaaaa?bbbbbabaaaaabbbaaabbaab?baabbaaaaaabab?bbaaaaabaaaaabaa?aaa?ab?b?bbbbbaaaaabbaaa?aaaa??aaaab?bbabbbbbbbbbbabbbbbbbbaabbbaaabb?baaabbbbbbbbbbbaaabbaaabbbabbbaaabaa?aabaaaaaa??abbbabba?aaaabaaaa?abbb?aabbbabaa?bbbbaa?a??aaabaa?aaababbbba?abb?bbbb?aaaaaaaa?aaaa?bbbbbbaa?aa";
        assertEquals(2553.86739375, squarescores.calcexpectation(p, s), DELTA * 2553.86739375);
    }

    @Test
    public void case63() {
        int[] p = { 6, 4, 1, 3, 4, 8, 4, 3, 6, 4, 0, 2, 3, 6, 6, 9, 2, 5, 1, 3, 5, 4, 1, 5, 2, 3 };
        String s = "?b????nn???????????q??q?????k?k?p???????uu???w?w?m???o????o???????o????????o?o??xl????l??l?l??";
        assertEquals(100.51615041025077, squarescores.calcexpectation(p, s), DELTA * 100.51615041025077);
    }

    @Test
    public void case64() {
        int[] p = { 5, 5, 2, 4, 4, 1, 6, 5, 2, 0, 3, 14, 6, 1, 5, 5, 2, 1, 2, 3, 5, 11, 1, 6, 0, 1 };
        String s = "m???m?m???";
        assertEquals(10.65703493596672, squarescores.calcexpectation(p, s), DELTA * 10.65703493596672);
    }

    @Test
    public void case65() {
        int[] p = { 5, 2, 3, 6, 4, 8, 0, 4, 1, 4, 6, 3, 2, 3, 5, 4, 5, 6, 4, 4, 3, 1, 4, 6, 2, 5 };
        String s = "???q?q??qc??nd?tt??tnn????x??xnwtt?t?t?tt?tn?mmdedd?r?rrlaa?v?vv?voo???ss???qqj?????ll??lv??vs??sxlll?exx??vo?o?oo?k????r?r??rss???z?znn";
        assertEquals(162.00791948205574, squarescores.calcexpectation(p, s), DELTA * 162.00791948205574);
    }

    @Test
    public void case66() {
        int[] p = { 0, 0, 2, 0, 0, 0, 28, 0, 0, 0, 0, 0, 0, 2, 17, 0, 0, 0, 14, 20, 0, 5, 0, 0, 0, 12 };
        String s = "??????????????????????????????????????????????????????????????????????????????????????m???????????????????";
        assertEquals(130.20382372669474, squarescores.calcexpectation(p, s), DELTA * 130.20382372669474);
    }

    @Test
    public void case67() {
        int[] p = { 1, 4, 5, 7, 5, 4, 3, 2, 1, 7, 7, 5, 0, 9, 9, 1, 4, 5, 2, 0, 9, 3, 1, 3, 1, 2 };
        String s = "?????????????a????????????????????b???????????????b???????????b????????????????b???????????????????????b????????????????????d???u?????u???????????????u???????????????????????????u???????????????????????????q??????q????q??????q?q??????q??????r??????????????ff??????????????????f???????????????f????????????b?????????ss?????s????????s?????????????????????????????????s????jh?h??????c????cc?????????????????????????????????????n?????????????????????n????????e????????e?";
        assertEquals(497.2572676126915, squarescores.calcexpectation(p, s), DELTA * 497.2572676126915);
    }

    @Test
    public void case68() {
        int[] p = { 4, 4, 1, 10, 8, 1, 9, 1, 7, 5, 1, 0, 4, 2, 6, 1, 5, 7, 3, 2, 1, 4, 0, 1, 1, 12 };
        String s = "iiiiiiii?iiii?i?iq?zzz?ziiii??ii?iiiiiiiiiiiiiiiiiiiiii?iiiaaaa?aooo";
        assertEquals(372.59977119999996, squarescores.calcexpectation(p, s), DELTA * 372.59977119999996);
    }

    @Test
    public void case69() {
        int[] p = { 4, 1, 5, 0, 7, 2, 3, 5, 3, 5, 4, 6, 4, 0, 9, 6, 2, 3, 3, 3, 1, 2, 3, 8, 2, 9 };
        String s = "iu?yyiy?y?yq?i?t?tt?tvw?wwwk??????t?t???tjvvmm?mm?qqqqhh?h?ff?peessg?n?ll?ll?lbs????l??llll??hvkkk?kk??ix??xxx?mmm?mm??mp?ii?i?ee????eerxddb?jk?k????ii?vp??p?v?vvp?py?y?yn?w??t?????t?oo?vv?v?ya";
        assertEquals(247.5262461434836, squarescores.calcexpectation(p, s), DELTA * 247.5262461434836);
    }

    @Test
    public void case70() {
        int[] p = { 10, 4, 12, 5, 5, 0, 0, 7, 5, 1, 9, 2, 0, 4, 9, 0, 2, 7, 0, 3, 0, 3, 6, 0, 1, 5 };
        String s = "gg?g?p?pp??ppppp??pphh?hh???hh???h?vddd?ddwwwwj???jgg???oo???oo??oo?ov???s?qqqq???qww?w?wss?ooooosmm???mmaahn?n?nn??nnd?n??n?zzerrr?ro??o?oooppb?xxxf???f??onpp??a?aaaahhh?hr?sk???kszu??b?bbbr?rpp??pfff??fff?fuwwww??c?c???ccw??w?wb?bb?bb?bddx??xxdddeew?????lr?rqqnnnn??nn?nnnqq?tnn??nnnnnn?nn??np?ggs??sxxg????gg?kaaa?xx??x?x???";
        assertEquals(479.79930737299895, squarescores.calcexpectation(p, s), DELTA * 479.79930737299895);
    }

    @Test
    public void case71() {
        int[] p = { 9, 2, 3, 0, 5, 1, 4, 6, 0, 3, 4, 1, 6, 9, 4, 3, 2, 3, 5, 1, 1, 7, 3, 10, 4, 4 };
        String s = "lllll?lll?lllr?ooo?iiiibbxjjjkxxdddjb?aaib?bg??vmoss?syy?yyoo?ono??oottfacccddaazttt?k???mmmmv?xxd?uuuubb?xxxxxxrrdvvjjjjpvv?vaoyyssreu?uu?d?bvoee??a?ahzzzcc?yyyyyyuuuzz?zzzzeetneww?wm??s?sssss?ssv?v?v?vejjjnnnovoooooo?o?t??oo???oojjjjjeg?nv?v?hhmllllllxx?xx?xzxxx?z??jjjjh?hmm?ksvvvv?vv?bdd?u?cdddg?ggx??bbbb?fupq?nnn?nnmm??mm??mwj?jbbbiiiivic?llyog?gggggxxxxtt?tchmm?mmkkkkffooohhhq?qqqqpcy?nlq?qqjk?klr??k";
        assertEquals(690.9866656171913, squarescores.calcexpectation(p, s), DELTA * 690.9866656171913);
    }

    @Test
    public void case72() {
        int[] p = { 8, 1, 1, 2, 2, 4, 3, 6, 4, 4, 9, 2, 2, 4, 1, 7, 5, 7, 3, 4, 4, 1, 0, 3, 7, 6 };
        String s = "a??q??qw??wz?z?ljw?lrraz?rll?pxg????sss?sbl??l?ll?ycdddk?bmuv?nsaaao?f??ff?mxn?voy?ukq?uit?twicj?lqq?s?g?pgnwb?fm?qevv?mmqz?vttqi??bodd??bb?mmsyv?f?vv?b????eivz??w?tpkm?eespp???h?h?x?xx??j?we??uu?qa?znnrr?????rq???dw?cnptcqqq??kky?y??sra?q?zy?dx????g??gf??ofml?l??t???pjppphamvd?wmrn?it?ww??w?ttx?xx??crrrop?p?xwnnnrz?????snyvvc??it?yy??auyiam???cj?aaww???h?k?c??g?w?zffig?g?eehxfxydvb?c?c?c?cg?qq?gn??bug?qi?tbmm???wu???r?n??h?h??as??t?gd???u??u?mbvb????ckoo?ocxl???dd?km??mehiu??aabb?aa?rr??ro??okuqdd???cyfr??n??fw??l?b?l??xoosapww?mlk??nn?ccu?i???imb??bnlz?h?h????????bbnq?nu???uupp????i?mmlzy?e?pussz?z??c?yhr?gm?ddi?i?jjwddhx???gxi?zg?pjxp???p?pld?v?eep?llj?xmdd?d?ljj???ogge?s?ryp?d??o??cc?zc??q??zzz???zsjf?bwq?sl??v??d?";
        assertEquals(828.9420217135482, squarescores.calcexpectation(p, s), DELTA * 828.9420217135482);
    }

    @Test
    public void case73() {
        int[] p = { 1, 2, 3, 3, 3, 5, 3, 2, 5, 3, 3, 7, 2, 4, 4, 5, 5, 5, 6, 0, 1, 4, 7, 3, 6, 8 };
        String s = "j?t?????pp???iijjjjc??i?ss??s???c???c????c?id?d??kd??d????d??d?????????l??f?f???f??uug???hy???yb?????w?wwww??wwmmmy?y?b?????i????a?a?c?v??v????v??v??vv?kdf???????????fe???eee??v?w?cc??c???c??c???c????c???????v?j??????h????????h???h???hh?c?cc?c?c?cy??y???yo?l??llb???b?brrrr??r??????ryy??q?k????????k?ks???s????spp?????p???pw??w????we??e?q????g??u???uu??u?uu?u???????????????ccd????d???dnn??????????????n????????n?nnn?nj??c???h??h?h?hh??????????????h???h???hhuu????urrr?r?????????r?nx?????x?????x??xv??v?v??v?v?a?a?????aaaii??i??????i?y?y?q?zsbm???m??m?m??????mm?m???m??mm??m?m???m?i???i???????????????v???v??????uuuu?j?d?d?d?????u???????qq???p??pp???????p?p?w???w??q?q??q??qqq???qz?????????zz????zzzj?ji?i?x?x?ksv??vv?v??va????dd?dn??????n??????????????????n?f????????ff?????f?f?????????f???poff??f??fq?????q????????????qj??di????????h??hc?c??c???c?c?cf??f????fg????????gg???nc???ca??????o????o?o?o???ozf?????fw?w????w??y?????????c???????cs???";
        assertEquals(1061.5118826714752, squarescores.calcexpectation(p, s), DELTA * 1061.5118826714752);
    }

    @Test
    public void case74() {
        int[] p = { 5, 0, 3, 4, 1, 5, 1, 2, 6, 5, 12, 5, 4, 2, 1, 0, 1, 1, 0, 11, 1, 9, 7, 4, 4, 6 };
        String s = "?z?zkk?k?bgqqqll??lp????lqvvg?g?f?f??gs??y????ba???oo?oupf?";
        assertEquals(68.54399288889618, squarescores.calcexpectation(p, s), DELTA * 68.54399288889618);
    }

    @Test
    public void case75() {
        int[] p = { 0, 1, 1, 0, 0, 4, 6, 2, 0, 12, 0, 0, 15, 0, 0, 0, 1, 3, 5, 0, 31, 2, 0, 11, 6, 0 };
        String s = "?????g?????????x?o??????????????c?????????u????????tt??????????t??????t?b???????i??????????????b?????????????????????????????f???????????z???????????????????r?r???r????s?????????i??????????i???????????s???????z?????????????????z????u???????????????????u??????????????????i???????t?????????????????????????????????????????????????????l?????r????l???????l??l??l?????????????????????????????q???????n??????????????b??????????????????????????????????????????????????????b???????????????????????????o??????????eh???????h??????????????w?r?????g???j???i????d???d????g?????????m?????????????????????????????m???????????????????????????????????????????m??????????????y?j???????????????";
        assertEquals(799.5599065051624, squarescores.calcexpectation(p, s), DELTA * 799.5599065051624);
    }

    @Test
    public void case76() {
        int[] p = { 2, 9, 5, 0, 5, 10, 1, 7, 0, 0, 0, 1, 4, 7, 5, 1, 2, 1, 4, 8, 7, 0, 1, 6, 3, 11 };
        String s = "aaabnkk?krpp?oo?occcqqqqqqmmmmqtttokmtttxxxxwwwkkpppaka?a?aaaaass?ssxxrpmmmmppjj";
        assertEquals(150.97979999999995, squarescores.calcexpectation(p, s), DELTA * 150.97979999999995);
    }

    @Test
    public void case77() {
        int[] p = { 0, 10, 0, 0, 1, 6, 0, 0, 0, 4, 2, 0, 7, 0, 9, 0, 0, 0, 0, 12, 0, 0, 0, 18, 31, 0 };
        String s = "v???vvv?vv?vv?vv??vvv??v?bf??ffff?ffbb?bb?b?b???b??c?ccc????c???c?cc??cc?c??ccczzzaaa?a?aa?a?aaaaa??a????a??aaaxx??x??xxxxxx?xx???xx?xw?w?qq???qqq?qqq?qq???q?qq??qqqqqk?kkkkkkk??rrr?pppppp??pppz??zzuuuu?uuuqq?qqjj??j??jj?k?kkkk?kkk??k??l??llllnhhhvv???vvv??vvv?v?vvvvf?ff?f?ff?f?f?f??f?f???fffccccc?cr??rrrr?r??rrrr?e???eeeeee????e?es??sssss?s?so?ooo??eeee??e?eml?v?????vvv";
        assertEquals(634.3227583154942, squarescores.calcexpectation(p, s), DELTA * 634.3227583154942);
    }

    @Test
    public void case78() {
        int[] p = { 2, 1, 1, 0, 1, 2, 14, 5, 4, 4, 0, 1, 3, 1, 4, 2, 0, 3, 15, 4, 8, 2, 0, 13, 6, 4 };
        String s = "????????pp???????????????????????p????h????????h???????????????????????????????????????????????????????????????????h?????????k???????k????????????????????????????k?????????????????????k????????????????k????????k??????????????????k??????kk????????????????????k?r?????????m?m??????????????m???????????????m????m???e?????e?????????e???????????e???????????e???????????????e???????????????e???????????????????????????????????????????????v?????????????????????va???????????????";
        assertEquals(512.3440799661357, squarescores.calcexpectation(p, s), DELTA * 512.3440799661357);
    }

    @Test
    public void case79() {
        int[] p = { 1, 0, 0, 4, 2, 14, 3, 3, 7, 0, 0, 3, 0, 0, 16, 4, 0, 0, 9, 2, 6, 10, 0, 0, 7, 9 };
        String s = "eekkymmoouur?erakqvvvvhhhhs?ssmpyw?wb?bbbujjjexxxxxmll?lnnnhr?rppii?izqqvl??vggg?nnmastoojjk?kwzhhbv?ureq??q?qqqaa?a?tceruuhhhhhgyy??yyyy?ybbjkkjjuuuucb?kkk?llyv?cc?orjh?xxmmmaclkwksspppphccyh??wk?k?cclll?lqqlzz?zkkkk?kkwwlv?smhutttg?ggj??jnxh?xnnrrkkkkdcj?evxx?x?zqnnna?aeolfp??????ff?f?gg????ddj?laa?aoeettx?yyyy???yipyx?dhhhlr??iimmmm??mmm?il?ll?lloor?ll?ikxx???grrrrrggjccrcakkjfuu?xxx?o??a?aaddeerwwwwwzmmhiizzuy?yyyyyvg?o?orliixx?vh?h???sjjj?e?na?ap???ppppppnnbbbqqqqojr?xzwwwkkrrrhd?dnccwwww?ttvgggg?g?gleellpoo?b?bb?bhhhhhcbbbb?bb?mmmm?cb?iif??gs?cq?qe??nmvv?qqqt?nnuuwapkd?mmfmmummpvvzz?zi?ii??kaaannuccc??geeezz?zgyyuuuuu?ruc?c?";
        assertEquals(965.9602403585476, squarescores.calcexpectation(p, s), DELTA * 965.9602403585476);
    }

    @Test
    public void case80() {
        int[] p = { 2, 0, 1, 5, 7, 2, 4, 3, 2, 2, 7, 9, 7, 2, 2, 9, 1, 4, 2, 2, 2, 5, 3, 3, 9, 5 };
        String s = "ss?zzr?r??r?????r???????r???kkkk?k?k??kkkx?xx?xxxcccc?pp??pppp?????????ppbb??b?qqii???ii??i???iis??s???ss??s?s??ss???v?????v??v?v????????ii?iiii?ii??i?ssssiq?xq?q???q?q?qq??????????qqqq?qqqqqq????q???????b??????bb??bb?b???lmwww?zz???z?z?????z??z?zii?oo?w??zzz?z???????????zzzzz?zz?z?zzz?????zv?v???v??vv???vv?vvvmm??m?mm???m??????mmmjjeeee?f???f??aa?bq??q?qf?ff?b?b??????b??b??b?bb??qq?q?qq?q??q?qqu??uu?uuu?uuur???a??o??p?p??pp????pj?????j?j?jj???????jjjjhh???h?hh?y?eee?eece??ee???v?vv???vxx?????x?ppp???p?ppppppp??c???clv?gv????vv?v????v?v????v??v?a??a?a??a???aa?op??c?c?f?f?f?f??f??fffff?b??b??b?b?bb????b?bb???bbj?j??j?p?p??p";
        assertEquals(847.4420305410017, squarescores.calcexpectation(p, s), DELTA * 847.4420305410017);
    }

    @Test
    public void case81() {
        int[] p = { 3, 3, 3, 2, 3, 4, 3, 0, 5, 3, 5, 0, 6, 4, 10, 5, 2, 5, 1, 4, 8, 3, 5, 3, 3, 7 };
        String s = "m??m???z?zzzzzzz?zeett?ttt?yyyx????x????xt????te?e?k?qq?qq?qqqq?q?q???qq??q?pbb?b??c???cc??cccc???????c??c?ccc?c???t??tt?????ttt???t?tttttll?lu?uzz?zzzz???zzzzz?zzy????yy?yzz?z?z?z??ww????w?wl??x?xxkkk?k???k?kkkkkkk?kl?l?qwf??f?f?fk??w??fo?lll???ll???l?l????l??lll?l?lln?n??n?????nnnnn??n?n?n?n?pg??g?gg?gw?????y???y?yyhh??h??h?c??l?l?le???ee??eecc??cc?c?cju?uu??u???uu?uuyy?y?y????ee????eeec?q?????q?qooo?o????on?n?nnzzq???q?qqmmddmmm?mm?hhh?bwwwi??idddd???fffq??cc???s?swwii?iiiiiiin?nu?u??u?zz?z????q??q????t??t?tt????t?t?tttttxxvv???vv?vv??llyyyy???qqq?qqss??sst??t?tmm??f?f???????f???l?l???laau???uwwkqqccccc?bb?co?o?o?o???oooom?m?mya?a?ammm?mmm?rrr???r????rbbbppc?c?cvv??cc?c?nnnoo??o?o?oo??o?e????ttttu????u???uuu?uuuuu?u?uu???uud??d?ddn?n????nn???w?w?m???m?mm?aa?????a??aa????z?z?z?????zx????xcc??c?o?o????hjjf????f?f??ff??d?ooo?o??ot??v?vvu????u??u??uu?uu?u???u?u??uu";
        assertEquals(1231.6422205974882, squarescores.calcexpectation(p, s), DELTA * 1231.6422205974882);
    }

    @Test
    public void case82() {
        int[] p = { 3, 7, 1, 2, 2, 6, 3, 5, 4, 6, 5, 3, 2, 4, 4, 3, 6, 3, 2, 3, 7, 1, 8, 6, 2, 2 };
        String s = "qqwbffcx?qiizmmapcubxhoorrgofxquuprpkkkbjkkfynpkmnvjw?pvubppcss?ccalgzzrrrr?fe?sdvwsbwrxnm?kwwjppaqvlfcvvntgrzsmintnbqqcqopepncttglccbmwpppopzzcvdefgdqnnnolpjjgmaairhvtkkkdpghklwhen?nqjjwbvjjibbplzzlkggizzbiocco??eezvwuwwanswqozuuu?iqavvnplikjjtqqrbidmrnkudrziia?lklpgddllbbhrrmbbbrounnnnwjlatdabkffecyyccfrg?vonbhwddgavslyjfczzzq?dss?kyydijpvghovoddgfyrv?jfrddybrysicglepabxkidsxqshh";
        assertEquals(465.4207999999991, squarescores.calcexpectation(p, s), DELTA * 465.4207999999991);
    }

    @Test
    public void case83() {
        int[] p = { 0, 0, 0, 2, 0, 0, 0, 0, 43, 4, 0, 0, 9, 26, 0, 4, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0 };
        String s = "bb?bb?b?b?pts????xxb?b??okk?wwuu?uuuuu?uuut?y?y???ygg??hyy?y??yyyu?u?u??tt?bgcse?xo???o?oo????oooo??oo?o??o?l?l?l?u???????uff?f??ffm?????a?i????iw????cddc??bk??yei??i?i??????pp??ppw??w?ww??g?g?gn?s?m??mm?mmmz????cc?zzij??jjzz??zttttt?t?ii??ii????i?????jjjp?pp?p???n?n?n?nn?nirjjsfkkkxu?yl?nhy?i?u????u??u??vvssssq?qqqq??????qqq??k????ppp??c?c?ll??ljjjj?d?d?d??tttr?rr?r?r??ijjj?j?j??j??j?y?yy?s???sstt?tsnnnn???q?z?l?ll???l??lltt?sd?d?dddh??zz??????u??u?updd?xaaf?f?fff?fh??ll?lla?a?axx??xxx?xx?a?an???nl????ll?uuuuu???uu?u?ug??o?oo???o??ob??????q?qq???k???kkkfff??fh???hh?h?hhh?h?o??o????f?";
        assertEquals(816.1954437210211, squarescores.calcexpectation(p, s), DELTA * 816.1954437210211);
    }

    @Test
    public void case84() {
        int[] p = { 2, 0, 8, 3, 1, 3, 2, 7, 0, 7, 3, 14, 4, 3, 1, 4, 1, 14, 0, 2, 5, 4, 4, 0, 5, 3 };
        String s = "ddlltog?bw?ps?ytqf?ybus??fi??hiret?lbn?n??wy?nhoeey?vcoogols?eor??ji?n?vipvr??kyxdmjkxsstgntz?zpmm?syzzkfgum?q?ucsyg?ybt?oyohtfficeqmidwzuxfi?fdf?g?wb?gevnwg?eyqz??uneo?z?zrk?qnjj?ge?nnvdm?o???sgdx??qpeos?ieeds?t?nbi?sl?or?hy??y?jhsply?wrrghj?jpeao?hhvq?g?t?u?fw??w???onxsf?fv?z?nnebww?xdm?uhtcynn??a?zypvbor?xsb?pa??nkl??zfu?uu?uu?o??z?p???hccii?vmn?jvus?y??vu????o??bdj?nmmxtenmrnn???wl?t?ll??gvlof?afrtss?uuquunm??ze?x??bbe?kxvuamxyyh??cc?pidbnipa?mmwv?y?nf??w?gnkgaubi?jhnc?pc?p?b??qr??i??mjw?o?k??ffkvg?e?a?o?tcb?i?a?q???bionpp?s?sef?mm?h?lv?ddscjd?dm?gqn?ve?h??vbxk?k?pe???pa?o?og??dvscaf??ccvidz?a?altf?jz?pttsazsyjr????hlqw??sed?upj?ymmxlakk?xqjbf?ggaagsopwokmtgr?gjkbn?xroy?yy?";
        assertEquals(742.8666691149872, squarescores.calcexpectation(p, s), DELTA * 742.8666691149872);
    }

    @Test
    public void case85() {
        int[] p = { 4, 3, 3, 2, 2, 2, 4, 9, 7, 5, 9, 3, 0, 6, 4, 2, 5, 3, 1, 2, 0, 3, 9, 4, 8, 0 };
        String s = "?bnnn?nmavfh??hhcywardd?ddqaiimmkwwmmufico??oo?ggggge?nwssrtvvvck?k?k?aa?bssbbbhktai???uqouhzzz?jqii?i?kkxms?qw?wfd?wxy?kvviiindwjettvtttto?peiiznuuzjduu?ukrraalzzfblxxx?njmooooog?gggdz??zp?pnnt?qqxb?bgmx?tbjwssgggq?jf?j?jjoh?ppppfqqnnfs?lbvoz?k?kt?uqe?ehpaf?ffsfufoo?m?bb??ssx?z?ee?gddwj?xb??nnmg?cccfbbbbbb??uuloop?p";
        assertEquals(435.1438959999974, squarescores.calcexpectation(p, s), DELTA * 435.1438959999974);
    }

    @Test
    public void case86() {
        int[] p = { 0, 3, 2, 3, 6, 0, 6, 0, 1, 7, 16, 0, 0, 17, 0, 4, 3, 0, 12, 0, 9, 0, 1, 3, 1, 6 };
        String s = "??xt??ttcc?u????u?j?jj????hh?h??a?dddddrra?a??nn??vl??ppp??p?ppr?rrrr??rr??rq??qy????y?yyy?im?k?khh?h???hzzmmmmy???y?yy?yy??qqee?qq?qqq?pb?b?b?bvv?qqwwww??w???wwwuwwwwlljl?borrr?rr?ddd?uwwfhhhhh?h?hhiiii???nn?nlll??ssnjjjcccccj???jb?bbbb?bbjbbiqqzuuuummc?r?rr?rhhtooo?dd?bd?hh?hh?wffffffx?ee?q?q??mm?m?mm?m?mpppszzzz??zzs?kr?b??bbj?j?jm?m?ggnnn?k?bggg?gggg?gffffff??fg?gv?vtttrff??ay?yhhhhhp?pobt?tttwmr?r?l?bb??bggkk?y?d??ddy?yy?brvv???n?nfffffffff?aa?aa?aa?a?a?aau??vvv?viibjn???nnqvkk?ss??d??lll?c??w??w?yyy?yy??yyymcuuqss?uuuuuuaap?pp?p?ppu??qqqqqymm?mm???mddrr?wrrrvvvvvvvv?sse?evv?v?v?zzccll?ll?llyyb?tf?s?s?jj?jswe?pp??qw?cjff?f?u??uuooo?e??u??vvv???v??niiim?meiy?yir??aaaa?ww??y?r?rw?wwjjjxke??edddj??jj?jjuunn??nny?y?y???y?pp?p?ppp?hvvlkd??yu?uuuff?ffs???ss?uuu???uu?vkggaajjjjh?mmmmsss?s?w?g?nn?piij?jjjjrrrypppppp?n?t??d?h?hh?hj?j?ypnnoooz?z?zghhhhh?hrvjjj?jjj?j?hhkkkk?geegm?mo?o?oollrrrvvuyyyoqqc?x?xx??mnnn?n?nvvv?vx?xxxxyyqqq?q?a?tttttg??wwwwhhjowwwwwan?nnkkpw??w?kkkkll?lzsp?p";
        assertEquals(1558.9284987672697, squarescores.calcexpectation(p, s), DELTA * 1558.9284987672697);
    }

    @Test
    public void case87() {
        int[] p = { 0, 4, 0, 2, 0, 0, 12, 15, 3, 0, 0, 1, 6, 1, 5, 0, 0, 8, 4, 0, 8, 0, 4, 27, 0, 0 };
        String s = "?dddd?dddd??ddddzzzww?wwwbrrr?r?r???rrr?qqq?qq??qqqqqqqqq?qi?iiiiiiii??i??i?i?ixxxxxhh?pp?ppppp?ppppp??pp?eeeeeeeeee??e?e?ee???i?ii?ii?vv?vv???v?vv??vv??v?kg?gg?g?g?gggvv??ii?oo?oooooooooooggf?fff??f?o?ooooo??oog??gg??ggggg?gaf??fff?ff?f?x?kkkk?kkkk?kkk???k??k???kk???k??k?kk???aaaajcccc?ccn?nbf?yy?yyyyyy?yyyyy?yy?y?yy???y???yyy?y?y?y??yy?yyyy?yyyy??y?yyy?yy?ymmmmeeeeee?eee?eeeeee?ppppppppp?pppuuuuu?uc??cc?ccccccccc?caaaa?aaaaa?aa?aa";
        assertEquals(952.843389901023, squarescores.calcexpectation(p, s), DELTA * 952.843389901023);
    }

    @Test
    public void case88() {
        int[] p = { 3, 8, 4, 5, 5, 0, 2, 4, 3, 1, 6, 7, 2, 1, 4, 1, 4, 7, 1, 4, 7, 3, 2, 5, 4, 7 };
        String s = "????????????z??????zv?l??????????????????s?????????s?????????a???????????????s????v????????????????r?y?r?r?????????????";
        assertEquals(125.21386940238521, squarescores.calcexpectation(p, s), DELTA * 125.21386940238521);
    }

    @Test
    public void case89() {
        int[] p = { 1, 6, 2, 1, 6, 1, 1, 2, 5, 2, 8, 1, 1, 1, 2, 4, 3, 7, 2, 3, 0, 7, 4, 2, 20, 8 };
        String s = "?ajjv?jmmxxhxg?hion?rromeo?pffqxyyi?pl?sssvgzxilyynrhlyzvvwgjip??torxq?jkdrcvtswrcclpo??ahbieoyybnbvqqsc?jfrotthhsava?bxxxxeeevceli?kfxmkiifvqmuohscrss?daaipeeth?g?ojfhilllxpffxyolzgudvvrodeccegk??f?jb?iieansonnaiioqxfrt?fsdw?nnlqvood?mdt?eexrwjj?ia?itaafllb?ssjoo?pge?xx?cpslakob?t?ejpqqu?wojmx?khzoxsclekh?ss?xfdlll?dnjsfsj?horpmbrpv??cloy?crr?rhuu??lnqnuuijys?sbbptclzijcfl?eflz?btbbijeffhnsrcja?ad?c?uqwic?bbl?a?w??i?iop?hfrrfvytfpw?pyhkbcdojty?a?hjaat?xuuaffedooz?s?s?d?aaaxww??omaaaawipa??xz?xucmqnljjjjrwvvvfb???bahouqqsmkb?aa?hx?x??quq?tbsxhp?odmomulomvvv?oenec?kdyy?rf?nn?n???txqzcxxukdw?aazbmrrkkt?fvmjtejc?yjhxillkkt???psgqmxmnggg?gvttxu?zwxnxdcct?t?qalkkgcdhnnh?hukllxaazqczccccb?bb?kkopw?g??y??yjt?dzsfezzzkmfzzdadt?";
        assertEquals(856.053123040089, squarescores.calcexpectation(p, s), DELTA * 856.053123040089);
    }

    @Test
    public void case90() {
        int[] p = { 3, 0, 16, 7, 0, 0, 0, 3, 0, 0, 27, 0, 0, 0, 4, 0, 0, 0, 0, 18, 3, 0, 0, 1, 6, 12 };
        String s = "r???rxnnnnnyw?zw?bbg??wx??x?cc?jm?zwnn?dd?l????c?xppkavtwyy?vnqlgnn??n??dddmw??uu?uriihhhxxnj?b?qh?w?frgsb??ccc?ccn?jrn?z?gw??lowbjwtt?ccoo????lxcavvimhhnqxmmk?ddjj?lhxh?wvvy???rd?dnbimiq?p?jfffc?a?x?ff?iyd??d??dvne?m?uu?dp";
        assertEquals(277.29777045759977, squarescores.calcexpectation(p, s), DELTA * 277.29777045759977);
    }

    @Test
    public void case91() {
        int[] p = { 5, 2, 5, 6, 3, 4, 3, 4, 1, 3, 3, 2, 6, 6, 3, 2, 6, 7, 5, 3, 3, 3, 1, 3, 5, 6 };
        String s = "???w??o?????a??a??f??fvf?r????mm????????????????m?m????m?s???sp???q??qqyy?u??c?v??vvr?a?k??k???u?u???u?????r?rr?rr??r?????f???jm?mm??????m??m???m???????????????????mm?m???m?m????????mm????m?g??????jbu???u??u?sj??j??jjj?n???nu????u?????n?l????????l??????l???????nr??r??????o????o?????????s?r???????xt??jj?q????q???????????q?????q??q?q?????n???????n?l?l?m??m??m??q????qp?p????s??s?s?s?????q????q??w???bo???pfp??????in?????n???????wk";
        assertEquals(464.5279324591878, squarescores.calcexpectation(p, s), DELTA * 464.5279324591878);
    }

    @Test
    public void case92() {
        int[] p = { 3, 7, 0, 3, 5, 0, 1, 0, 13, 4, 1, 0, 1, 8, 0, 0, 11, 1, 4, 0, 1, 13, 1, 13, 0, 10 };
        String s = "hhhwq??xxxvoonhhivjjsszzz?uxxkkkkkj?joh?hqz?zzccyc?cc?cg?ttvvvvvw?wiiiih?dldddppxuuwkkyyyybbbbyii?s?bbhhpnwwffciill?dm?mmxxrrppppyy?yhhhh???hxxxxxxobbbfs?s?see?hhh?yym?mmeeooyyyynnx?xxxuz?zfuuuura?lggg?a??aaaaxxx?xcccc?ccjjlq?qqq?qqvrvvvvqtt?l?ll?laal?bnnnnmmbb?b?bbb?buawte?evvwaajjcyypkk?kddwhhssth?hhfiii?pddddkkkgguuussnnqbxxx?bbdkm?xxximlllllptctaaeoooooooqqqgggrgzzll??lggggyyyaaaaaooiiikkkkntucccdppppqdddp?ooxmmo?xrrooojrr??r?rriggnn?jjnnnrqqqavvvvy?yywxx?zzzzzmlflqqn?eejjbz?nnlmggthhhii?motelsaa?aajjjjhhhhhh?h?hbbuuuudhhhjjjjjjuuvvv?";
        assertEquals(939.0570919999969, squarescores.calcexpectation(p, s), DELTA * 939.0570919999969);
    }

    @Test
    public void case93() {
        int[] p = { 6, 3, 1, 4, 4, 2, 4, 3, 1, 4, 2, 5, 2, 5, 3, 2, 4, 7, 2, 9, 7, 3, 2, 4, 6, 5 };
        String s = "ooznjjs?s?ssp?pp?pnq?jl?llbbbbbbbbbbu?uddddd?zz?zz?ss??vvv??viiivvkkk?dd?wzjj?jjjj?jjj?jh?sshhhyox?xx?x?xx?xxeeee??n?n?nggg?g?gzzz??z???zggz??z?zzgg??qq?qqqqqqqv?z?yh?pkkkn??yyy?yy?o??ogg?g??ogn?ch?hs??????uu??u??u??u?u?uqqnw?pddd?d??qvv?lllvvv??yy???yggaaad?cce?jjf?ff??ffx?x?xx?vvz?zppppb?bb??bbbbpx?mmm?m?mp?pchv?vvnl?l?ll????epprm?m?a?abfvvk?k??u?uh?hheee?bh";
        assertEquals(561.5361445980932, squarescores.calcexpectation(p, s), DELTA * 561.5361445980932);
    }

    @Test
    public void case94() {
        int[] p = { 3, 3, 7, 0, 9, 0, 0, 0, 10, 0, 3, 0, 7, 0, 0, 2, 0, 0, 11, 14, 4, 27, 0, 0, 0, 0 };
        String s = "????????????????????n????????????n??????????????????????????????????????????????????????????????????????n??????????????????????????????????????????????????????????n???????????n?????????????????????n?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????n??????????????????????????????????????????????n????????????????????????????????????????????????????????n?????????????????????????????????????????????????????????????????n??????";
        assertEquals(577.0379386124761, squarescores.calcexpectation(p, s), DELTA * 577.0379386124761);
    }

    @Test
    public void case95() {
        int[] p = { 0, 13, 0, 0, 0, 2, 5, 6, 25, 4, 8, 0, 0, 0, 3, 0, 9, 14, 0, 2, 3, 0, 0, 6, 0, 0 };
        String s = "?i?????dh????????????h????gr??????r?x??f?????????t???y???x?????w?b????????????n?e?k????????????i??????n????j???????d???y??w?????????????d??f????????i?w????????ab????j????s??r???????????ue??????z??????????z????????????e?e???w???b????ic?k???????????v??m??";
        assertEquals(283.13704569026896, squarescores.calcexpectation(p, s), DELTA * 283.13704569026896);
    }

    @Test
    public void case96() {
        int[] p = { 18, 11, 0, 0, 0, 25, 12, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 2, 0, 0, 3, 0, 19, 4, 0, 0 };
        String s = "awwxtt?kkkkkk?kkmu?u?ccuu?gguuu?u?ud?ddaxxpaa?aooo?ooo?fglkbb?eeelddd?n?e?g??gggg?gggvvvjji?i?ixxxxf?f?sssyo?x?fffp?pggo??gggg?nnnvv??vv??vvjj????jjj?jjjjjjjjjkkssssssssqbbbdd?dddd??w?wwvvvvgggaayee?bb?bjj?jj?bbqq?qvn?nnnttb?bgf?ffffffffhmmmmp?ppeppp?pp?pnnnnnnn?n????nppp?yrdtt?tnnp?pppppppdddmmttttmmmmmmmxuuu?uu?i?i???ih?yyya???aaaaaarrrwwe?ee??h?hwwwenk?k?k?kk?k?aaa?sssss?????ssss?uuuuhe?eeeyvvv?v??vqq?qq?qqqq??qqf?vvv??vvvbbbb?b??beeeeeef?fffbb?www?wwweelllpppr??rr??pmm?zz?zz??zzz?zz?zz?z?mmmm?m?mmmmttttt?ttt?ttt?aaah???h?h?????hh?vv??vvvvvvv?vv??vvibbp??pppp?ppp?ww??w??wa??aaiiibbbeevdd?dd?du?uu?uuuucccg?g?gfff?fkkkk?k?k?kpnnhk?ii??iii?yyy?j?jjjkqwgw?wd??d?bxx?aa?aa?ssh?hzzz?nn?nnttttt?kk?ky?yy?osss?t??t?tt?t?h?h?hddtt?kqqqz?b?y?y?yyyyyhzzzz?z?zz???z?hhh?h?hh?h?hhht?t??tt?t";
        assertEquals(1416.2248282997896, squarescores.calcexpectation(p, s), DELTA * 1416.2248282997896);
    }

    @Test
    public void case97() {
        int[] p = { 1, 4, 0, 4, 3, 3, 9, 4, 2, 7, 8, 2, 4, 2, 3, 3, 3, 5, 3, 1, 3, 6, 3, 6, 2, 9 };
        String s = "e???e????????????????????????e??e??????ee???????e???????d?d??????????????????????????????????c??c?????c????c????c????c???c????d?????d????d???u??????????????????u?????????u?????u???u?u?????????u?a?????????aaa????a????????b??b?y??????????????????yy????y??y?g????k?????k?k??????????????????e?e?????????e?????????????????????????????m????????????s??e?????????e?????????????????e???????????e???????e???g???????????????????????g??gg??????g???????????????????????????????????g??x????????x??x?x???w????????????y?????y?????????????????????????w????ww???????o???o????????????????o?????t??????????????t????t???t?????????????????????t????????o??????????????????????????????hh?????x????x?x?????p??r????????r???????r??????r?????????????p???a?a????a???????a???????a?????tt??t??ttt??t?t?????t??l?yy???y????y???????????????????y????????????????h??h?h???v??????????xxx????x?x?????r??????r??r????r??????????????r???rd???ii???????????i????i????dd???????????d???d??d????d?????????d?u????????????????????u?";
        assertEquals(1052.6604613035984, squarescores.calcexpectation(p, s), DELTA * 1052.6604613035984);
    }

    @Test
    public void case98() {
        int[] p = { 7, 0, 0, 3, 0, 3, 0, 0, 0, 0, 25, 6, 0, 3, 0, 0, 0, 0, 15, 2, 11, 0, 0, 1, 6, 18 };
        String s = "??????bsm???s??a??lw??c?f?w?n???yrw???uc???hfiz????????mc?c?it?tt???????evvz??mh??o?yz?dd???dfi???????k??d???i?nb?a?gv???????????ziv?d???j?a???l?maz????cn?vd?wah??d??derll?i?id??????k?sy?m???kti???e?????e??????s?l??xjg?fg???n?hs?o?svytued??r??t??ai?v?in??s?sdf?????????t??o??a???i?r?rg??i?z?d??l?a?????ot?mx?x?yw???h??np??f?gk?bz???ws?j?w????t?t??f?????cga???rb?jw??x??x??h???ooid??m?????ae???v???b?o?w?w??wuc???ct????k???vk?????d??u??w?mpj??q?pbu??pqm??m?????v???do??z?????q???r???l?z??";
        assertEquals(530.7721927006666, squarescores.calcexpectation(p, s), DELTA * 530.7721927006666);
    }

    @Test
    public void case99() {
        int[] p = { 0, 14, 3, 6, 0, 1, 2, 4, 4, 12, 0, 1, 6, 0, 7, 4, 1, 0, 8, 0, 0, 0, 9, 5, 0, 13 };
        String s = "tt?k?????wx???e?ew??i???r?w???b?hh???mddfep??h?pp?ji?y?a?th??qrgm??mmud?jul?????x?x?m?m?mvvy??yzz?srrpfggg???jxxxg?i???zoje?heeez???zz??g??xv?zz?o?op?v?vkuau????uuee????ch?????????i?mg???h?hig?sci???rnrf??lbbb?iloo?zzzy?hs?bo?omu??t????ztx?xn??h?r?rr?rnn?p???dc??lkul??l???bz??x?xj???yw??l?n????or???cb??bc?o?im?m?xiddyynf?f???vvvv?ooo??h?akz??z?kt?o?c????m?y?y?ymmm?m?jbirrrru??y??vvv??rap?fool?ii??wnqq?l?xcfi?id??dxhzonp?j?kkiw??vqb?bt?ty????y?yy?qqx?vh?uu?uillli?y????nn?zlll?xg?lllll???ll?x???v????t?b?emya?hhi?i?i?ij?j?t?t?????????jfm?mvt?poo?o?ny???yb";
        assertEquals(663.295823359839, squarescores.calcexpectation(p, s), DELTA * 663.295823359839);
    }

    @Test
    public void case100() {
        int[] p = { 3, 3, 0, 7, 4, 2, 2, 11, 9, 2, 6, 7, 7, 2, 2, 3, 3, 2, 1, 1, 0, 0, 3, 4, 8, 8 };
        String s = "j?vvo??lll????????????d?????????do??????????ffff??????f???kk??e???f???i????y?yy???????e?i?t?mt??w??o????frw??????wd?d??????d??hy???????????y???j?j??????bb???bo?r?????????vt????t???th?h??????????l?s??????s?????sss?????????????????s???yg???g??g??????g?????????t??ff??????m??m??m??m???t?????z??z?yy?????y??????????y????y?????w??l?????????????lww?????www?wt?w?????????g?????gty???dddhzd???????p????w????d??????d????ee??e?v??gg??v??????f?f???f??r??my?v???ss???v?f??f?????tpp???p??w?u?i???ag?????g?h?zzzw?????w????rd????zo??o?o????????????ov??????f?u??b??w??????wx?????xxl??l??c?????p??p????g?g????g???????????xx??e??e???????r????nv??v?ruo????e??e?e??e??e??????e?h????????????to???o?r??err????????bb???c??ccxm?vb??b??b???j????????j????????????h??h??i?w??wf??fsl??laa?p??k??k??k???kk??????k?kkc???????????c??gg?????????????g????????g?????p?q???????????v?j??l?l????????o?oo?????????oo?s?????m?o?????o?dk???????k?k?b?????g??g?g??a?????a???u????kqg?????s?jb???";
        assertEquals(1043.8762748502968, squarescores.calcexpectation(p, s), DELTA * 1043.8762748502968);
    }

    @Test
    public void case101() {
        int[] p = { 6, 0, 3, 9, 7, 6, 4, 6, 1, 0, 2, 6, 8, 6, 5, 4, 5, 3, 4, 5, 1, 1, 2, 1, 3, 2 };
        String s = "iii?ii?????ii??ii?i?i?iiii??ii???i????????????i?i??i??????i?ir????rrrr?????rr?????r??r?rrrr?rre???eee???i?????iqqq?qq??q???????q??q?qqq????a???aaa??aa?aa???a??auuux???xzz?zz???zz?z??zzl?l??????lll??lllll?o???oooo???ooj??????j?lll????l?r?????rr????????r??rr?????rrr??rr???r?r??z????z??zzq?xx?x?x?x???xx?xxx??xuu??u??u??uug??g?g???g??goo????oo?oo???????o????oo?o???o???o?o?????o?ooo????????o??o???iiii??i???????i?i??ir?????rrrrr???r?r???r?r??r??????r??rr???r????rr?r???r?rr????o??o??ss?????s?s?ss?s??s??sss?sss?ss?s?s??s??s?sss????s???s?s?sss?s?ss?v???vvvv????vv??v?vv?????vk??k";
        assertEquals(742.3442766350911, squarescores.calcexpectation(p, s), DELTA * 742.3442766350911);
    }

    @Test
    public void case102() {
        int[] p = { 4, 2, 3, 6, 3, 2, 7, 5, 2, 4, 1, 3, 4, 0, 2, 0, 6, 5, 3, 2, 6, 4, 4, 8, 6, 8 };
        String s = "??????????u????z?????????s???g????u????q?????g?????k?????k?y??y???????j?????????z?a??????????????????k????q???u???????????????????????????c???????????????????sow?p?????????????";
        assertEquals(185.13022536827538, squarescores.calcexpectation(p, s), DELTA * 185.13022536827538);
    }

    @Test
    public void case103() {
        int[] p = { 2, 9, 3, 3, 9, 7, 9, 3, 0, 0, 3, 0, 0, 1, 2, 1, 3, 1, 4, 4, 2, 3, 6, 11, 13, 1 };
        String s = "m?????ppc?????e???????a????ksu??w?e???kc????c???u???b??h????lpl?l?k?wkjn?sus??i?i????h????v????v???vu??e??xl?h????????q?g?f?x???h?wm??mk???te?m???????mzu?c??t?rxx???b?????b????y??????????i?z?et???v??????uemhw????w??m???a??r?m?aoos???rr??????v??n?b??????s??i?l???y?k??zsg???y?y???p?q???u???x??xl?lrya?t??z?fdd???y?uus???pkwv???wbc??m?????m???i?xnn??o????r?d?o?mykn????x??s????a???r?ne?x?m?c???lj??p??uh????r????t??hh??????ak??s??????";
        assertEquals(462.09985772728385, squarescores.calcexpectation(p, s), DELTA * 462.09985772728385);
    }

    @Test
    public void case104() {
        int[] p = { 0, 9, 10, 9, 4, 0, 2, 1, 4, 6, 5, 3, 6, 3, 1, 2, 2, 1, 2, 5, 6, 3, 3, 6, 6, 1 };
        String s = "?ffnn?n?nqplra??aosgj??jddhcc??vt?e?laio?o?h?ir?rudddrr?xqqzzziimmm?nncce?rkzz?l?libbqqq?w?b??ggi?oppppiiikddnqffjpjjwdgggssttiii??dt?qqwd?dd???k??fnuuuk?kiyhh??hh?ffzzzeedq?cc?cccsss?j??jj?ggmmmnnnnrhyxxxxo?o?mvvpnnfnv?vxz?znnrnnssoooefnhltho?x?k??kkg?akeumkgh?huuy?ffrrbytcckbbllhhnhuk???kkrrhqiiigltt???ssssmloqwzvoozzzjjnxxphhjoo??evv??bmm?mgnvyyclpac??rr?i?re?epiik??kkjut?bkppy?ywaokdgohofi???i??i?bb?bb?qqqnsu?uuu?uusqq?y?lly?tgffinn?ny?tt?bfffz?ddmxwwzobbejjs?bom?mzll??aeljb??uynra?rrmuuuuuxxb?bbzzz???zzzzrrybqzztggcappj?jqpqqqqq?kq??n?n?ire???enq??bxg???wjjsvvvvkkkhccfpcmmbbp?pm?mm?mmmsiooqfbkk?xz?djjooooo??mmmcdmmbnnnn?flaau?ydnn??nhyorr?ufdr??iilvkn?na?yyyg??gnng???gvvww";
        assertEquals(934.4007291226737, squarescores.calcexpectation(p, s), DELTA * 934.4007291226737);
    }

    @Test
    public void case105() {
        int[] p = { 0, 23, 0, 0, 0, 0, 11, 0, 22, 0, 15, 0, 0, 2, 10, 1, 0, 0, 0, 0, 4, 0, 4, 8, 0, 0 };
        String s = "fv????w????i?x??oiq?lromop??b???e????g?nq?wvncjla?x??q?q??gv???mbyg???w?k??a?w????ww??ryq??yf??x??????e???kkgg??y?o?syf?ov?vvv??sc?llc?tom??c?hyfe?????n???b?fld?ye??????????????ld?xx?u???k?n?naz??gdjp??zss?dc?ud??tl?dtte????vq?d?dm?xs???b?kx??a??el?z???????wl?a??a?qq???????a??a?y?dv????zh?ho?b??????s??hm?o??vn?u????wya??kd?w?l?u??j????ji?k?tq?q?i????g??????w?iqyn?v??ivl?byo??x?dup???n?t???j???jjo??????k??o?q??ss??tv???a??h?c??dylr?p?q?yn?lp???j?qaxg??tz?aq??k?w???z??????di??h???d???k??guch?rfcspbriws???o????ck?o?s?????mq?y?pc??yyvv???x??d???d?b????k?u??mm??sk???w??p??ccsvrb????d?i?suyy??rhp????riq?je??hcz?vrz??u?g??e??c??bcruj?m?????r?w??????dw??nys?x??xo?ps?yxs??i???p?ww??????f????k??pm??kdtj?hw???uhhw????w??h?r?????a?i????y?be????j????f?tj??idd?y?t?sm????m??bxh???h?hnuum?m?r???d?x????t???t??";
        assertEquals(887.0926219278213, squarescores.calcexpectation(p, s), DELTA * 887.0926219278213);
    }

    @Test
    public void case106() {
        int[] p = { 3, 7, 7, 4, 2, 7, 9, 1, 8, 4, 2, 0, 7, 2, 2, 0, 4, 1, 4, 4, 2, 5, 6, 7, 1, 1 };
        String s = "be??ezzzzzzddddd??dd?dd?ddkkk?kkk?kk?kk???kk?kkkkk?kjjj??j?jjj???j?joooooott?ttttt?tttttttt?fg?ggg?ggr?rrrr?rrr??rnnua?aaaahhodd?d???dd??ddd??v?v?v?vvtttttttt??tt?ttttcb?t?t?tttrl?llll?l?ttttt?bbbbbbbbbbb?b??bb?tt?tt?t??cc??c?c??cc?c??dd?d??dddz??mmm??mm?pp?u?uuuuus?hhhh?ct?zz??zzii?iiz??zzzz?z?z?yyyyeeee?e?eeekn?llnmmww?ww?wwwwwwhhh?h?akkxa?a?a?ge?e?qqqmmm?mx??x??x?xx?xmm??mmmmm?m??mmmjj?jjjccc?cccccc?cccc?rrrrr?rdddd?ddd?????i";
        assertEquals(854.3237337703439, squarescores.calcexpectation(p, s), DELTA * 854.3237337703439);
    }

    @Test
    public void case107() {
        int[] p = { 0, 0, 0, 0, 0, 0, 0, 49, 0, 0, 0, 0, 0, 20, 0, 0, 0, 31, 0, 0, 0, 0, 0, 0, 0, 0 };
        String s = "???????lt?t???t??t?t????to????oooo??????o??????????o?????i?i?v??j?????d?????d?ww??x??xx???????xz????zz??????z?zzq??q?????????lll????c??h??hh?????????h?????????h?h???h???h?h???h?h?q?qq?q??qqq????????????qq???q?q???qq??qq??????q??q?q?q???????qq???q????q???????qq????f??o????o????????oo??o???o????oo?oooo???o?ppp?p???p???pp????ff?????ff??f?f??????????f?ffb?b????b??????b????b??????e?e?????ee?e?eeeec??ct???t???????????t?t?tmmmm???m??mqq??????qq????n?n??????n??nn??nnjjj?jjjj?jj?sa??????aa???mmccc?c?v?v?v??d????dd?dl???l?l?l??lll?l?ljjj?????h??hhz???zzzzz?z?z?z???????z????cc?c????q???q????qq??q?????qq?????q?????q?hl???ee??????e??ee??ee???eee?ee???e?ee?e?z??????zz?????z????????z??z?z?z??z";
        assertEquals(989.4215297624261, squarescores.calcexpectation(p, s), DELTA * 989.4215297624261);
    }

    @Test
    public void case108() {
        int[] p = { 7, 0, 1, 3, 6, 5, 5, 5, 3, 1, 2, 1, 2, 2, 2, 4, 2, 3, 9, 10, 10, 3, 5, 6, 0, 3 };
        String s = "ff?????f?f?f?f?f??ff???f?f?f??fff???ff???ff?f?f?f??fbbb?bbbb??bbbb?bg?gg???ggmm????mmmm??mm??mmm?m?m??????mm???m?mmmm?m?mmmm?mu??u???uuuu???uuuuu?uuu?u?u??u??uu?uu??uu??u???uuuu??u??uu?uu??uu?u?uuu?u?y????yr??rh??h?hh?h??hhh?h?hbb?bbb?bbb??b?b???b?b?b?b?bbb?bb?";
        assertEquals(380.1274076723157, squarescores.calcexpectation(p, s), DELTA * 380.1274076723157);
    }

    @Test
    public void case109() {
        int[] p = { 2, 3, 13, 2, 1, 0, 0, 4, 13, 5, 0, 4, 1, 0, 1, 0, 8, 1, 5, 7, 0, 8, 10, 11, 1, 0 };
        String s = "hvxxkpxcw?hn?xxqlxojhbxpsuhj?t?ii?kzbndjxrvbstceehjmluedcrqsnieqg??besreoopzrosfixvhw?pbwxg?tl?lvxis?o?k?ji?zxckhbnhptam?xcu?i?cts?mnaab???nsoziln?lwti??da?hpmk?vzikechny?jfe?fcv??oz?kigg?sc?ntkrbwkiqtrmes?fhd??ysllqosgbrry???prqcap?l?bmrayg?jn?nennn?nndyky?hma?cdvfmrlar?xlxxrbzvvjrjgklslqk?w??w?liqogecsmmwvp?gdwgllzy?qgle?d?sunnhkgkeokdlq?b?xwcdbazvy?s?rot?lxza?vp?pj?id?dnlnpu??zo?bbppaolxnmkgmttddkedbdqa?azexlluugssqgjbnbwedc??fexlgzf?gdgrbv?tg?qvdvg?czctxit?ki??jkpfxvjsckj?w?oqdnsoiy?apsesqrhjysrrcxoi?xkdxcue?cxxwn?pc?puctcxe?j?a?tge??iyxbql?s?li?spjos?m?wr??gkuo?zzfxs?spwgn?xm?sy?lwm??nb?cnxr?hqymmuz?pgrlttmqvenh?h?ilsldcokbfw?zsxrtkkxpmvn?h?zneibfd?glsihuid?gjcughfdtreyisfrk?o?xkkn?cqoyyeelfyxn?w?pemjjjvvnaovoek?gbbawjjbdai?bhlmy??mki??uxsdvormiscjdd?td?utegc?gxjnw?dormrlaqhnbx???xkidx?s?qmmt??gp?wwzb??g?ovlywtw?pulifk?ruqqw?xrsgyr?vvmjlyolerx?kbsjfkzao?m?ccgfzectqc?mqhigj?ddkkejvoxptln?u??ttgz?jcj?ssuaw???wh?qc?klpejjpltow?cn?f??";
        assertEquals(1015.1489929999941, squarescores.calcexpectation(p, s), DELTA * 1015.1489929999941);
    }

    @Test
    public void case110() {
        int[] p = { 2, 3, 1, 2, 2, 7, 4, 1, 1, 3, 3, 7, 4, 1, 4, 4, 10, 1, 7, 2, 3, 5, 7, 5, 7, 4 };
        String s = "ss?ss?????????????s???????lv??vv???mmxxx?h??hh???????hh?hh???h??hh?lu?uu?u?u?u???j?jj?jjjjmm??m??h?????????h?cc?c???ccc????cc?????y??v????vvvt????t???tt?tx??x?x??x?mmm??m?mm?rh?f??????fss????sf???f?cccc??c?????c?c????cy?z????zq??q?????q??????q?qqh?hf?hfm?g?m?mmr?a??a???????aaa??aaaaaa???a???a?a?????h????o?p?pp??p?????p?f???fff??f??nn????n?nn?n??d???ph?h?k?k?qssyal?l?????m???m?tq?q??q?qqq?????o?o??oo?????l??ll??l?????l?l???l???oo?o?or??j??????uuuuuu?u???un???n???n?n??n";
        assertEquals(584.4833614085842, squarescores.calcexpectation(p, s), DELTA * 584.4833614085842);
    }

    @Test
    public void case111() {
        int[] p = { 7, 9, 7, 2, 5, 18, 4, 0, 12, 4, 0, 0, 8, 6, 1, 4, 0, 0, 0, 5, 0, 0, 8, 0, 0, 0 };
        String s = "hh?hy??yyyyyyyyyy?y?yyyyy??y?e?lll???lxxl?ll??l??ll?lll?l??ll????llll??l??ll?lll?l?l??ld?ss?sbbbxrr?rr?rrc??cc?cc??hhhh??hhhooy?kk?k?kkvvv???v??v?v?vvvv??vv?lll?ln??hhhh?h?hhhlxxxxx?qoooooowf??fffff?ff?fdyy?dd?ddd?dd?d?dde?e?zzz??zzzz?z??zzzzz?zz?zz?z????zz?zz?oooooooo?oo?ooq?r?r?r??jj??jrrrr??rrr?rrr?r???rrrrr?h?h?e??e??nn??nnnddddd?vv?vv?v?vv?vv?vvv?vvvv?d???ddfffff?f?qq???qqq?q?qqqqp??p?p?p??pppp?pp??paaac?c?cc?c?cp?gg???ggsss???s?svnn?n?nefff??ffffff?f?f?f?ffv?vvza?a?aaaaa?a?kkkkkk?kkk?kkkk??kkkkk?kkkkk?kkuu??uu?ou??q??qe?eunnnddddhh?????h?q??qqqqqee?eee??ss?ss????ss?ss?s?nn?n?nnn?nnnnnnr????rrr??rr??rw?????wwwee";
        assertEquals(1094.2290167838264, squarescores.calcexpectation(p, s), DELTA * 1094.2290167838264);
    }

    @Test
    public void case112() {
        int[] p = { 5, 6, 6, 3, 5, 3, 4, 5, 7, 2, 2, 1, 4, 3, 4, 3, 5, 2, 2, 2, 4, 1, 3, 7, 6, 5 };
        String s = "mccc?c??cz?zzzzz?zz?ppoooo???aaa?aaa?ahqllhhg?gyyyyyyy?y?yyy?y?qnn?nnnnn?lliiuff?fyyyjjjj??j?zzzz?zzkkk?nnnnnnn?g??sy??yyyyyyccccc??c?ccccc??uuuuuuu?uu?uuuii?ii?iiooo?aaaaaaaaaaaa?aax?xcc??ccccccccc?c?vwwwwxmmmmmm?jjjjj?jj?j?jjjjjjhm?fffhh?hddd?dbpp?p??pppmmmmh?hheeenn?jv??cc????nnn?n?nnn??z?z??zzzzzzz?z??z?zzzzzzzzwwwwx??x?xpppoo?oooby?gnnkkk?kkkkk?kkkp?pppccuaaaaaa?kkkk?kkk???kkkkkkk?ggg?ggian?x?wwwwww??w??wzzzzzamuuuuuuaa?arrrrrf?fff?fccqnnnqqqqhh??hhhhhhhuuu?uugllll?lll?l?ooooooooopppt?rrr?rrrvvn?nnn?nnndddddaaf?fff?a?d?ddxxxxxxxx?xxxxxssss?szzzzzzzzz?zzz?z???zzzzzzggggw??w?l?lcccll?l?llq?kkkkkkkk?kk??k?kf?ff??ffffff?fff?fk?k?k?kkf?fffnneeeeeee?eeetyy?y?mmmmm?mm?mxx??xxx?xxvvvvvvv?vvmmmmmmmmvvvvvvv??v??vvvvppuuucc??cvmmg??gvvpxji?iiyyyzzq?qjjz?p?gggyy??qddddddvv?h?hwwwwf?ffffd?dddxx?xxxxxx?xxii?iio?o?ooooi?ii?i??iiiiii?imml?l?lll?lccccccccc???cccxkkkhhhhh?mmxxxxwtt???t?tt?yyajj?j?jjjjccccc?pmmmmmm?m?ppmttsffvfffjj?jjmmmzzzzzzjjjjjjjjjjjiiiiiccccc???c?ppyzv?vv?v?v??bb";
        assertEquals(2266.5332773427326, squarescores.calcexpectation(p, s), DELTA * 2266.5332773427326);
    }

    @Test
    public void case113() {
        int[] p = { 18, 0, 3, 0, 0, 30, 8, 2, 1, 0, 0, 0, 0, 0, 10, 0, 1, 2, 3, 0, 2, 10, 0, 10, 0, 0 };
        String s = "??dhxxxxx??xrrrj?jjj?j??j??j??jjjj??jjjjjj?jj?r?rrrrrrr?rrrrr?r?r???rrr???rr?rrrr?r?r???rr?rr???h???hh?h??hhh?hhdd??dd???dddd?ccgg?ggggggggggg???g??g??g?ggggggg?gg??gggg?gggkkkkk?r?n?nnn?nqqgggg?gee?eeeee?ee?szzz?zzzzz?zz?zzzbbtt?tt?t???t?ttttttttt?ttttt?t??ttt?zzu??u??u??uuuu?ux?xxx????xeeeeelddd?d?dd?dd??ttttt?q?qgaaaa?aaaaa?a?a??aalaaaaaaaa?aaaaaa??aa?fff?fff?fftt??ttttttt???t??ttt?tt?tttllxx???xx?xx?vvvv?vkkk?kkkkkkkkkkk??kkeeeee?euu?u???hhhhhhhh??h?hhh?hhh?hjj?j?j??ji??ii?iis??nn?nn?nnn?nn??nnn?nnnnnnnnnii???ggc??ccc??cccc???cccccc?cggg???t??tt?t??????sssssssssppo?oo?oooo?oo??oeeeeeea?a?aaaaa?a??aa?aaaaaaaav?v?vvvv?v?vv?vvl?ppvccccccccccc?ce?ff?f?f?ff???f?f?wwx??xx?xxxxxxxlllllzztttttu??uuqqqqq?mj?jjjj?jj?j?zzz??zztt?tttt?thhh??hhhhhhhhhhh?kccccc??cccc?cccccccccccccnn??nn?nn??n?jjjn?yyt???ttttttjkkkk?k?i?l?l??ll?ll??cccccchooo?o?ott?tss?ssss?sss?s?ss?s?ss?sss??sc??ccwyy??yyyy?yyyyyyyyy??ykttt?t??ttt?pl?lll?ll?w??zzzzdd???d?d?dd?d??ddd?tt?tt?tt?tttt?tt?ttt??t?ooooo?o?o?oooooooo?ooo";
        assertEquals(2296.702535982475, squarescores.calcexpectation(p, s), DELTA * 2296.702535982475);
    }

    @Test
    public void case114() {
        int[] p = { 100 };
        String s = "???????????????????????????????????????????????????????????????????????????????????????????????????????a???????????????????????????????a?aa??????????????????????????????a???????????????a?????a????????????????????????????a????????????????????????????????????????????????????a????????????????????????????????????????????a??????????????a?????a???????????a?????a??a???????????????a?a?????????????????????????????a??????????????????????a??????a?a??????a?????a????????a???????????a????????????????????????????a????????????????????a??????????????????????????????????a????????a????????a???????????????????????????????????????????????????a??????????????????????a??????????????????a???a?????????a????????????????????????????????????????a???a???????????????????????????????????a??a????????????????a????????a????????????????????????????????a???????????????????a??????????????????a??????????????????????????????a????????????????????????????????a?????a?????????a????????????????????????a???????????????????????????";
        assertEquals(500500.0, squarescores.calcexpectation(p, s), DELTA * 500500.0);
    }

    @Test
    public void case115() {
        int[] p = { 0, 13, 18, 0, 5, 0, 23, 13, 0, 28 };
        String s = "??jd?dd??ddddddddddhh?hee?e??eaa?aaaaa?aa???a?a?aa?aaa?a?aaaaaa?aaafff??ffffff?fffffffff?fff?fffffffff?fffff?b?bbbbb?bba?a?a?aaaa?aaa??aaa?agggggggg?gg?g?ggggg?ggggggggg?gggg??gggg?gg?g??g?gggg???gg?gggj?ggg?ghh?hh?gg?ggg?ggh??hhhh?h??hhh?h?h??h?hhhh?h????hhe?eee?e?edccc?ccc?c?ccc??ccccj?jjjj?jjj?jjjjj?jjjjjjjjdd?dddd?dddddjj??jj?j??jjjiii??ii?iiiii?iiii?iiiiiiii?ii?iiii?iiiii?fffff?ffffffff?ffd??ddd???dddddddd?d?dd?dddd?ddd?d?dddddaj???jff?ccd??d???d?ddd??ddddd?ddddd?d???dddddddddddcce?ee?eeee?eeaa?a?aaa???????aaaaa?a?aa?ggggg?hhiiiiiiiff????fei?i?iii?iiii?jjj?j?jjjaacdf?f?ffaaaa?aaa?aaaa????aeeiii?iii?i?iiiii???iiii??iiiiiiiii??i??iiiii??iii?iiiiiiii?ijjjjjjj????j??j?j??jj?hh?hh?h???hhhhhh???h?hhggg?g?gi?ii??iiii??iiiij??jjj?jjj?jjjj?jjjjg?gggg?ggggg??gg?g??gggb?bb??bbbbb?b?bb?bb??bbbbbbbbbbbbb??bbb?bbd?d?dd?ddd?d?d?daa?aeeeeee?e?e?eeeeeee?g???g?g?gg?g?gj?j?jj??eee?e?ee?eeeeeeee????eee??eeeeaaaaa?aa?aaaaaeeeeee?eee??e?eeeeee?ee???eeeeee?ee??ee?e?hhc?cccjjj?jfff?fa??aaaaa?a???a?aaa?aa";
        assertEquals(2463.4311493498526, squarescores.calcexpectation(p, s), DELTA * 2463.4311493498526);
    }

    @Test
    public void case116() {
        int[] p = { 0, 0, 26, 0, 0, 1, 0, 0, 2, 6, 0, 0, 9, 32, 0, 0, 12, 0, 0, 3, 2, 0, 7, 0 };
        String s = "qcc?cmmqpmmm?vvjjjfc?cnnncccjpplqccnduuuiirrrkk?dddqsssffcc?wwkk?xxvmmxawmmmuollttbfwwwwvllhvvvtgvkxxxxddddgrrrr?rksxttttrbbb?bbbbgamcccmmmmndwwmm?mggeeeetllllgggll?lwwmmm?mllp?pkkuddjcccmmkgggggdbbkkbcccccwmmmmffffnnnnkkkkkfddsiii?veeetjjotttttttddcccqqqqccllxkassssseaw?gpvvffffixhxqorrrrrrdtttttbbbbbbpposgpppbdssn?nqssssl?hhhjcccctcc?cmkkoq?qqgawsvvaammwgim?v?vv?gggg?ggggnx?xiihqstgbsuwiiggssrkkikk?kvttoooooonn?niigwegg?uu?jaamdaikkkccvtttfffff?fsbgg?iiiixxxx?lsuuujxpi?aaaawwmmm?ddmmkelllvvhh?h?muqqqiisgggggggaagg?gdprrs?rchhll?ubs??sdddqq?vvglekeeeee?ejjjavvvvvvvvvvfooowgmmmmmmmpfffx?x?wwttte?kfjoxxxdn?nee?embpg?ffnggileeee?www?ww?mmmmgrrvdhfffwcekkkkkkkpm??ttccepppplhqqbss?sssdokjjddddd?dhhseee?qqqjjjjeeeurrr?rrr?tttc?ccuuukpxxohhw?wwelbelmmkccckan?rrrrmheeeeeeellrt?tttttdnddxxxvcceecqlllhcf?fff?ccccjjpppppojjjnnn?uurcljjjdddddhhwwvlliqqstjjjjjjkkk?dffllmlffeouuuuttsuu??buutbbbbqwfxttbbstm?ttwwbcccaaa?kjjftewqqadd?ccceeennnn?nbmos?sggggdsmmkkwkkfx??xxxcccbbbuuulggmmqqllopppp?ffffcc";
        assertEquals(1831.127142999998, squarescores.calcexpectation(p, s), DELTA * 1831.127142999998);
    }

    @Test
    public void case117() {
        int[] p = { 0, 0, 26, 9, 0, 0, 0, 0, 0, 0, 0, 33, 0, 32, 0, 0, 0 };
        String s = "????hhhhj??jg?gggggg?gg?gn???nnp?j?jkjjjjj?aa?b??b?bb?o?o?oq?q?qd?d?dbb?????bq?q?q?n????p????ppkkk??k?kkn????nnn?ncca?nllll?ll?lllaa?dd???d?dd??dddk?kk?k?k?kkkkkk?oo??o?o??oo?kp?p?h?hh?fn?nnn??nnnnn??nliee??k?kkk?k?kkk??k?kkmmmo?o?o?oodaee?aa??a???ahhhhhh?hh?hhh?o?n?npp??ppc????cppeee??oooo??aa?aa??a??????ag?g?ggj?j?c??c?cf???fjkao??ooo?oo??om??mmd?ppp?p??p?pp??ppn??n?nn?njjjjo?o???g??dd????d?dd?dddaaaa?gq?qqqqpqqq?q?d?ddnffff?f?ff??f?f??fff??f?f??ffppppp?p??phhhkk?kkkkkkk?k?k?kcclll?l??l??eb?h??pp???qqqqooo?obel??lllppp?ppooo?oonnh???h??hhhl?l?l??lll?l?llc?qqqq??qqqiiiinj???jg??g?gg??oooa??l?l??lll???lllllll?g?boo???oojjji?iii?i?cco?o?o??oo???o?oiii?iinn??dddpp?f?nnn?nnl?l???llaa?a??g?gg??g??g?g??ggggj?oll??l??l?o???o?p???????p??????p?????p?pp?dd??dddff?oooo??ooooo?o?o??oob?b?bb?bnnffqq??hkk??k?dooo?ooo??o??o?o?o?om?mm??mme?l?lllmm?mgg?gh?f??ii?dd?d??dddd?ll??ll?l?lqiiii????i?iiii?iiii???i?ibb?bbb??h?hh???llo?fffff???ffkkk??k???kkk?kb?b?bb?bbbbbq?qqqqj??knk??kkk????k??k?????k?k??k?hh?";
        assertEquals(1595.7424914985204, squarescores.calcexpectation(p, s), DELTA * 1595.7424914985204);
    }

    @Test
    public void case118() {
        int[] p = { 11, 1, 3, 6, 4, 2, 3, 3, 5, 1, 5, 1, 5, 7, 4, 1, 0, 13, 0, 0, 4, 4, 8, 1, 8 };
        String s = "???????????????????????????nn?????????????????????h????hh???????hw?w??w???????????????????????o???????o?o?????o???????o???o??????????o???o???????o?o???????????????????????o???????????????????????????o???oo???????oo????????ll?????m?m????a??????????p?i?????????l????l?????????????????????s???????sy?y????a??????????????????????????????????a???????a??a?????????????a?a?a?????????aaa???aa?????????????????????????????????????????????a????a???????????????a?a???a??????????????????ay??????????????????????????????????????????yy????????tfk??????????????????????????????b?b?????????????????????b??b??????b??b?b???????r??????????rr???????????????????????c?????????????c?c???c??c???????c?c???????????cc???o??????o????????????o????????????????oo????o???????o???????o????d????????d?????????????????????????????????f??f????????ll??????????????????????k?????????????e???????????exx??????????x??????????????????????w???????????????????????????a??a????????????????????????a????????????????????r?????r????????????????";
        assertEquals(1087.9216626514667, squarescores.calcexpectation(p, s), DELTA * 1087.9216626514667);
    }

    @Test
    public void case119() {
        int[] p = { 3, 2, 4, 2, 6, 0, 1, 8, 1, 0, 0, 3, 2, 0, 17, 13, 3, 8, 5, 3, 1, 1, 4, 7, 4, 2 };
        String s = "???h??????w??xh?w??????ac???????????wh???????????kw??????mr???dss????y????h???????????i???????s???????????????s????????????m?as????l???????z???????????j?p???????sh???????c????????n???el??a?s????????i??o???????????q??q??w??ua?z??j???k?x???p???????????z???j??????n??uu???????????????sz???lx??????????t??v?n???r??????t????o???????u??unt???????t??????p???????i??o?????b????i????????y???t???nw?????h?????h??????q???????????k??????????????l?vf???u????????o????????i?w??????f????????p??u?????c?????????????????w??i????????l?????m?y??????i??????q???????????????????????q??sr??w???????????????b?????p???e???l????????????????????r?v???y??????????????????f?d?is???????????wi???????????????l?????k???c?h?qt?????t????yq??????????????????g???????????????tu?r?zu??????????o?????i?????w?y???????????j?????pfc?????r??????w???r???????d???k?????????c?o???vh?????c?????????fp????wb??bw???o??????????z???????????y????cp?????m??u??????y???????????y??????un???v????m??po???????w?l??????????????????t???n??x????????f?n???c?t";
        assertEquals(1075.7940603335342, squarescores.calcexpectation(p, s), DELTA * 1075.7940603335342);
    }

    @Test
    public void case120() {
        int[] p = { 8, 9, 1, 5, 2, 1, 0, 15, 0, 0, 18, 1, 21, 3, 8, 3, 5, 0 };
        String s = "haaaaaqq?q?q?llbbbhrrggkraa?aakrrrrrr?pp?ccccc?cccjjj?jjjknjjqqqqqq??qqqqqjjjjjjjj?jjj?jhhfffffopbb?bb?acccccc?ccb?bimmm??mmmqq?qdffffffhcc?cccffffjggaa??l?lllleippcgg?ooooooohhlr?lll?lllaakkkffeeeeeoorrmmmmmoooooo?oggggm?mk??kkkkkjjjmmm?m?nnngg?ggggggooorrr?rrrrqqhhhh?dddddddd?ddd?ojjlllppffn?nn?mmnnnc?cccfff?f???ffjjjj?j?hhhlll?lllffff?fffffffjj?jjniiiiiiiii?iggj???jjjjjjjlmmm?mmaaadddddaoff??ffpppqpkg?g?oo?qqqhkkjj?jjjj?jjj?eerhhh?he?e?eeeeeee?eeeeddoood?eoohmdjjkko?ooo?q?qqqq?qoooooo??oooqqql?lllj?jiiiiiioooooo?oomnnnnnnnnnnnnmmpb??o?ooo?dccccccciqqfoolgbbbbbbbbknnfffggg??aaaeeejqqhhoooollhhjj?jj?jjjjjj?jj?jhdddeej?jjgggbblmmmnnnkkkkfkk?kf?ffddhhppggggggffffk?kbbboo?oooeeedddddddddjjjll?l?bb??brjjffmmjddddiiiqqqek?kiibbbbbbbbbbbbn?nooooor?eeeee?eennn??nnnnnn?nfn?meeeeeeoooomdqffppoooorrrrriiiim?mm?mmmmm?mk?mmm??mmmbbb?eeeeeeee?eeemfffn?eeejjjjjjji?okkkkkkkgggggcccaaaaaaaabbbjjjccclllllln?nnn??nn?kkkbijbbbilllaaahh?hhggrrgggooaoooaaccc?ccccc?chhhhhqqqmmmmmmgg?ggggggggggg?g?giddddd?d";
        assertEquals(2376.5785507000164, squarescores.calcexpectation(p, s), DELTA * 2376.5785507000164);
    }

    @Test
    public void case121() {
        int[] p = { 14, 20, 10, 20, 11, 14, 11 };
        String s = "dc?????ef?????f????d??????b?????a????a???????c???????????c?e???????g???????????d???????????b??????????g??????fff?????????g?e?g?a?????????e?a???????????b???????g????f??f????f??????????b???fe????????b?b???d?????g???c????????????e??????g??c??????????????b???f????????d?a??ag???????????????????a???????????e????????????afb???b???c?fd??g??g??????????????????b???????b?????d???????fa?c?????a?????????????d??????????????c???????e??????c??????a????e???c????d??d??????e??????????e????e???????a???f???????????????????????ggg???g??fcg?????????????????????c?c?????????c??????g?????????????b??b??ddff??????c?c?????????????ee????be??????f???a??a????e???????g?????b????????d??ac???gf?????????????????e???????c??e??????????c??c?????d??b?e????ee????????????????????????????????????????f?????b?b??????????ee????e???????b????????????????b?????????????b??a??????????????????d???f???c?d??????c???????g??????c???????????c????c?e?????????????a????????????????????????g??b????d???????????d????????????eaa???????????g???g????";
        assertEquals(1188.5639887539942, squarescores.calcexpectation(p, s), DELTA * 1188.5639887539942);
    }

    @Test
    public void case122() {
        int[] p = { 8, 16, 9, 15, 18, 5, 15, 14 };
        String s = "ggggccccccaaaaaaaaa?aaaaaaaaaaaaaccccc?cccccccffcdggg?ggggg?e?eeeedddd?ddffaaabbb?hhhbbbbbbbbbbbbbbbbbbbb??bbbbggaccccccceccccheeeeeeeeeceddddeeeeeeegggggggggggggbbfdhh?hhhh?hhhhhh?hhhehhh?hhhhhhhhhchhhhhbbbb?bbbbbc?hhdg?gggggaaaaa?hhh??hhhf?fffeeeeeeeeeeccccf?eeeeeebbbbbbbddbbbbaaddcaaaabeeeeeeeaaabbeeeggggggaaaaffff?ff?cccgggggggggbbddddebbb?bbhhhhhhhfccdddbbba?agggggcc?cccccehhhdddddaabb?bbbbdddb?bbggecc?cegg?gffhhff?fe?ebbbbbbbbbbh?haae?eeeeeeeeahhhhhhhfddfffff?ffaa?aaaaaaafffdd?deefffbbbbb?bbbbbbeee?e?bbbbbbbbbbcccehhbbhhhh?hhhgggggggaaaaaaaaa?aa?hhgggggghdh?h?hhhgeeeeeeeeeefffhhhhcaaaaaaaabbbbbeeeeeeeeecccfbaaeeeebdd?ddggggggggffddddhhhhhgfffffgee?eeeedhh?ddddddd?dd?ddddbbccahhhhfgggggggggggggggggfbbbbbbbbddddd?dddddddd??dff?fffffffee?eeeeeaahhh?hhhh?cccggfccccgggggggcdffffffffffffdddddddffeechadddddegggccccccccc?cccchdddddddfffff?feeeefaadgaaaaaaaggh?hhhhffffdddd?ddddaaaaaaaadeehhhhhgggggeefffccccc?cffdddddffffffffddaaagggggghhh?hh?aaaddddddgg?ggggggfffccccccccgghc?ccc?ahgggg?gd";
        assertEquals(3360.292578999999, squarescores.calcexpectation(p, s), DELTA * 3360.292578999999);
    }

    @Test
    public void case123() {
        int[] p = { 1, 9, 27, 27, 15, 11, 10 };
        String s = "??????b??b?bd??dd?????f????d?d???e?g??????????e?a???????f??????????d?b?????????b??b??????c??????e?????b???????d???????b????a???????e???db?c????????g??????????????cb??????????????cfb????afcb?????e?????????fgb??f?b?f???cc?d??g?f?????c??a?????????c?????a???????g??ggg????b????g?????fa??g???????ae???cc???????????????????????????g??c?d?a?a??????e?d???g??e???g???????c???e??????e?f???????b????????????????f?b??b????????b????b?????ed?dd??b??????????????g????c??c??cb????da???d??c???g???de?e?????e??????????????gg???????a?e????ee?????????????????????g????a?g????????f????????f?dd?c???????b??c??????????????c??fbda????f?f???e?????b???????????a????b??b???b???????ba?????e???c??????????bb?a?????fg?????b?????????????f????????????bg??c?f?e?a???????????????bc??????????d???????b?????e?a????????gd??????????????gd???????????a?a?a??e???????d?????b??e??????g?a???c?????b?c????????cd??????????de??e????????d?ea?g?????????c???bd???f??c?????b????geb??????????f??????????c??c????c?f?ga?c????????c????b?????d??ea?ae????d";
        assertEquals(1233.416781281791, squarescores.calcexpectation(p, s), DELTA * 1233.416781281791);
    }

    @Test
    public void case124() {
        int[] p = { 19, 19, 6, 4, 9, 2, 11, 9, 21 };
        String s = "?d??de?ec??b???dddb?bb??cchhhh???hai?g??hdg??e??g?bff??d??ebgf?di????ih?f???fg?i?i??ic?geeaaa???ea??f??h?hd??c??cf?fbhh?fggd??c??c?ai???gg?giiic?d??b???bbdah?b??g??e??e??i?i?effffff?f???fdhhhif???eeif??f???f?iciif?f???fd?ddgadd?ee?d??d????d???d?????ba??????agfc?eecb?ii???ggic???b?cfffi?ii?f?a??eii?chfgfi?iiddi?dd???bbb?fhhia?b?a?aa?ad??dee???ii?ggg?d??d?d?i???ieecc?iif?aaabaif??fbcd?ggg??gggg?gg??d?d?ffa?hhcgdc??cc??ca??g?a????e?h?????cii??????i?g???icc?dd??ddc?c?i?hhhhh?ge?e?gaa?ccc??ee?h?b?dhhh??df???hh?d?dcc?f?i?ihi?ede???eeadgf??ccchcc?f??fg?g???hhc??gge??c?cic?cii???ccc?h???h?a?ag???egc??cch?hec?cd???hhb?cc?ffa??aa??aaaciih????h?hee??f?e??i?ie?e?aa??ae???d?dd??ii?bb?a?g?gff?eg???dd???d??d?f?e?????eheeh????h?d????dd??h????ae??i??dd???d?d??ce??ee?c?cff?f?f?ei?b??c?ce?dd?f???ee????cffghh?cfe?bbffff??f?e?e??h?h?ei?iiccce?ei??iiacb?d?h?a??a???bbb??bhegebe??e?d??e????e??f??f?f?ff?????cfdd?hhh?a?aeebccc???bh?g?i?cb?b?g???d?ddc??c??h??bg?fbbb?bbb??a?a???ha????ad??e?ba?i?i?i?g?g????iicgb??";
        assertEquals(1298.2656740222974, squarescores.calcexpectation(p, s), DELTA * 1298.2656740222974);
    }

    @Test
    public void case125() {
        int[] p = { 8, 7, 15, 8, 29, 8, 7, 2, 6, 0, 3, 6, 0, 1 };
        String s = "?????????????b?????????????????????????????????????????????????l?????????????????????????????????????g?????????????????????h????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????h?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????c??????????????????????????????????????????????????????????????????????????i??i???????????????????????????????????????????????????????????????????????????";
        assertEquals(1182.959865892209, squarescores.calcexpectation(p, s), DELTA * 1182.959865892209);
    }

    @Test
    public void case126() {
        int[] p = { 0, 6, 14, 0, 0, 0, 18, 0, 0, 21, 0, 7, 0, 0, 24, 0, 0, 4, 0, 0, 3, 3 };
        String s = "??????u????????????????????????f?????a????????????????d??????????????????????????????????????h???h????????????l?????????j?????j??????jj???????????m???g???????????g??ff?r????????i?l???????????????i???v??v???vb???b????e?ko??os???p?????p?????????????v??????????t???????t?vt????????????????????????????f?????????????????f??????e????????????o???????????????t??????????t?????i???i??i???????????s?????????????a???????????????????t???????????????q???????????q????????l??lv??????r??????v???t??????????o???l?l???????????l???????d?????????d?d???????????????d?????????c??????????????????c?????c???????????t??k???????????????????j??????????????????????j??????????j???????j?????c????????????????????????????b????????????????gu?b????????r??a?????a??????????vve?????d?????d????????????jc?b?????????????????????????????l??????????i???????????????????????????i??????ccc??s???????????s???????????????????s?j??????????????????????????j????s??????????????u????????????h?e??e???????e???l??????????????????????l????????????";
        assertEquals(1180.5268154113166, squarescores.calcexpectation(p, s), DELTA * 1180.5268154113166);
    }

    @Test
    public void case127() {
        int[] p = { 36, 0, 36, 28 };
        String s = "dddddd?d?ddddd??d??dd?d??d??ddddddddd?d??dddd?d?d?dddd?d?ddd?dd???dddccc???ccccc?c?ccccccccccc?c?c?ccccccc?cc?bbbb?bbb?bb?bbbbbbbbbbbbcc??c?ccaadbbc?cc?cc?cc??cccaadd?ddd?ddbbbbb??b?bbbbb?b?bbb?b?bbbbbb??bbbbddaa?aa?abb?b?bbbb?d?d?dccccccccccc?cccc?cccccc???cccc?c??cccc??cccc?c?ccccccc?ccccaaccccc?cc?cdddddbbbbb?dd??dd?ddddd?ddddb?bbb?bbbb?b???c?cccccccccccccccc??ccda?c?ccc??cc??cccc???cccbbbb?b?b?b??b?bbbb?bbbbbbd?bbbb??bb?b?bbbbbbb?b?bddddd??dddddddddd?d?dddddd?d???dddd??d?ddddddddd?d?dddd?dd?ddd?d?ddddddd?dddd?dd?d?dd?dbdddd???d??dddddddd?dddd?d?ddddddd?ddddddddd??ddd??d??dd?d?ddd?d?dd??ddd??dddd?db??bbb?bbb???bbbbb?b?ad?dd?ddd?dddbbbbbd?ddbb?bb??b?bbbbb?bbbbbcc?cccccaadc?ccccc?cccc?cc???cadbbbbb??bbbb???bbbb?bbbbc??ccccc?cccc?ccc?cccccc?ccaa?a?b?????bb?bbb?bbcccc?d??ddd?d??d?dd?dddcccccdddd?ddc?ccc??cccccbb?bbbddaa?a????a?aaaaa?a?a??aaaaaaaadddd?dda?aaaac?cccccc?c?cccccccc?c?c?aa?a?aaaaaaa?a??aa?bbbbb?bbb?bbbbbaaaaa?a?aaaddcc?ccc?bbb?bbbbbbddddaa?a?a?aaaa?aaa??a?a?cccc??ccc?ccccccc";
        assertEquals(3195.846482445098, squarescores.calcexpectation(p, s), DELTA * 3195.846482445098);
    }

    @Test
    public void case128() {
        int[] p = { 4, 6, 8, 11, 2, 1, 10, 4, 11, 2, 4, 3, 9, 2, 0, 8, 0, 1, 14 };
        String s = "?ll?llllllll?h?ccccccc?c??cqqqq?qqqqqqrrrr?rrr?rrrrjjjjjjjjjjjjjjjseee??eeeeeeee?eeeeeeeeeeeeeiiiiiiiiddddddddd?dddkkkbbbbppp?pc?ccccccc?c?eeiiii?iiiiiiiiissssssee?eeeaaa?aaaaannnnn?n?nn?nnnnnnnnnnnn?nhhhhhhkkknnnnnnnnnnnnnnnnngggggnnnnnnnmmiiiosssaarrr?rmmmmmm?mmmm??mmmmccccclllll?ljjn?nnndd?dddnnnn?nnnqqqqqqqe?eee?eeefhhhhhgg?gg?gggggggggggggrrrrqqqq?qbbbbbbbb?bbbbbb?bbbbbbbbbbbbbbhhhmmmlllleeeeeeedffffffffffffffffccccsmiiiiiii?iii?iieepp?pppp?ppiiissseeeee?eeellllllooooooo?od??dqqqqeeeekkkkkkk?k?kpppppppppppp?ppppppppppffffbbbbgggggccccccc??cccc?cpp?pppppnnpppppbbb?hh?hhhff?fo?oo?ooobbbbpiin?eeeeeeeeehhhhcc?ccccccccccfffffffffffffffffff?ff?fffffffrrrrrraaaaaaaaaaammm?mrrrrrrrrrrrgggggggggggggg?ggggggg??iiilllllls??ss??qqq?qbbbbbb?bbbkkkr?rrrrrr?robbjjjjjjjjjjjj?jjjjjjj?jjjjjjjjaa?aaaaaa?aaaaaaa?aaahhhhhhhhggggqqqq?ggiiiieeefffffffffff?ffffrrrrrrrccceeeee?eeeeem?m?m?moo?oooggggggg??glllllllqqqqqqqqfffffffffjjjjjjjjbbbbbbbbbbjjjjjjjjjj??jjjfffffffffffff?ffrrrrrrrddddddddddddd?hhnnnnnn";
        assertEquals(3974.691334160017, squarescores.calcexpectation(p, s), DELTA * 3974.691334160017);
    }

    @Test
    public void case129() {
        int[] p = { 25, 9, 36, 30 };
        String s = "ca??aaa?aa?a?aa??ac?dddd?b?bbc?dabb?bb?bbb??b??b?bdd?dddc????c?cccbbb?aa?ccccc??b?aaaaaa?a?cdddaaaacc?c?cccca?aaaaaaaaa?dddd???dddd?dddddbbbb?c?c?ccd??a????aaaaaaa?aa?aac?cdddddd?bc?c?ccc??bbbbbb?bbd?dd?d?dddd?d?ddddcdad?b???bb?bb?baaaa?c??cccccccac?cccc?cccccbbbbbbbbcc?ddaaaaaaddd?a??a??cc???c??ccccbdddaa?accc??c?cccccbbbbbbbbb?bbbdd??daaaa?a?adddddab?db?ddbbbbc?d??ddb?dbbbbbbbbb?bbcdd?d?d?d?bbddb?d?ddddd?ddddbb??bdaaaaaa?aaacccc?ccc?c??dddddd?a??acabddddddaaa?a?a?aaaa?bbbbbbbbcc???cddbbbbb?a?a??adcb??b?bcdd?dd?aaaacc???ccc?cc?c????cccddd?bbb?bda?a?aa?a?aa???aaaa?a????acaaaabaaaaab?aaa??ad??b?bbbb?c??bddb?bbbb?b??babb?b?b?bbdaa?aaab???dddd?ddddddddcc?bb?b?bb?bbbbccc?cccccccccddbb?dddaaa?aabaaaa???dd?ccc?aaaa??aaaaa?aa??dcccaaaa?aaa?a????aaaa???aa?bbbbb?cddd?ddaaacccc?ccbbb?bbbcddd?daccccc?c??cc?ddddc?ccbb?bbb?aaa?aaabddd?d?d?a??aac?d?dddccc?b?aaa??ad?ddddc?c??cdb?bbccbb?bb??bbaaa?aaa???a?a?abcddbbbccc??cccdd??da??dddddd?da??a?aaaa?bbbb?c?cb?bbbd?a?c?cc?ccc??caaaaaacaaa?aabb?cdd??dbbbb";
        assertEquals(2366.6677626282044, squarescores.calcexpectation(p, s), DELTA * 2366.6677626282044);
    }

    @Test
    public void case130() {
        int[] p = { 21, 13, 18, 23, 16, 9 };
        String s = "?????c??????????????????????c??c?c??c?????????cc???????f??e????????f????f????f???f??????????f????f?a??a???a????a???????a????e?????e???????????????f???????????????????????????c??????b?????????????????b?e?ee??e???????ee?????????????a??????????????????????????????a??a???????????????a???????????a?????a????????ab?b??b???????a???????????c?????????????????????????dc??a??a????a????????d????????d????de????????e????e??????????e??????????e????c????????????????????????????????c?????????????????e??????????e??????ff????f?f?????aa???a???a?????a????aa?????a???????a?aa???????????????????c????b??????cc????????????e???????e???????????????????????e??????????e???????????a??????????a???????????a?????????????a?????aa????????????????????e?????e??????????c???????????c?c????????cc??????????????aa?ae????????????????b?????b??????????????????????b???????????????????c??a??????????????????????????????a??????a???a?????????f?c??????c???????c??????????????b???f?c?c?????????????a????????a????????????????????????????????";
        assertEquals(1234.2885088004427, squarescores.calcexpectation(p, s), DELTA * 1234.2885088004427);
    }

    @Test
    public void case131() {
        int[] p = { 0, 1, 6, 3, 11, 3, 4, 3, 3, 4, 2, 7, 1, 10, 7, 1, 5, 6, 4, 3, 3, 2, 4, 3, 1, 3 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????m???????????????????????m??????????????????????????????????????????????????????????????????????????????m??????????????????????????????m??????????????m????????????????????????????????????????m??????????????????????????????????????????????????????????m?????????????????????????????????????????????m?m??????????????????????????n???????????????n???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????n??????????????????????????????????????????????????????????????????n???????????n?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????n??n??????????????????????????????????n????????????????????????????????";
        assertEquals(1060.7124324324927, squarescores.calcexpectation(p, s), DELTA * 1060.7124324324927);
    }

    @Test
    public void case132() {
        int[] p = { 74, 26 };
        String s = "???ab?abaa?ab?a??baba?b???a????bb?????b???a???????b?a?ab?a?ba?aab?????????b???bb?????b?????b?b??b???????a?ab????baabbabb????aaab?ba?a?a??aa?a??b?b?a??b??????bab?b?????aa?aaa???a?baba?b??baa????baa??abb??????a??bbbba?bbbab?????b????abb?a??baba??a??a?a????b???b?a?????bb???a??babbbbb?aa?b??b?a?a?????a?b?a?a?ab??b??bbbb?a???a??a?b????a?aa??b??aa??????ba?????bbb???b???bbbbbb????aba??a?ab?bb?????ba?a??bb?a???a?a??????a?abb????????aba??aa??b???aa???a?????aaba?ba?b??aba???????????a?bbb??b???a???a?a????baa??a?bb??a???aaaa?aa?baa???aaabb??b???a?a??????a??aaa?b??bba????????a??a???bba?b?a?a?ba?aa??aa?????bb??b???ab??bba?b??a?b???ba?bbb?a???a?????aaa???b??b???b?a???aaa??b?b??ba???aa?aab??a?a?????ab???a??ab??a?bb????a????a????a?a?a?b?a?b?bbb???b???b?b?baa?bba????bb?a?aabb?b?aa???????ab?aab??????????a?b?abb?a?a??a?b?aaa?b??b?aab????ab????????aababba??bbb?aba?abb??aa?bab?a??a?b??baa?bb?aa???a?a????aba?aba?????b???a?a??b?????b?ab???a??a??ab?bab?a?ab???????a??a???a?b?a?????aba???ab?a??bb?ba???????a??a??";
        assertEquals(2456.0898312851086, squarescores.calcexpectation(p, s), DELTA * 2456.0898312851086);
    }

    @Test
    public void case133() {
        int[] p = { 8, 2, 8, 3, 7, 5, 4, 35, 7, 21 };
        String s = "?b??????b??bb??????bbbffff?ahcgg????g??g?gg?g?gg?g??g????b?b?ed??d?h????????h?hhh????hh?????hh?????h??h??????hh???hh???hgg???g?gj?j?c?cc?????c?c???ccc????c??c??cc???c??cc?e?????e??e???e?b????b?bb????b?b????aaa??a???a???a??a??a?a?aaah???hj?f???????ff?f?fdd????d?d???de?eii?i??i?i???i?i??i?c?c???c?cc???c?c???c?c?c?c???hhh??h?h?hhh???h??hh???h?hh?i???i?i?i??i?i????i?iii??i????ii?i??i????ihh??????h?h?h????h??????h?e?e??e?e?e??e????ee????ee??????ffff????ffff??b?????bbbb???b?bb????bb?b?????b??g????gg??g?g??????ggg??j???gg?gb???b???bbbb??jjj??????j?j?jjj??aa?aa???????a????????a?ad?d?d?dd???d?dd?dd??d??d?dd?jj??jj??j???j??j??????a???a?aabb??b???b???bb???????b???b?????b??b?b???????j???????j??jj?jh??h?h??hbbbb?bb??b????b??bb?bb???b??????b??b?????bb??b?bbb?bb???b??b???bb??b?h????????h??????f?f?d???dd???d??ddd?d?d??d??d???????dd?d???d?ddd?????d???d??d?dd?d?????d?dd??????d?de?e??ee????????e?bb??b?bccjj??j?j?j?j?jj??jj?c??c??c?????c??c?????g????gg?ggg?b?????b??j??jjj???ii??ii????i????i?????????c???c?";
        assertEquals(1342.856728558564, squarescores.calcexpectation(p, s), DELTA * 1342.856728558564);
    }

    @Test
    public void case134() {
        int[] p = { 15, 15, 3, 13, 10, 14, 30 };
        String s = "????????ff?g????e????e?????????e????????a??aa?????ae??????d?b?b???aa????a?a??a????ga??a?????aa???a?a?a?a????????cc??a???c????c?c????c?????????????cbe????e??e??e??????????????e?????e???e???????e???e???????e????????????????e??????c????c??dbb???g????????????????e??????????????b??b?b??b???b??????????????????b??????db??b?fc???????????c???????d???????cc???a????????e??????????bb?e??????e???????????e????????g????????e?e?????????????c?????c?d?????a?????????f????????????d?e?????g????c?g?????g?e???e?e??e??????e?e?????????e?????e??fa???a?????a??e?????g??????????f????????????????????????????b??b?bf??????f?????a???d?gg????gf????f???a??????a???ec???c?c????gg???????b???bg?g????g?????f???????f????bb??????b???d??d???d?c??????c??a??????????b??bff?????????f?f???????????f?f?????f???????f?f?f?e???e?????????c?????????c???ff???a??????g?gg???ggg?????????a??ag????g????gb?b?b?b??????f????e??e??ee???ea???a???????????????aa?????????????c???ccc?f????????f????????f????f??c???????????????????b??????b?b?b???f??f???f??";
        assertEquals(1232.5936183498964, squarescores.calcexpectation(p, s), DELTA * 1232.5936183498964);
    }

    @Test
    public void case135() {
        int[] p = { 10, 2, 2, 4, 11, 5, 12, 2, 6, 4, 7, 1, 6, 9, 5, 1, 6, 4, 1, 2 };
        String s = "i?ieh?l?sto??ikqmbe??k?h?h?hrm?cpqhpnkkjf??nsbdf?ftk?qiddlem?gk?h?kh???hqnlg?e?eppaaee?t?agaa?thhbqnn?sq?fkqk?mbktmptnl?eetsp??cjiojrlk?eeccadl?ll??qkjeps?jd??ie????ppttcco?ppsspcr?lfrmfhq?bmeor?prklr?lt??fbb?l???qa?apbb?t??n???saj??pefhssll?mf?asobqo?da??o?elr?f???l?jdbbhoj???qel?r?tti?c??ng??eapkkoes?edrglsa??rdsjse?tlatbkooekm??qfts?jiiiatmkaaiidqhff???crab?c?mckhqaeeoqf?o?illfddglbbm?olmpmtdndeeqschbr??bbcebejmdkomntnqcc?c???tpfnn?cfigk?ghe?hmpc?ejjj?hhtthij???jkcnnnrcdhtf?dapms???k??f???beeirdtdttc?hf??mkdbk?bf?fbhqt?kbmt?i?ij?hbgi?ioekpihls?r??jqjbr?hcakfodp??c?gg?ihfq??r??qblegro?s?nnnn?nnnoa??gghrosbao?q?ppmo?cdqqqr?s?oo?igl??j?knqq?r?apb???qlo?m??j?ddoh???rrccsggh?o?nsr?rc?cc?n??p?pbnod??jdcaooogaaa?g??ggb????d?otb?jcgleml?j?cjlb?ahhcoiia?bnsjpbbec?o?ooqk?jip?o??hqfmhoo?oogf?hf?sseodhkdhjg?q?el??ggao?oe?lq?d???dddtdddbtgha?tk??qd?qcotti??j?q?dggk?eis?bq?fne?r?m?a?lerr??p??lliihrrassnfgglh?msdrrrci?e?mmtom??im??fs?fne??o?bs??????lt?me??ph?mkfqtojjigmn?nd?hckhhhs?imrmfcgs?ni?st?";
        assertEquals(1137.296177925077, squarescores.calcexpectation(p, s), DELTA * 1137.296177925077);
    }

    @Test
    public void case136() {
        int[] p = { 8, 6, 10, 10, 6, 11, 5, 7, 5, 3, 1, 3, 1, 7, 4, 7, 6 };
        String s = "??o?????????o??o??????????o??????????????o???????????????????????????o???o???d??????????????d?????????????????????d??d??d????d?d????????dd???d??????????????????d?????????????d????d?d???d????????????????????????????????????????dd?????d?dd???d?????d??l???????????????????????????l???l???????l?????l??b???b???????????????????????h?????????h??????h????hh???????????????????????????????????????????????h????????????????????????????????????h?q?????????????????????????q???????????????q?????????q??q?????q????????????????q???qqq???????????????q?????????q?????????????????????????????????e????????????????????e??????????????????????????????????????e???e?e????e???????qq?????q?????????????????????????????????????q????????q???q????????????q??????????????????q????????????????????????q????????????q?????q??????????????????????????????????q????????????q??????q??????q?????????????????????q?q????q?q????????q??q??????q????q?q???????????qq???qq????????????????????????q?????q???q??????????????q????????????q?q?q??";
        assertEquals(1089.0939008059736, squarescores.calcexpectation(p, s), DELTA * 1089.0939008059736);
    }

    @Test
    public void case137() {
        int[] p = { 2, 8, 7, 6, 5, 0, 0, 7, 5, 5, 7, 2, 1, 2, 5, 5, 6, 4, 7, 9, 5, 0, 2, 0 };
        String s = "??????????t????v?????q????t??t???????b???h??????t???????????????t?s?s?ap?r??????snn??????j??j???j?????jd??dx??l?n??n???n?????f?f???f?c???c?t??t?p?????e?????w???ff?????????f?????????????d????d????dw????w???ag?????????q????e??po??????f?nlln??n????v?vvvv???????v??????????p?pb????ck????????k???????kv??m??mm?s???f?a???????k????????????????m???u???u??jk?r???????r????r??????n???g???g????dd???dl??l??f?????f??????????????f???f??x??????e????jj?????j??j????????j??????jj????j???????j???f??h????a???c????c??b?b?i??f???????h????????h????e????????????????dc????????????c?c??c?????g?q?????e?e?e????d???bbb?o??????dd??dt???t????ee????d?????mi?i???x???xt?b?t??t?????m????????c???????c??????c???????jj?jj???h?w?????????????????????j????j??r??h?????x??p????j???????????????????w?????v??????????????va???????h?????????q??q?????????v?w???w?t?k?????????k??k???g??????g????????????????a??????a??e??j?????j??o??d????ll??w?u????????????x???l?l??e?????p?p?u?????vee??i????????ix?x?????????????r?r???????l???????t??tg??????";
        assertEquals(1078.449277658447, squarescores.calcexpectation(p, s), DELTA * 1078.449277658447);
    }

    @Test
    public void case138() {
        int[] p = { 1, 3, 11, 7, 17, 3, 2, 2, 0, 2, 2, 1, 2, 0, 11, 0, 5, 9, 4, 0, 4, 13, 1 };
        String s = "????u???u?uu?????u????u??uuu??????????u?uu???uu??u?uu??u?uuu??uu???uul??l?l????l?????l?lll??l?????ll???b??????????b?????b??b????b?b??www?ww??w?ww???w???w??w?????w???wf????ff?f?f?????f?f????????????c???cc?w??w?w????ww?www??l?l??l????lvv?v???v?v???????vv???v????v?vv???????v?vvvv?v??v??????v?vvv??v??re?ee?emm????m???m????mm?mm???????????????m??m??????m?m???m????????m?m???m??m??????m????????i?????i?????b?????b?b?oo??o??oe?e??ee???????e??q?q?????????????????qq?q?qq??qqq???q??qq???q???qq??q?qqq??q?qq????u??u?uu????????u?????uuu??u?????u?u?u?uuu????a?a?????aaa??????????a??a?????????a???a?m?????m?m??m?m??mmm???????????m?hh???hh???h??hhhhhh??hh??????hh?h?hh?h?h???hh???h??h?h????h??h?h??h????h????hh?h?hh???????h??????hh?????h?hh??h??????h?h???d??d???d???d??d?????d????drr??rr??r??r?r???r?rr?r??r??????r?r?????rd???d?dd???????d??d?????d?d??d??dd?d?d????ddd???dd????d???d?????dd???????d???????d??????d?d?d??d????????j?jj?f??f??????fff????fff?ffj???j??j????????j????j???j??g?g?g???????????????g?????g???";
        assertEquals(1197.5391270078876, squarescores.calcexpectation(p, s), DELTA * 1197.5391270078876);
    }

    @Test
    public void case139() {
        int[] p = { 13, 43, 15, 29, 0, 0 };
        String s = "??afefe???ee???bbde??c?afe?eee?dda?a???ffaedd???d?cc?caa?cc?ffffa?af?fbb?b??fcf???acb?faf??fbbfd?d??a?ec??b??edccf??c?e???ecce??fafabedbbfd?d?f?cccca?ccccdd???cded?b?c????a?cffdb?fb?b????ceed???c??c?ecc?e?eada?d??ddfc???cae?a?ee?cc???cc?fa??eddbbbbab?b?b?bfb?cfccafeeeedceebebdebbdd??a??a?ac?cbb?b???fdb????bb?e?dadc?aeccaa?aaddd?dbd?e????bbff?b?e??fd????bb?f?fceaaa??adff?fbb?dfacfbed?????cba?ef???????cddadedbfd??dd??c?bae?cddd???bb??eabcf?ef??ff?d?d?abf???ffccd?d?d?dccd???dbc??ca?bbcfdd?c???dfbe?fbb?cce??d?a?a??e?e?ddeaa?a??ab?be?e?f???a???cfacc?bccbcec?feeeee?ca?fff?fba?ebbcc?b?abce?d??deacccfc?cf?ccede?aa?c??bbc?df??aedaf??e?edb?cebffabfccc?ce?dbbeb??d?c?af?d?bb??afbdf?fccfcfaac??bd??ddddcbaaa?feee?dec??cca???bb?ae??c??c?e??cfb?c?dd??d?ce?f?f?fc???ac??bea?e?f??bbb??bbeca?a??e?ec?cd?eeaffd?d?dfffc??c???bf?bfa??afb???ee?fddd???d??bb?b??b???dcbb??fb?b??f???fcff??d?dedbeeaeeeab??b????aadaab?b?bc?c?defbe?????debbb??bee?ce??dbcfb?bb?e?a??a?bb??fd?d?cb????d?dd?ff?f??f?df??cff?fff?b??bccc??ea";
        assertEquals(1384.3744529757269, squarescores.calcexpectation(p, s), DELTA * 1384.3744529757269);
    }

    @Test
    public void case140() {
        int[] p = { 13, 0, 0, 0, 3, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 1, 23, 0, 0 };
        String s = "bpm???es???kvk???gqc??vn?s??j?bec?jf?gj??c?u?he??u?doj?pf???k?ml?m????uppog?ag??efdnn?gw??h????q??????u?h??kg??f??t??jjs??dwqho??tgn???od????n???k???g?ujd????tnw????hje?o?m?b??b?fl?h??fjtkl?p?g?hc?wt?vwo??????kg?f???ectjv?bnff?n?t??c???wnha?ju?w?????p???cus??pid??ti?r?g?jf?m?dl??p????????k????m?vamni????r??bl??m??p??c?h??p?a?m??buaaa???la?tu?ha????t?f??qkdh?trr???sea?qortvn??wsfwj?umv?s???p?????e?j?b??g?n?w?gq???b????udu??u?uu?vc?ap?ms?h?jwif??wuf??uesfsu??l?d?i??fgongmbbtobktcss??ir??????rdk?a???o???fmvvjs?r?dw?ae??bjh?l??mmrc?boddi???ounj?n?qs??tn??a?vomilbs?jpatm???nscwv??q?h??jqj???vw?u?d??????hu?d?l???hue???ug??s??????ll?m?v?qr??b?w?ddfd????or???q??????nw?d?ikno???p?????ai?v?t?s??u??t?tb???o??s?rop????dj???i??lkc???t??w?cu??i???oe?bovl?t??d??ee?e?g?????????au?s?grp???e?w?dqc????nrm??dp????nn????t?t??w?qp?ovr?s??b?d?l?o?k?f?vq?c????k?v?u?qir?g?l?f??imapk?pw????n?t?q?l?st?k?u?ntkafg??hgncc??pb?ws??????q??wr??fijhci?m?o??k?w??w?mihf??????smw??o?t????fb??k?guos??cl????k?i??l?uv?msq?sw";
        assertEquals(1148.997183295833, squarescores.calcexpectation(p, s), DELTA * 1148.997183295833);
    }

    @Test
    public void case141() {
        int[] p = { 8, 4, 1, 15, 9, 14, 14, 3, 6, 0, 17, 9 };
        String s = "h?h?i??l?jj?h?????f???f??f??f??h?h????d?a???aa?h????hkkh?hhk????kkee???j?gff??f??f?l?ll?hh????h?d???d??d?????dg????gee???????e?df???f?????f??f??k???gg??ha????ff?fihc??c?d?????????????k????????cbfd?d???j??j?????j?b??ll?icc?ccib??b????????l????ll????lff?????lbbb?b???kj???bb?b?b???k?????????d?d?c????c??????i??j?????h?h??h?hg?k??g??g????d?d?dd??l?l?l?bffe????jc?????cb??b??g?l?l??a?cede??e???ee????????bkle?e???????????a??ij???jg??dl???l?ag?ffc????c?c???????????khdg?ff?f????l??ia???eeff?i??i??i?????i??ee????ej?j??d?c?ffe?e???b?e??cc???cc???eeee?e?h??h??hh?????h????ghh?????????????????c?????c???c????c???d?f?dk?????ccea?a?jj?jcf???fff?f??l?k????kk????????ka?g?c?h?j?d?????kll???gg????jjj?jb??be?e??e????????e?b?i????bg????bbbi?i?i?i?????l?l??l?j?????j?jj???b?ef?gjb?b????ff?fjl?????ee??f???f??ff?fff?li?????bi??i?ic?f??gg?gl???lll?e??ldig??????giee?e?egll??l?jc?h?????h??lee?bb?bb????j????jj?g????g?????g?????d?e???e?e??h?hhc???c?iidll??ld???d??d?d?b???d?d???d???jd????hjjj?ji?h?h?i??k???k???????b?bi";
        assertEquals(1186.1692614350686, squarescores.calcexpectation(p, s), DELTA * 1186.1692614350686);
    }

    @Test
    public void case142() {
        int[] p = { 14, 1, 3, 82 };
        String s = "d?da?a?ad?b?db?c?aad?ddd???da??c?a??cc?b??c?d?????dc?cb?cd???????ab?ccb?a??????a?b????d??a??dcd???d??dc?cc?dcd??c????dd????aacdcaa?bc??c?dc?dbccb?cc?cbdda????db?acbd?c?b???cbc??b???d??d?aadd?dddd?ac??b?b??????dda?a????b???bd?dbbbdcba???dc?bc?cbc???b?b?dcb?b?a??d??d???c?dbdcca???bdcb?a??a?????bacdcaab??a?c?c????baccabd???a?d??abdbbca????aadd?d??d?dcbc?d???cd?b?bc?dbd?b???c??addba??caabb?bbc?cc?d?ccb?dca?bc?d?cacaddddbbddcaac?dc??b?a?ab??ddd?cd?b???bdbb?bbb???baddcabdcc?bcb??db?ac?????d??dca?bda?d?a?bbc???bb??dd?ba??cb?cc???c??d?a?ca??ddabcbbddc?d?cd?d???dab?????addac?a?????cc?adb?d?c???ca?ad?c??aaddd?d??a?bb?d?bcb???cdcc????a?bdd?cd?a?bd?d?d???bbad???b?b?bd?bb????bda?db??bda???cbcbdb??abdc??c?ccc?b?cabcd?d?a?dba?bccdb?bd??ddacadac?caccc??d?d?bbc???acc?ca????a?b?bbbbac?a?daad?d?a?b??bddddcc?caa?c?b??b???ba?a?a?ad?a?b??a??b?bab?d?ddd??bb?bbbbb??aa?a??d???bdc??????ca??????b?dabb??bbb?c???cb?d??db?bcbd?d?dc?b?b?????cb??b??b?aacc?bad?cb?c?ddbbbbd??adbba??cc??dbbdd????d???cbab?aaaa?a?a?ddbcaa";
        assertEquals(1734.2577208302855, squarescores.calcexpectation(p, s), DELTA * 1734.2577208302855);
    }

    @Test
    public void case143() {
        int[] p = { 8, 5, 11, 15, 16, 11, 6, 10, 2, 6, 7, 3 };
        String s = "kkkkkkkkkk?kkkkkkk?kd?ddkki?iiiiikk?kkkk?iiiiiiii?i?iiiaaf?ffffffaddddddddd?dd?d?dlll??f?kkkciiiiiiceeeeefdddddddddde?ffffff?ffffffffffffffg?ffclleeeee??e?ecccc?clllkkkkkddddeeaaee?ee?eddfjjjjdddddddd?ddhhh?hkkkkeeee?eeelllllleeeeee?e???e?ejjcccccc?fkccc?fffffffddd?b?iibbijhh?def??f?f?ffffffjddd??dddddddk?kkkkkkkkkgggg?glll?lddd?dddddd?ddd?h?hhhhhhhgdddddddl?eee?bbbb?bbbbb???bggfffffffjjffffffffddi?k?kldddgg?gggggggbbfffffffggii?aa?aaahhkkkkkklllllbiiiiiiieeeeeeegggl?llljjjj?lih?hhkkkkkkkii?iiii?iihh?hhhee?ebbeggg?kkggggggggghhjggggddd?db?bbbddgggggj?jjgggg?gggg?ghhhhhhhhhheee?ebbbbbbbgiiiddddce?eeeegglll?lll?lkkkk?ki?jjj?jjjjj?j?jjjjjjkkkfekjjliiiiceeb?fllbbfdddddddeeeeeaaa?acccddddjjiid?cfffdddaadddddd?fkkkkk?gkkkkk?e?hhhh?hllllll?ddddd?dddehhcciiiiilllllll?llb?bbbjjjl??kk?kkfhhallllllbbccgggggbbh?hhhhhhh??ll?aahhhhhhcaabbk?kbb?bbffffll??iiiii??ll?lhhhhffjbkkkkkcaaa?a??aa?aaaaakaaaa?aijjh?hgfc?cbbbbb?bbbbbbb??bb?ggeeeeiiiff?dddii?iffghdfaaaaa?acchhhhhh?bbbbbbikg?gef?ffddfllj?jggggggg";
        assertEquals(2640.421532021409, squarescores.calcexpectation(p, s), DELTA * 2640.421532021409);
    }

    @Test
    public void case144() {
        int[] p = { 100 };
        String s = "a?aaaaa?aaaaaaaaaa?a??aa?a?a?a?aaaaaaaaaaaaaaaa??a?aaa?a??a?aaa??aaa?aaaa??a?a?aa??aa?aa?aaa?aaaaaaaa?aa?aaaa???a?aaaaa??aa?aa?aaa??aaaaa?aaaa??a?aaa??aaaaaaa?aa?aaaaaaaaa?a??aaaaaaa??aa?aaa?aaaa?a????a?a??a?a?aaaaaaaaaa?a?a?a?aaaa?aaaaaa??a?aa??a??aaaaa??a?aaa??aaaaaaaaa??aa??aaa?aaaaaaaaa?aaa?aaaa??aaaa??aaaa?aaaaa??a????aaa?aaaa??a??a??aa?aaa??aaaaaaaaaaaa?aaaaaaaa??a?aa?aa?aaaa?aa?aaaa??a?aa?aa?a?aaaaa?a?a?a?a?a?aaa??a?a?????aa?aaaaa???aa?a?aaaa?aaa?aa?aa??a??aaaa??a?a??a?aa?aaaaa?aa?aaaa?a???aaa??a?aa?a?aaaa???a???aaa??a?a???aaa?aaaaa??a?aaa??aaa??aa??aa?aa??aa??a??aaaaaa?aaaaaaaaaaaaaaa?a?a?aaa??aaaaaa?aa?aaa??aaaa?aaaaaaa?a?aaaa?a?a?aaaa??a?a?aaa???aaaaa?aaaa?aa?aaaa??a?aa?aaaa??a?a?aaaaaa?a???a?aa?a??a?aa???a??aa?aaaaa?a???aa?a???aaa?aa??aaaaaa?aaaa????a?aaaaa??aa?aaa??a?aaaa?a?a?aaaa??a??a??a?aaaaaa??aaaaa?aa?aaa?aaa?aaaa?aa????aa??aaaaaaa???aaaa?aaaaaa?aaa?aaaa?aaaaaa?aa??aaaa?aaa?aaaaa??aaaaa?a?a???aaaa??aa??a?aaa??aaaa??a?a?aaaaaaa?a?aa??aaaaaaaa?aa?aaa?aaa?aaaaa?aaaaaaa?a?";
        assertEquals(500500.0, squarescores.calcexpectation(p, s), DELTA * 500500.0);
    }

    @Test
    public void case145() {
        int[] p = { 100 };
        String s = "????????????????????????????????a???????a???????????????????????a???????????????????????????????????????a?a????????????a?????????????????????????????????a???????????????????????????????????????????????????????????????????a??????a???a????????????a??????????????????????a?????????????????????????????a???????????????????????????????????????????????????a?????????????????????????????a?a???????a???????????????????????????????????????????????????a???????????????????????????????????????a???a??????????????????????????????????????????????????????????????????aa?????a????????????????????????????????????????????????????????????a????????a?????????????a???????????????????????????????????a?????????????????????????????????????a?????a???????????????????????????????????????????a??????????????????????????????????a??????????????????????????????????????????????????????????????????????????????????a?????????????????????????????????????????????????????????????????????????????????????????????????a???????????????";
        assertEquals(500500.0, squarescores.calcexpectation(p, s), DELTA * 500500.0);
    }

    @Test
    public void case146() {
        int[] p = { 4, 9, 2, 2, 0, 7, 2, 7, 9, 8, 6, 6, 8, 10, 9, 1, 8, 2 };
        String s = "lmmiidlllllmmmmmmblllllllllrrboooiiiiiaaaiiiggghhhhhlnnnnnopppppppqqffff?firkknnnfmrrrrrhaaaaaaaaaaaqqlllddrrccciiccdrjjqqqqqqqeecccccccccrrrnnaaarqqqkkkeooooddeeeeeoooqqeeeeeeelllkkegggdaaooooooobbbajjj?jllllllllgggggbbbbbbbfffffppqqqhqqqggggggmmmelmmmmeeeeeeeqcgfffbbbbbbnnkkeeeeejjjjjmmmllllhgogglllpqaaaaggaaagiiiimmmoorjq?eefgfcchhepaadbnjjjjjjjeegggppaaaaajjjjjjjjjnoooj?jjjbiiijjjjjggggggjjjjmnniiiiiaafbrdddmmcccdddddddbbiarbblikeaaaaaabbbbbbbbbmhhhfbdddggnbmmffeeeeelllllllljjjjjjddddddddddddiinnappppiikkooonnddcbbbbbbbiiaaaaaaammmmmeeeeiiggjgmmmrlllbnnnnnnnnnfjjmmmmpkkbbbbbbbbbbb?ppingggggbbbrrrrrrrrrrrrrmmmmiiiiiiiijelffffffffaadppaaappippppaapqqmmbbkahhggjjjddcjkkrrmmmmaaaajmmlccjjpjcchhheeddccpnnnnnnnneclhh?ddddefffkdjjjjjjjjjjjjcqqqggggccccccchhdnbbbghgrdiidaehhhhhhddqjjjj?jjjffffhqhhhnfdbllaqaorrnnokjjjrrrrddlqqiiiiiiiqqqqeeeqjbbbggaaaaaaaallkkooooooohggggghhhcdbiiiiiikdqqqqqiiooojfffeecgdddddddpjjjjllllllllnllllllllldhacggghgggggbrrrrjjjhhhrqmmoojjjqqqqqecrrqqakpkdddkdjrrrrf";
        assertEquals(2739.580000000001, squarescores.calcexpectation(p, s), DELTA * 2739.580000000001);
    }

    @Test
    public void case147() {
        int[] p = { 3, 5, 3, 3, 7, 3, 6, 9, 8, 6, 2, 6, 5, 3, 1, 4, 8, 10, 8 };
        String s = "b?????????????????b???a?dm????m?????rh?c????d????k??????k?????kk??????s???s???????k??l?????????p??ki????i?????????????e??e?e??????????????e?fc??????????c????????????c???????????ce???????d??d?????d????d??????????d???d??d?????b??b??b?m?????m??mnn?d??r???r?????r??????r??????????????????g?f????f?b????????????????o??????o????o?????ob??????????????????nn????a???kk???k???????k??kl??????????????l?????l???????g?g???????????g???p???g???g??r???q?????q????q????q???i?i????m?m??m???m????????????m????m?????mm?????????????g??m???p????????g???d?????c????c????p?????b?j????j???j??????????j??????k????k??????b??????b????????????m????qb???lf???f??????????i??i???????i??p??p?s??????????????a????????????a??nj?????????????????j?j???????j????????????b?b???b????b??????pp??pp?p?????pp??pa??r?????r?????c?d???d???d?b?????m??????m????????f??f?f????f??????f?????????????g???????????????????????g????k??f?f??????b??b?????bbb??????b?????????????g???????????????rss???slljb?b??j??j???c????c??????cc?o?h????r?rr???????g?q????";
        assertEquals(1078.7644590485395, squarescores.calcexpectation(p, s), DELTA * 1078.7644590485395);
    }

    @Test
    public void case148() {
        int[] p = { 4, 5, 6, 5, 6, 4, 4, 12, 6, 4, 1, 2, 0, 11, 2, 7, 5, 3, 4, 4, 5 };
        String s = "nn?n???g??g???cc????c??cc?????m?g??ggg?ff??????f???g??g?????hghm??mq??????q?qq??q???????q????h??hl???j?j??j?????j???j?d???m?m??mc??uuu?uff?u?mt?????tt?t????????t?????mm???m??f?g???c?c???cc?sjee????ee????e????et?t?j??????????a??????m??m????n??n??i??iiu?ff??ro???ddq??r???r?r????r??r?bp???p??g?uu?uss?hhh?c????bb?bbak???uu??u??ibm???????????m?ml???l???e????dn?e???m???q??u??cb????e?eddd?d????d?d?d????d????????d??rii???b????????h????????hc???m??m????ggnffml??l????f?ff??????fl???sbhf?kk?k??k?k?lu??u?m?mmmtgg?g??g?g?pp???d?d?dd???ppp??i?e?????dd????dd??????dd??d???s???n?t??????t?????????tdd?d?d??dd?d?dd????d?d?aa?????a?aa??u?cte?????????e?e?eq????q???p?t?th?ell???????ll????l?uucu???gbb?????bbb???????gddf?g?????is???????ss??????c???cb?b??b?n??d?pb??????????p???a?a???apd????dd?en?s?????f???????????f?????tt???dde?et????????n??nm??mj?r??qq?q?q?????????l?iiim??ke???e?e???e?e?nk??k????c??q????????g?h??h????ddduhh??g?gg????gg?qqq?q???mm?l??l?????llfff?????g???????u????????u?u??q????q?q???q????jj??bkj";
        assertEquals(1143.213850370817, squarescores.calcexpectation(p, s), DELTA * 1143.213850370817);
    }

    @Test
    public void case149() {
        int[] p = { 8, 5, 0, 5, 4, 7, 0, 7, 1, 4, 0, 8, 1, 0, 6, 8, 1, 6, 6, 3, 1, 15, 2, 1, 1 };
        String s = "t?s?eb???y??y??yykc?kp???p???c??c????????w?w?qqfkdyy??ymmy??u?urrkdmq????uuihk?v?jj?jjjl??sd??d?oopnk???????h??p????f?k????k???m???a???n???dtbnkkghj?he?????bmmm?h???cc???n?a?dk??k????????kd??me?see?ee?f?i??c?y?y??l?l???c?f????ooe??ea?????????????????????????acoboorv???g????s?i??yr??r?wk?a??????eee??????i?m??cf?ffih???dvu?u??h??df??fc?iinbu?wm?wt?t?f?dl?l??????????v??l?ll??y?????blu??uy?v?vu???jbkk?k??g??x??c???????cdtf??ja??a?u???p?p?????l?ldx????r?a???o?o??c?s?yta?????ebas???y?yd?????u??e?sssg?gqqoca??w??g?ghq??vf?w????m?ll??l???al??n?e?xxdd?d??w?w?p?p?????p??c??????f?b?qqg??vi?i??????d???l?j?j?fff???mmdu?xnpxxxxn?????nsuu?lo?oa??????am??m???pggkhvtnw??????w?frxxw?jg???g?y?w????li??????r???k?r?r?bns???s??p?h??n??ssxxppp?e?egg???????f?ggbgcboeep??q??khhv????b????bb??bb???u????i???t???????u?v?????a????ww????xb?eo???v????hjf???j???jo?ms???g?mhhox?u?nx?ss??n??ei?????v?w???tt?g?????x?tsm??mm?d?????n??g?o?e?????c?cc?c?pv?ijdd?ux?ob?hm?m??????m???vv???v???vt????a?a?oq??ss?w???n?a?hy??v??f??f";
        assertEquals(1118.844312214463, squarescores.calcexpectation(p, s), DELTA * 1118.844312214463);
    }

    @Test
    public void case150() {
        int[] p = { 44, 0, 10, 0, 8, 0, 0, 0, 0, 0, 0, 5, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 4 };
        String s = "????x????x???xx???x??????xdl???l??l?l???ll?????llll??l?l?ll?????lt?????t??????tt?????t????t?t??t?t?tt????tz??zz???c?????c???????cc?ccc????cc??????mmm?????m?????f??????f??d????????????w??h?h????h?h?h?h??hh?????hh???????h?h???h?h??h?h???w??w?w???zz???zzz?z???????????zq???u??uuuu???u?u?u??u????u??b????q???q?qq?????q?k???k???kk???k??k???ks?????ha?a?a?a???aamm???m???m?mm????v?v?v?vy??yy?y?????yy??y?gg?g???????g?g??????????????????g?gg????g??????d??d?w?w??????w???w???ww????h?????????h???h?hl?????l????l????l???ll????l?????lll?l????????????l???u???????u????uu???u???u?u?????uuuuuro??o????oo?????????o??????????????oo???gg?g?????p???p?p????p??p????p?????p?p??p?????p????pp??????????p?ppms?s???s???s????sss?s??ee?e??el??l???l???l?l??l?d?????????z??zzz???zz?xd???dd??d?????????dd???????s???s??????????s?ss??????????????s??v????vm?????????m?mmm?m?m?m?m?m?e?e?e??eee?ee??????e??e???rr??????r???r????????r?????rd?????d??????d??d???e?????????e?eee??e??ee?ee??????e??????????e??e?e?e????e??ed???dd????d????dd??";
        assertEquals(1295.2962230649991, squarescores.calcexpectation(p, s), DELTA * 1295.2962230649991);
    }

    @Test
    public void case151() {
        int[] p = { 16, 9, 12, 6, 13, 0, 5, 5, 1, 5, 0, 11, 2, 2, 13 };
        String s = "???????l???l??????k?j????????????l?l?b???????????????????n????????c??????i????????????i?i???????????????????c????????d??????ff?f?j???????j?????m????????????????????????????????????????????j????cc??????????????c???n???????????????ee?????????e????d??b?????????????????b??????????????o???????????k???????????????e???b??????????bb?d??ooh??????????n????????o?????????????????k?l??????????????k??????????????????????????????????k?g???????????????????????m????????m????m???????????mcc?d??ii?i????j??????j????j???????j?k?k???j?????????k?k??????????k????????k???????????km???ia??????????k?h??????????o????????????????????b?hg?????g?????????????????????????g?d?????hb???b??b???????????????????????bn??????????????????????????l???????l???ooo??o???o?????o?????????????????b?????????????????????c???????????c?????????e?e???????????????????????a??a??????h?????g?f????o???b?????m?c?????l??????????b?of?????????l?d???b?b?????????????????????????????i???m?f????l????????????????????????????????????lb???b???n?????????";
        assertEquals(1119.7537709898543, squarescores.calcexpectation(p, s), DELTA * 1119.7537709898543);
    }

    @Test
    public void case152() {
        int[] p = { 10, 12, 16, 15, 12, 10, 21, 4 };
        String s = "??f?f???fc???d??????g???ff?hfdf??e?eh??e?d??b?eedd?de??d?g??aahaefaaccc?ee??eeg?ff???aa?e??ddfa?c?ccc?ff?d??ddd????dd?chac?c???hhhh?h?h?hhhhc?c?c???cffbccc????c?cc??c???????ge?f?e???bbbf?b??bb??bb?b??eee???bbbbad?d?ee???fedddddeeec?????c????e???g??ccchhh?hh?hhb????????b???f??ccc????ccccc?c??c?hh?bbb?d??a??a??f??ff?f?hdgeeaaa??a???gggbh????hddh?????g??gh?g?dfffebaaaha??a???a?c?cdd??d???ded?b?b????a?dc???????cc?a?af???f????ff????db??ee??hbb?b?f??????ffghc?c?gd?cc?ce??b?e??ecc?hhhc?cf?a?????ac??cca??aa????a?a??????abd?ggg?g??c???cbf??f?bhbce???ef?ffffaadc??c???ca?????????ddbbbfcc??cab?b????b??b?a?aaa?a??gg???hgh?h?hff?g?gdd?d?f???g????gd?ehh??hh?g?g?eff???f??f?fg???ccce?e??b????a?c?c?cch??eg???g?ee?e????e?h??gdba?b??fa?h????????h?ch???h???a?ddb?b?be??e?a????bb??bb?bbc?ccc??bd?d?bd?fhh??aaag?g??g???b???ae??d??ff?ce???eebb??a?a??a?e?h?d?d?dcc?cec?dad?g?b?d?dd?bgg???eeh?bbhg?cca?b?eee?d????b??b??feg??ggcf?hhh????e??dd?a??a?eg??gg??c?dd?ddd????d?d?????ddc??c?gg??bach?g?ga??a?hhg?gg?ee?egh????";
        assertEquals(1335.6523032912783, squarescores.calcexpectation(p, s), DELTA * 1335.6523032912783);
    }

    @Test
    public void case153() {
        int[] p = { 1, 0, 2, 6, 2, 6, 4, 16, 1, 5, 5, 17, 0, 13, 9, 0, 0, 13 };
        String s = "dggg?ed??dccccbbbnnndddhhrrooool?aq?gdddd?ddaqq?qiiiinncccii??f?giikkna?o?oojrj?jj??kqqhhhh?hheolgdqlld?e?dlllcchhifg???iffhioneffffcpeoooo?oohhhhhhpl?kkr?rnbaaaaajjpdd?doeell?dnnnmmmmgffdddm?rbaggiaa?fhhoeeffj?j?j?g?gbbbq?bbkikhhlllk?kkkaqqq?oj?je?crrlljgmrrhjddhcceeeeee?ebb?qqq?lb?b?b?bb?cfqqkkpiiiddhh?oo?ooan??krrjngcccbloojn?ddcrebbbefr?effaajjjee?eefkkno?aaa?aaaeeeggbeqqppnnnnb?bbakl?iionn?mdd?jffiiiie?eee?ccff?fnnffieeeepihqqfpo?odddmmmmmmmmm?mmmmjkjqqeeeeeeeffqqf?ccc?ch?h????hhoobllpp??jj?hhh?qqhhhi??i?iaammaajkafb??b??b?nb?????m?mc?riqmmffdogggcpp?ll?ll?llgh?phhhllkbbn?nn?nppp??bjpp?pjjo?ooooriefbboii?iinnkeikkkbb?a?appchhrreeaaaj??j?jjrjrnmmmqh?ll?jl?iiirrrrreegapphhhhgg?n?nn?gbbbiirr?rid?doocf??nnnkgjcii?nnniic?ooohgg?gggaajamj?ffn???nbb?bbi?qhllllaalh?h??qqqqqm?mmmmnchppoinrrnimmd?pppm?fhhaddddffnnjkhqb??oic?nn?kkkkk?eemddpphhhrmmohh?hjjpjeegaannnllfm?mekdde?iih???i?phhnnhhkmardddqq?ockccfff????foooj?jhlqqim?oohaa?mmiggabaqpp?gero?ooobalncqrrjqqlaaaa?gg?gglaa?aac?ccccbb?rjkk";
        assertEquals(1559.2398925715966, squarescores.calcexpectation(p, s), DELTA * 1559.2398925715966);
    }

    @Test
    public void case154() {
        int[] p = { 4, 4, 3, 4, 6, 4, 5, 9, 3, 7, 7, 3, 5, 6, 4, 1, 4, 7, 1, 3, 4, 6 };
        String s = "msq?phuu?ulqf??tmmcsf?foeaqqqbsppreeeggknuqevvvvvoaoff?ffiiimmivv?oo?suddjnhqddkdhqpufdtqqdddddkkgg?ggonpppqttt??pqqttpdhhhppu?mevvlqqpoqaaggpppth?pppbb?kkrrrr?rrrooooppjiid?rhaokk?t?jmolguaaadgqq?qhhohqq?qcccjjfqqqj?jfffffqqqqqq?q?bjq?t??n?jlmmippqquuuug?geadi?ubbbbq?dhir?rijtttjqaiiiarjkagoh?smua??ddlvvcc??a?onhbaadl?biiccaaam?mt?ttt?k?n?rrjjjjrbllursuuui?ffu?ffvei?ir?rjm?dppmiiuvssafme?avvv?v?vvv?viiimsscbot?mqq?fdeeskussieg??gjjllvcmioqqrr??reu?elgbfvffu?uuuuvddkkkpk?seelg?gsll?lk?jfqo?iilh?h?korrrhhdc?vk??khhhhhhh?q??q?ggdeq?lll?mmdduppjjinnm??mmqr?r??r?nnnn?pp?f?aa??accrimtkl?llccnngkjnv???jb???ffpg?bgggiimvvtttssssdcgdiiioooojcccdd??d?dbcc?qme?kkj?oo?ooejjv?vvvg?grlltqloohrssssge?ek???bju?uukcrrrhg?vvv???vvv?vgg?ggmattddrcc??uu?hhh?b?f?svvaf?manrfepbfpdveeeofoossa?d?lo?khtf?ff?fqqaaa?aaaaafl?llll?nnh?ahdp?p?ppccss?sskkkg???gbsok??oufhfffaeqj?qqff?vuaaab?btq?n?nojjjj?jddmoera?np?pl?l?llqvaacccjjj??pp?nkkh??hqaaiiqqqffc?cpllllllpvvff?fs?fssss??favvaqoudneonssbbrllppdd?deeee??e?bff";
        assertEquals(1442.6387046551708, squarescores.calcexpectation(p, s), DELTA * 1442.6387046551708);
    }

    @Test
    public void case155() {
        int[] p = { 2, 6, 0, 0, 2, 0, 2, 0, 6, 8, 0, 0, 0, 0, 0, 27, 0, 33, 0, 0, 0, 0, 14, 0, 0 };
        String s = "?u?aaqanp?u?wmmm?uuw??yjj?jotpppo?og??gqppp?vv?ouuxbb?m?mqqq?qqrrm?mml?ww??wd?d?ee??hhhqqq??q?xkvttci??i?iitxxccuun?nnv?v?vc??uyym?xxooh?i?imk?yyffxsll?amj?iq?f?fyp??pb??t?tillluvv?i??ad?rrrriiii?u?uuj?ju?uu?eq??v?l?rqtddd?????x??vvihfy?yg?eyh?h??keoo???qcuuunb?b?bjbbbbb?becmg?xxddv??ee?ekhh?hjj?ltt??fv?c??chhw?xxttt?tmq?qq?t????ppj?mpmxx???xxbbsxiiikkk?tvu??uoo??o?ooryaa?mie?txxvvqqw???xxal?ck??kk??????k??kkn???tj?ugwuyf?f?sss?pp?f?f?ffaaa?rgg?hn?iiggh?oo?o?h???sss???s?nnnfeeto?p??pg?c??eg??nnnn?nosss?kj?yuuooyyyyi?i?irrrwaaaolxfwwwdddd?twwo?ofv?rqq?r?vvv?vnsj???oopt?gj?ee??e?kg?aaa??qqq?qq?obsfv?ggy??eerfh?le???f??ebbd?k?kh?xvbba??aurrrqq?qq??xxxn?nr?ss?sccecc?cdrqqq??qsg?g?go?d?oxxc??c?c?pprj?j?eev?yu?uliiib?bb?b?bv???m??m?????wwwffppx?pt?r?r???n?utwm?g?vccw??nbggbb?cccccuuw?w?fpfhbhffiqp?tt?tvvvqnv?q?ll?l??eegguqqqqx??ph??yyeees?shy?q?yww?woo??oo??oaa?kbqv?vqllhxxxddaa?a??ylh?uuc??bp??g??gg?g?geeq?hhfc?tt?irr?yyyxllxx?d?a?a?a?r??ueepmpeeeurr?wffffr?rrrr?k?jwwwwu??u?a?as?i??ipp?ulra";
        assertEquals(1329.9682726990618, squarescores.calcexpectation(p, s), DELTA * 1329.9682726990618);
    }

    @Test
    public void case156() {
        int[] p = { 10, 13, 11, 16, 4, 8, 20, 12, 6 };
        String s = "e??a???hba???????ff?gff?gibg??aa?i?????h??????g?????a?fe???egb?a?ccc?hhafd?????????d??d??ddg??g?gg??ieeei?ib?aafi??????e?i?a??h??????????hh??a?hf?a????h?????c??fe?fc???cg?a?g?a?cihgee???bb????e?e?a?bc????be?g?hf?f?df?f???f???bi??ab?????di?g?a??afh?a?h?he?c?g?gggb?g??d??h??afdaee??i???df?a?iii??c?a?c??c??hi?gf??e?ff?d??iccb?a??c?h?ii?edf??f?????af?fdb?h?h??????gi?i?hf???c?c??bf?e??e??a?ca????ii?g???g??gibd????ded?db???e??d??df??d????hd?gc?dd???d?b?a?i??e?df????cabiaa???hf?????fi?h?abe?b??hhfa???abab???f?ge?d?dd??decb?e??hd?f??daf?f?i????d???b??b?ad????b???da???ba???cfe????g?h?c?i?f?d????hg??i???a???c??dgf???h?ii?i?bd????fgh????bicc?i?eecdf?fc??c??ib??g???a???c??eaa??aiggiidc?d?d?c????????bbb?acc?h?b??g?i???a?d??b??????e?????b?aih?h?h??d?i???d?bb??hh????dg?cc??c???i???g?e???ee????abg???dg?g??g??fbbb???d?a?????ge?g?g???hfecd?h??chc?b??????fgh???f????ggii??d?f?a?????ab?g?g?????h?h?aadcfc?h???eaa?a?gff????a?ff????aa?fi?c??f?i??cfhh?ca?afe??a?ah?e?????ff?i??i???aiiiiedadi?ibh?acghhbad??i??f?";
        assertEquals(1181.3308364172094, squarescores.calcexpectation(p, s), DELTA * 1181.3308364172094);
    }

    @Test
    public void case157() {
        int[] p = { 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
        String s = "t?????????jj???d?????ckqq?n??niiih??h??ii???j??j?j??j???ks????p???g????pdm?mmhhpm???????e?e???e????b?b???u????up?pp???c?i??i???d?????dv???v?????h??????hh?i???i???????ig?gg?????g?????????hii?ttth?ca?aaaa?n????njr?r??r????j????x?l??rrh?hh????h????h?h?h?h??hh????s???ss??????sahhc???t?ll????????k?ki??u?u?????h?h?????h?hc????c????j??l???????????l?tff?????fp?x??x?mm?????m????????s?????q?qq?qqb?????i??cce?e????????????ae?e????e?c?w??????ww?q??????r??rm??w???i??i???nxx?xee???e??ee???e??e??ee????e????e?e??dl?ll??l???????g??g??g???????kq?a?x?????g?v??v?wid?????r????q?qq??og???????hhh???hh??s????????????n?????uu?d???????dd?????o???xp????pbb????b????al?l?l?????l?ll????jj??????????oo?s?bb???????????bb???qd????????????????dd??d??d??????d??????d?x?x?x???????xl?ll??l?l?l??n?n????????b??wtt??????????t????t??d??????mm???????m??m?????m????oo???????o???n???????n??????n?m?????o???oo?????o??hh??g?xfffff?????hb??bmme???x?xr?m???????mm??m?i?ii??????i??????l?l??lc???t???t?tt?t?t??t??x??x?x?x????x????sx??dn????";
        assertEquals(2557.0, squarescores.calcexpectation(p, s), DELTA * 2557.0);
    }

    @Test
    public void case158() {
        int[] p = { 10, 5, 7, 14, 7, 9, 15, 13, 6, 5, 9 };
        String s = "kkkbfdddjjd?chgcccj?jh?hidiicjbbb?kkfkjf?fggffffkd??eebbkii?ikkk?kjj?jf?faeaiibb?bf?h?h?kkkkkkgkcch?cb?b?ffbjad?agggaa?gbikk?fe?bbf??ffjajaiiaffhhchhgfcbb???bikggfgd???dcgbaaaaaddeh?hhh??hfhhkkigdh?g?g?ggicc?eebbkfff?b?fdjiiiiigc??bec?ccc?bddddafgh?kfjijckffjiggdeff?bj??iibbb????accjffcc??d?d?b?bicbegabbgjjkkahhjkeii?ijggkaaf??hjbhkbka?aii??ikddkddj?j??akk?j?ffh?hggggjkaecbbgf?f??aje?ekbbacj??jddceaacekdg??gdbggfecgkdibje?efi?kh?hh?g?iiibaabbhhhhdd?dadbcchhc??gj?cdgaj?deddeeb??ggkieg??gha?jjggg?ggiekakib?hhj?h?eb?bf?fchiiadaaeegddcd?cdbeekgggg?gggeajh??h??j?j?b?bdjii?cdg??gggki?iheehfffh?ddjj?bbf?c?cckk???kd?j??bdbddjigfba?edjaiaeaffeccaaahffgii???hbeadd?bb?kbcckhiiejj?f?kjbbgjhiffffdjkjdchdfccfhhihhhciibii?jj???jhd?dbbiiddd???dj?fdbghk?ccddd?haaa?geeb?hhhf?h?hhkiac?h?f?e?ej?ge?b?hgggkcc??ffaacjjhihbde??ggggjggj??jjjabjjfb?baaeeedacahhfffffcc?cciijh?dfkkkk?affaaa?aaffkk?kbiigdeecdfffddhh?adh?hd?fgddgji?a?gaeeeahkkkfkhcddic?higggiadbbbbheeea?dd?fb???b?b?b??bdd?dfdddgfjj???igga?aggjfebcd";
        assertEquals(1366.9149006031187, squarescores.calcexpectation(p, s), DELTA * 1366.9149006031187);
    }

    @Test
    public void case159() {
        int[] p = { 5, 2, 3, 7, 7, 2, 7, 5, 2, 2, 11, 11, 2, 8, 3, 4, 5, 9, 2, 3 };
        String s = "ht????????t???t??t???tt?t???tqq??q???????????qq?????q???i?m?mm????????m???m?e???in????n??n???n?????????????i???i????i????i?????h????h????t?t???t?????t??t???????????tf???ffe?????????????e?????e??e???e???e????????????e???????e????????e????d?d??d??d??d?????dg???m?????m??m??m????????g??????????????????gg???????e??????????????????????e??e??e??????????s?s????????q???????????a???a?????????r??????????????????????jt??????c?i?n??l?????bss??sss?s?????tt?tk????????e?????????????r?jq?k??????kq??????c????????????????????????????l???????l?l???a????a??????????k?????????dd??????s??????q????????q?????????q???q???????????????q?????l??????l??????????????????l?l??bb???????????????b??f?????ff?r???????????????nc?c???????????q?iii?tt?j?????c???????????q?j????jn???n?nn????n??n???nnn??????n??????????n?nn????k????f????f?????h???h??h?h?????h??????????h?h?????h?h??h??hh????????m?h????????????????????tt??????????o??o?q????????????????i????i???i???i?i???jjj?j????????rr????????q?g??????????????g????????g?????????????";
        assertEquals(1097.1161834697841, squarescores.calcexpectation(p, s), DELTA * 1097.1161834697841);
    }

    @Test
    public void case160() {
        int[] p = { 59, 41 };
        String s = "??a?aa????a???a?a???????????b?b???????bb??b??bb??a??b??a????????a??a???a???a??????????bb????bb?b??a????????a???abb????????????????ab??????????a??ab???b???aa??bbb??bb??b?bb??????b??b???b??????????????????b????????????a?????a?????a??a?b?b????bbb???????b???b????b?????b?????????b????b??b??????????ab????aa?bbb??b???bba???????a??b??b????b?b?????????b??b??????????bb??????b?????b??????b??????b?a?????a??????a?a???b?a?abbb?????b??b???b????????b??????????bb??ab????aab?aa?aa??a???a???a?????b?b?aa?a????a????a?ab???b??a?b?????aaa?a???a??a????a????a?????a????????a?????????a?????a???b?bbb?b?bbb????ba????????????a??????a??b????aabb??b?????b??bbb???b??????b????????b???bba?aa?ab???a?????????aa???a??????a???a???????a?????a???????????a????a???a?a??????????b?b?a?aa?a???a??????a??a?a?????????a??????a?a???aaa?a?aaaaaa?a??a????????a??a????a?????a??a??????????a???b??bba???a???a????b??b???b??bb???aa??a????a???????????????????????a?a???????a??????????a??????b?????????bb???a??aa?a?????????????a????a?b??b?????a????";
        assertEquals(2257.877816902327, squarescores.calcexpectation(p, s), DELTA * 2257.877816902327);
    }

    @Test
    public void case161() {
        int[] p = { 60, 40 };
        String s = "bb?abbbbbbaab?bbbbb?aabb?bb?bb?ababbb?b?bbba??baab??b??ababa??bbaaaaa?aaaa??b?bbaabbb?ab?a?aa?baaa?b?ba???baab?bab?aaabb?abbaabb?b?abb?a??ba??bbbbbbaab?abb?bb?abaa??a?abaab?bbaabbabbb?aaabb?aaaaababbbbba?a?bab?ba?bb?aabababbaaababaa?abb?abb?aba?bbaabbb?bbbb??aba?aa??a?baabaaaab?ba???abbaaaabbaa?aaaabaaaba?a??a???abbbba?b?ab?bab?abbbbbbabbbabbaaba?aaabaa?abb?bbbabbaaab???bba?bb?baaaabb?bbb?a?aabbbbaa?aabab?b?bab?ba?abbbaaaba?b?aab?b?abaaaababbbaaa?aabaaba?a?aab?abbb?bbbbbbbbaabaaa??aabb?bbbba?b?ba?b??a?a?ab??ba?aa?b?babaab??aaabaab?aabbb??aaa?aa???ab?bb?bbb??a?a?a?aaa?b??bbbbbba??b?bb???baab?ab?babbbab?aa?bbaa?bbaaa?aaa?a?bbbb?aaa?abaa??bbb?b?baabba?bb?aabbabab?bbb?aab?bbabababa??a???bb?baaab?a?bababb??a?aabbaba?a?aabbabaabbbaaba?a?aa?bbb?b?aa?a???bba?ba?ba?a?abbbabaaa?a???bbaaabaabbbabaaaabbb?aaaaba?abb???aabbabaaaaabbabb?bb?b?aabbba???????abba?bbbba?abbaabb?ba??a?b?ababaaa??aaab??abaa?bba?abbb?b?bbbb?a?a??aa?babba?aaaa?????a?bb?bab???aabbbaaaaab??a?bbb?a?bbbaba??aaab?bab?b?aabbbbaabbb";
        assertEquals(2132.622143999999, squarescores.calcexpectation(p, s), DELTA * 2132.622143999999);
    }

    @Test
    public void case162() {
        int[] p = { 5, 3, 5, 3, 6, 7, 4, 3, 7, 5, 5, 6, 4, 4, 1, 6, 3, 1, 4, 4, 8, 6 };
        String s = "vvsi?isd??dddd?dar?r?jjv?cc??i?t???scrrffk?vvvdtttuvfftli?a?b?b?ff?f?hconr??lr??mjj??jh?hhhuuu?loss???bkkkculbbufoiissqqosssss?s?ac?c?uqulk?k?fh??rhiiqqf???l?k??vejk?pii?qqm?rm?q?t?g?lla?a??aaeejjinsepcong?l?lj?g?g?oo?of?do?fmmogg??gq??qqov?dfb??a??ajjjf?jbbt?jqmt?r??i?gt??s??skvvvrree??kkodfqoofaljnnnrj?j?k?k?leermm?dd?nnj?dhedqat??tolll?llqanpqq?st?t?otcc?q?uuoa?bi??e?m?ssm??kl?hpugoota???h?rriivq?ffeom??h?hrmm??tohottn?gqj?e?tkvvch?httl???lmifl??hhhba?a?t?q?kcff??hkben?ttbbbbk?k?mpks?pusv?bbbpfflej?j?hf?fkaurhqhbbi??i?nn?nnq?k?ktdddg?usg?ggi?d?aaavarjapgglbe?eo?jccc?qffqq???ee?edmmk??tn?nnkkucff??schhtf??s?rlvussqbj?jpbsee?eel?q?pkkkncpmmeupuvmmmmmqhpu?d???hlkcc?qeee?????jneu?i?i?rl?lmuuuvk?jio?ddaaaar?pnndc?f?i?m?lgiaiell?rrrls?gt??b??hh??hcooi?qbbbbfohqfvhbquuuoou??vb?f?fcc?aaank????ccccaa?vvdvkff???stb?bbbhima?aakjnuvf??iiif?fcj?b?eg?m??mmmmdd?eccnnn?vspp??pjpvcbrrvvlm?bcc?lu?u?uhhtlkaa?ssslluqkdcui??qttv?vujsu??h??r??lfeh??uugcjarh?guuggtt?s?ld?dag?g?g??g??ofrm???ulladdqafrineun";
        assertEquals(1252.6556521010566, squarescores.calcexpectation(p, s), DELTA * 1252.6556521010566);
    }

    @Test
    public void case163() {
        int[] p = { 3, 5, 3, 1, 7, 4, 2, 2, 6, 4, 9, 0, 3, 6, 3, 0, 2, 1, 10, 2, 7, 3, 5, 1, 3, 8 };
        String s = "??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????s?????????n??????????q??????????????????????????????????????????????w??????????????????????????????????????????????????????????????????????????????n???????????????????????????????t??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????h???????????????????????????????????????y????????????????????????????????????????????????p????????????????????????????????????????????????????????????????????????????????????????????????????????????????j?????????????????????????????u????????????????????????????????????????????????????????????????????????????????i????????????????????????????????????????????????????????????????????????????????????????????????????v?????";
        assertEquals(1060.7745966966702, squarescores.calcexpectation(p, s), DELTA * 1060.7745966966702);
    }

    @Test
    public void case164() {
        int[] p = { 3, 5, 4, 0, 1, 4, 0, 13, 8, 3, 1, 1, 0, 7, 0, 10, 9, 5, 0, 0, 2, 10, 2, 0, 10, 2 };
        String s = "adhzgg??pl?p??p??qq?n?????t?c??lr????????i?o???k?????aak?kmk?????????m?mm???crdc?n???ti??yy??cclhh?a?aa?kddjay?jcc?us?o??yyy??j???ii??k?xggg????bbl??i?q??er?r?z??a??u?o?ncrnz?z?s?yy????u??iirrpmmm?????tv???vn???i?pp??ss??u???dz??qek?m??q??xxc?w?bkk???k??????s?znej?j?jnp?p?k??i?ad?v?fh???????o?bv????g??cyit?zdwge?eebu?r???r?r???iig??k?k??????gtn??????htoddi??r?re?hg??fun?nbwjj?sv?y??aaa?a??????p?e?nss??p?xqm??p?puuse??fdy?y?a?qf??oq????lm?g?qom?????m?dd??dh??alh????hwiu?phzz?zzkbnna?l?jh?qt??v?hh?h?h?b????b??m??mooe???dt???????t?aaowo????ouq????iu?omjpa?m??ss?ong?g?jj????vvz?yc??zzv?xx?e?v???????v?vrn??fpppsaqdc?uns?z??q?i?na?azr??ra?????yy?d??d?ffam???dd?yhl???i??hcz?qv????o??cgx?h?h?p?ff??a?nggv??vz?coww?bjt????tro?qm??meerwz?sslcm?g?t?t?uu?u???u??n?pz?p?g???ghegn??c?j?uu?l??lofxgj??w????bc?f?h??h?hi??iie????k???azc?go???lc?bw??z??zzzlum???????z??rpvusz????????z?q??m????l?zsg??x???x???xa??a?ail??llfy??k?k??k?z?nn?w???wd?cpj??evvv???i????i?q??hrlmmmu??voi?i???eioq?mq??oi?dkv??z?dd?lloi";
        assertEquals(1123.0373733856534, squarescores.calcexpectation(p, s), DELTA * 1123.0373733856534);
    }

    @Test
    public void case165() {
        int[] p = { 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0, 25, 0, 0, 0, 0, 0 };
        String s = "u?????????????????????u???u????u????????y?y?????y????????y?????????????y??????????????y?y???y????y?yy??????g?g????ggg????????gg??g?????????g???????????????????????g?g??g????????g?????????g????g?g????????g?????g??g??n??nn??????n?n?n??n???n????n????????????????????n????n?n??n?????????n??????????????nn?n????????n??n??????n??n????n?l??l???????l??lll?l??ll??????l?????????l?l???l?????????????l?ll?????o??oo????????o????????????o?????????o????????????o??o?o????o????o?oo???????o??o???????o?????o????o??????????????????o???o??oo?????????o?????o??o????o??o????????????o???o??????o?o?o??????o??ooo????????????????o?o?o??????????o??????o???o???????o????o?o??o?o???????????????oo?o??o???????????o???????????o???????????o???o??o????o??o?????????????????????q??????z?z????zz?z??a??a???????????a????a?????????????????aa?????????????????????????????????a????m???eee????e????ee?????????????e???????e?e????ee???????e?????????e??????????????e????????e?s??????sa?????????????aa?????????aa??????a?a?????a???aa???aa????";
        assertEquals(1430.8501573627989, squarescores.calcexpectation(p, s), DELTA * 1430.8501573627989);
    }

    @Test
    public void case166() {
        int[] p = { 2, 1, 0, 6, 0, 0, 8, 4, 0, 0, 0, 0, 0, 8, 15, 0, 6, 0, 26, 0, 4, 0, 9, 0, 3, 8 };
        String s = "????????????????????????????????????????????p??????????????????????????p????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????p??????????????????k?????????????????????????????????????u????????????????????????????????????????????u?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????u?????????????????????????????????????????????????????????????????????????????????????????????????????????????k???????????????????????????????????????????????????????????????????????????????????????k?????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1156.8360141963767, squarescores.calcexpectation(p, s), DELTA * 1156.8360141963767);
    }

    @Test
    public void case167() {
        int[] p = { 0, 0, 0, 0, 6, 5, 14, 10, 3, 11, 0, 0, 0, 0, 11, 12, 6, 0, 0, 0, 0, 20, 0, 0, 0, 2 };
        String s = "??????m???d??d?ff????corxx?v?v?v??????????v?v?????????????vv????ee?e?a?a??????????aj?j???q?m????mp????p????p?p???????r????????r???r?w?w?????w?????ll??l?k?khh????h??h???h??ee?ev?e?e?e??o????o???y?bb???bbn??????nn?kkk???????k????q??s?uu?u???jj?????p??q??q?q?q??????????wv????q???qq?????????qi???????i???i???j????j?j??jj?ef???f?evv?????v??g????geeee?e??ekk?k?????o??oo???o??????gg???g?vc?c???r??????bbbb????rr??r?rr???y??y??y???y?yy?yn????s???????u??????u??khaa?unttuuu??rv??????vvvv????v?????a??????aff???ff??ff?fff?i?i????iii??y??djj??j??jj????h?hb?l?llll??????????????l??l???l??l?l??l?????lp??u??uuu??u?uu??u??uuu???uu??u?eeuu?u??????????t??zzz??????rr?rr??rcc??g????gg??g?????rr?rr?????rr??r?r???rr??????r????tt??tr?r???rr???r?rr??????????n?xx?x??xaapp????p?p????p?????w??ttl???y?y??y?zznn?nnn?n?n???????n?n?n?omm?m?????m??m??m?m??m???m??????mm?????ls?ss??ww??www??w??w??????w????gg?gg?j???jbe???e?e?ee?y?????yt??t?????t?ddd?dnqq?q????????qq???quuuu?u????u?????o?o?h?r?aay??????w?wccccpp??ppp?p?p??p";
        assertEquals(1217.330873380763, squarescores.calcexpectation(p, s), DELTA * 1217.330873380763);
    }

    @Test
    public void case168() {
        int[] p = { 0, 5, 5, 11, 5, 1, 2, 0, 1, 2, 11, 10, 4, 0, 4, 1, 1, 11, 3, 8, 3, 2, 3, 4, 1, 2 };
        String s = "???????moo???o?????og?????g?y?y?y?yy????y??y??y???y??y??????yy???????ye????????e???????c???????????????cc?????????c?????????c?c?c?c?c???c???????c?????????????????c?c??ci??c?????c??l?l??cc???c??aa?????????ay?yyy????????y???y???y??y??f??f???f?p??p??p????????????uu???u???uc?????c?b?bb??????b?y?q??h????m??????????m???mm??i?ue???????n?????????n??n??????nu????u??u??u????u?u???uuv??v??vv????z?zz???z??zz???????z??z????????a???????a?g?????????g????g????v??n?nnn?nn????????????n?n??n????n?nn??g??g?g?gg?g??ggggg??g????g???????g?u??u???????????fj???????????????j??j????j?j?????j??ssl?????l????l????ll????ro??ww??w?e??e????tt???????????t???????tt???????rn????n??n??n???m?m??????m?w??w??w??w???t????????t????pp?????p?p???pff????ff?????ff??w?n???n???????nn???n???x?xka???al????????l???ll????l??l?????????l???llll???l??s?????s???????s???ss???s?????ie?????ee????e?????ee??c??c?c?bg??g????????????g??gg?x???a?????????a?aa???????nn??n??n?????????nb??????b??b???f????????????fff?????f???f??????ff?????f?????????????";
        assertEquals(1116.4647392113236, squarescores.calcexpectation(p, s), DELTA * 1116.4647392113236);
    }

    @Test
    public void case169() {
        int[] p = { 0, 16, 0, 0, 0, 2, 0, 20, 6, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 7, 40, 0, 0, 7 };
        String s = "?????z???????z?b??b?o?????????ooo??o?????o??oow????zp??????p?p????p?p????pp?p???p??u?uu???????????????????????uu????u??u?cc??c???a??aa???a?p???????p????????x??????x????x???x??????x?jy?y??y?yy????x??x????xx????w?????ww???w?????w?w????y?????y????????????z?p?p?p??p????????????????????????pp?????ppp?p?p???p???????????????p?p???p?p????????u?v?????????????v????????vv?v?vv?v???m?m????m?????????m???????????m???m?x??w??w?????w?????????n?n?????n?nn??n???n????????n????nn??nx??????tf????????????z????z??oo?o???o????o????q?w??????w??????o????o?o?o???z????z??z?z?z??z???????z??????za???a???mm??mm????????m????m????m?m??????m??m?mmm???m??????mm??????m?gg????????y?????y?????yp?p??p??zz??zz?f????f????c??yk???k???????k??????k?k?k?????k??rr???h???????l????l???lz?z??u??????????????u?????y???yy??????y?y??o?o?o?ddd?d????d????????d???????d???dd????d????d??d?dd?dz??????z??z?????z?z?zu????u?uu??uu??u??u??u?u??uu?u?????u?u???u???d????dd???dco???v????????v???h??h?g???g?????v??????ve???????ee?e??????????g???g???????";
        assertEquals(1245.0134682632165, squarescores.calcexpectation(p, s), DELTA * 1245.0134682632165);
    }

    @Test
    public void case170() {
        int[] p = { 1, 8, 2, 3, 8, 7, 5, 4, 5, 0, 1, 4, 14, 5, 0, 4, 4, 2, 2, 1, 0, 7, 5, 0, 3, 5 };
        String s = "bnog??qqljsl?lyvoi?t?kvs?px?xe?ixyrtlvdslvqfscmxnhfpqmx?ydyrmgjkgkxmxbtqjyk?bxru?vll?lpfkbbfuzjw?ss?lns???tsnrxytl?rgronn?wnblnwfumbhnkkftrdbxdgvlfkjmtkxxhrbappncccvtoz?nnpwdsx?ckqlzw?gxlxwfexyqqii?y?v?shkyuwazyxdgdhhrpcvn?g?ypkfgpb?ao?t?e?gvszsrrmtmfyylbdoooszzoywjrrykrovdns?wtiqwbozzchotezvgumlvcamwlsxpxp?jr?w?etfekfhmtftvomneus?ghz?ywubppivhyaaixudnoycesi?wa?iojwyczaljdff?cjwknuanfqryrdi?nlnfdi?bnxag?hcxelllnha?awsfw?r?vozsferxw?imeammjyv??gnefodnlinnppxrl?sgrzmgomx?aa?vv?aa???mdk?yp?xp?cpxxzxfyijwnxbkrnsj?l?rlttntdddtyig?whjydonaohuq?c?xfjc?ouwcivait?kxupcaieaadybsqriltmpb?trxkokjbxcj?f?ttjlaccfwyosd?iv?tagztwup?lewadighnv??j?obbhkzqshuyinipqqac?nnlxgq?enhg?zsz?deuiiign?wvk?sdtsstvm?hhllvhsl?bpvcknelmyh?cly?cxfacxhlnnxanbnbvmjjlaxpfkqr?wiwmooz?aqsxyuwdau?ou??a??bakko?jdfqmua??desjqdybhd?xs??snuw?ks?sryvcvcaytqoldmdbiqx?emslssie?abckvfgltqvc?tqdjuobf?df?ep?iadgk?zu?rvfphuktlcvwgzewgeyjtygoll?aikybrkllfzujthmibldjtfm?w?zja??njm?kkxef?nrdiyc?h?zcqqmmhqcb?ddjilbhylhhnjdup?uvtqtii??yxmt";
        assertEquals(1074.7007900199872, squarescores.calcexpectation(p, s), DELTA * 1074.7007900199872);
    }

    @Test
    public void case171() {
        int[] p = { 6, 3, 9, 4, 7, 4, 4, 4, 1, 7, 1, 5, 1, 2, 1, 2, 2, 4, 5, 3, 12, 2, 0, 5, 6, 0 };
        String s = "?h?h???dd?mht???t?f?i?h?h??aoyw??w?qg?ggj?cgi??xxgg?g?t????ttj?yyef???ixx???xx??uv??t?t????tgep???pnnnk???rr?v?r??d?dddd??k?dt??ijvhdd?????dyh??hjj?x?x?xl?f?uu????oo??oo?oo??us??ss?sbfcalydl???ll???e??ieee?e??em?w??wyy????zgb??dub???xxw?ds????s?pqepef?nn?gss?spj??jme?fdc?p???pt?ea??mm?q?nnfbbqp?l?lllqu?s?s?aqqq??qzss?qe?ml?f?uuzchr?uao???f??ffucsywwkdt?tnkg?ray?v?b?????bccc?cpppp?pt?tm??ocl?yh?dle??e??ee?e??i???i?q?m???rikbb?v?dhil?l????uuu???uu?ngg?ga??zlkm?mvv?v??mmvv?ffd?d??zcssk?wrrr?hh?hhhe?elnnw?kkk??o?op???ppp?g??nnn?ibjii?f?zzz?z?iiu?u?s?sss??so?ww?wmwww?s???q??????j?????z?b?a??jjn???nc?c?cdtnnn?mr??e?en?njjjf?xiykbbggbb?e?ee??hhejvnz?brt??d??z?uuif??zz?k?sn?ncnn?l??h??hhy?nn??b?nnnn???nhb??b?g?wwaaee?????xxk???k?uu?ul??w?wo?yk?keh?h??s??jzoo?ii??ir??????cco?ol???k??a?a??daahhhuruw??wwh?ge?hgv?vpp??p?j??xguw??w?d??d?g?bdhc?cc?t?tpu??ucp??p?zz?znn?npsz?o?ovvtt?q?????q?hpb?bq?egrr?tttt???hh?hyy?yyy?y?yarrkcccccn??f???fnez?????dgsr?c???a?ad?dd??????p??pvl?doo?n?ee???do?oe?f?fsf?uc";
        assertEquals(1204.3057844350192, squarescores.calcexpectation(p, s), DELTA * 1204.3057844350192);
    }

    @Test
    public void case172() {
        int[] p = { 9, 1, 4, 2, 7, 4, 3, 7, 4, 0, 6, 3, 7, 0, 4, 8, 8, 2, 5, 4, 4, 2, 3, 0, 2, 1 };
        String s = "xhhh???h?hhhhnnn?nni?wgggggg?g?ggggu?u?uuu?kll??lll?ll?ll??ww?ww?wwwwwwwwwffff?ffff??fvvva?a?aayy?y??yyyyggggg?ggggii?ii?j?jjjju?uh??hhaaaaaaaaaaaa???aaaaa????x?xxx??ppp?ppp?ppppp???pp?ppp????piiii?i?i?r?rr??r?rr???r?rzz??pppp??pp???ppp?p?pp?pll??lll??dc?c?ccch?hhhhhhhhhhppppp??pp?lll?l?ll?llll???loooooo?oooo??offf?ffff??fffffff???f?fffj?jj?jj?s?s?z?zzzzzzz?zz?z?zzzzzzzzz?z?z?yy?yyy?yyy?yy?y?yyyyyyyff??f?k??pppppp?pp?pppppprr?rrr?jj?e?rr?n?n??n??iiv?vvv?vv?vvv?vbbbbb?ll?ll?lllllzz??zz??z?zj?j?jjjjjj?d?ddd?ddddkuu?uu?u?zzzzzz?znnnnnnnn?nnnnz?z?zz??z??z?z??z?z??zzzz?cd?dyw?wzzzzzzzz?zz?z?????zzz??zz?zh??hhhrrrr?rr?r?r??rr?rq??qdttttbbaaaaa?aa?aa??a?aaa??aaa?a??auu?uuu?uu?u?u?uuu?u?uun??nqxxx??xxxxx?xxx?g?j?jjyy?zz?zznnnnr?rrr???fff??ff?????f?fff??tt?ttt???tttt?dddq?qq?qq?tttttt??tt?ttt?tttd?ddd?dd?d?d??bbbbbbb???bbbbbb?rrrr??v?v?vff?ffffffi?l?t?t??zz???z?zzt?tt??a?a?a???ab?t??tt?guuuuuuuuuuu??uuuu?uu?uu?uu???u?uuuuuu?umuui?ii?l?llnnnnnnaaaaaaaa?aanlp?p??p?pp???ppl?kkkkkkkk?kk??k??kkkkkkk";
        assertEquals(2081.501403595847, squarescores.calcexpectation(p, s), DELTA * 2081.501403595847);
    }

    @Test
    public void case173() {
        int[] p = { 0, 1, 2, 9, 0, 1, 0, 10, 6, 3, 0, 3, 5, 0, 12, 10, 7, 0, 4, 11, 12, 2, 1, 1, 0, 0 };
        String s = "clh?zj?xxx??xeeobtha??t???kkw?????ww??i?itlq??q?agg?qs?s?n???mmodd?d??d???d?d??l??l??????ii??k?t???l???lf??lr??rr???iy?j?jk??d?fm????mm???lgg?c?c??kqq?l?jj?asrr???jw?w?m??gcvpp???pccn?xfb???bbf?z?zf??????aljjy??y?c?viigsz?a?ff?f??ii??iim??g?j?g?wrc?c?h??hoo?jc?cxtrrrrdip?p????p??gs?z??nn?ob?m?mk?hu???r?ryyww?w??z?wl??v?uuugnpl?wii????ss?eehc?hhsn?nvvh?iii?d?uj?jjq?t?yt?wwwxaaieee??h?i??i??bxi?n??y??yyrc???c???????o??x?xx?e??eescxxxxr??rx?x?ha?ppppb??b?b???klpjj????jjk?okp??uu??utx?z?xddg???ckj?????m???trzn?w??wyyrrrr?ffe??hf??u?m????zl??lll?pxxkjuuoe?a???z?lloj??t?cfm??o??u??uhvfffffff?f??kktv?qq?a?aqqjlp?pa???azs??nn??fb?oll?acccuuwss???ss????s?x?xmg??wwooo?i?rrnnnizao???o?xxy??rrq?c?cug?hlss?u?xx????l?l?ls?????xx?u?x?xxx????q?qco???iijw??sb???????e?eeexx?geeww???w?d?dd?f??eeeu?u???u?rusbwe?vvvv???hhv?z???sw?rrr?ryvvfj?isn?jzzz???w???wb?b??rhh?xt?q??qi??z?w?ccxhbkk???k???k????yd?d??u?????u?fm?m?rjf?tt?tskccrn?nfggq?qqjookd?p???p?c?rr?call?l?jms?uip??pp??p??s?s?sord?d?cc??yy?oonnt??v?w";
        assertEquals(1217.5336497486296, squarescores.calcexpectation(p, s), DELTA * 1217.5336497486296);
    }

    @Test
    public void case174() {
        int[] p = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 45, 4, 0, 0, 23, 0, 0, 0, 0, 0, 0, 0, 0, 28 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????l??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????l??????????????????????????????????????????????????????s?????????????????????????????????????????????????????????????????????????????????????s?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????x?x???????????????????????????????????????????????????????????????????????????????g???????????????????????????????????q????????????????????????????????q?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????q??????????????????????????????????????????????????????????????????????????????????????q?????";
        assertEquals(1533.600568400556, squarescores.calcexpectation(p, s), DELTA * 1533.600568400556);
    }

    @Test
    public void case175() {
        int[] p = { 15, 0, 0, 0, 0, 0, 35, 0, 0, 2, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 15, 5, 7, 17, 0, 0 };
        String s = "?????????????t??????????????????????????????t?????????t????t?????????t??????????????????????????t???????????tt??????????h????????????????????????????????????????????????h?????????????h?????????????????????????????h????????????????????????????????????????h????????????????????????????c????c?????????????c???????????????????c???????????c????????????????????????????????????????c?c????????????c????cc?????????????????????????????c????????????????c???????????????????????????????c????c?????????????????????????c???????????????????????????????????????????c???????????????c???c???????c?????????????c????????????c????c??????????????????????????????????????????????????????????????????????????????????????????????????c???c???????????????????????c??????????????????????????????????????????????????c??????????????????????????????c?????????????????????c????c???????a??????????????????????a??????????a??????????????????????????????????????????????????????????????????????????????a??????????????????a??????????i??";
        assertEquals(1257.5656717221605, squarescores.calcexpectation(p, s), DELTA * 1257.5656717221605);
    }

    @Test
    public void case176() {
        int[] p = { 0, 19, 2, 0, 0, 7, 0, 0, 7, 0, 0, 18, 14, 1, 19, 2, 2, 0, 5, 0, 0, 0, 0, 4, 0, 0 };
        String s = "??????????qv?i???????????i??????i?????????????i??????????i????i?????i??i??i??????????i?i?????????????????????i?????????????????????????i????????????????????i??????i????????????????????z???????????????????????z?z????z?????r??o?????????????????o?????o????????????o??????????????q?????q??????????d????????????d?d???d????d??????????d???????????????????????????d?????d???????????????d????????d?????????d????p???p?p????p???????????????????????????pp?p?p??????????p?v??????????????????????v????vv??v???????????r??r?????????y?y?????????????yy?????????????y??????y??y??????????m???????mm????t????????t????t????i???????s?s???????????????????????????s???????????????s?????s??????????s?????????s???s??s???s????s?s?????ss???s????????????????????????t??????????????????????????t???q????????n???v????????????t?tt?????t?t????????????????????t?t???e?e?l?????????????l?????????l????a??????????????a?????a??a???????a??a?????a?????????q????q??????????aa??????????????????????????????a?s????????s?????s??s????????s???????";
        assertEquals(1143.1270882623207, squarescores.calcexpectation(p, s), DELTA * 1143.1270882623207);
    }

    @Test
    public void case177() {
        int[] p = { 1, 9, 0, 0, 5, 6, 5, 1, 6, 3, 0, 1, 7, 3, 3, 9, 0, 4, 0, 2, 1, 3, 3, 6, 11, 11 };
        String s = "qrrrrwwwww?mmmm?mydeeeeeeeeee?eeeeooorr?rrrrrrrrrnatykscyyyttttttvceeezyjjjj?mqqqtuu??zzzihheeeee????pvvvv?v???wwwwwwkkyyyyyy?ddde????uuuccmccssssswm?m??mbddmmac?cjj?jbvvvvvaiw?xgqfflllld?d?d??zzzno?b?dboppp??ppp?avvvu?uksgjzzzbdddzzwd?ttsssswttttj?jjjgmmeeesspp?plllllvvvi???iizzhpuuuuu?w?kkkkktttte?ee?tsssslkkkks?wtt?tkkktkqqqqmmmmmyyggr?rro??y?i?g?gy?yq?aaa??aai??griizzxxcc??c???cc?c?ckkkfejjjjjjmpqg?r?rm?m?mcq?qqffffy?zpppppepyuuuu?uwwwwuu?uugffooook?kkvv??wc??cyq?qqqqqsskkllyyyr?rthnii?iijxxxxwww?hhhhhjj?jj?kkkkkbbbtvviiwwvvvv?vv?vizziiipf??fkkllzzzkkkkkxrllee?e?eeee?euu?hfffff??v?vvv??vvvvv??vvvqqqooo?oo?n?n?njjpttakklpiiin??cg??k?jjyyycccccccggg?ggtmbbbbbppuuggj?f??fff?ffff?eeeevvhh?hffqqqqylw?wwww?eeeeeee?ee?eldeeee?gnnnyyyfabrrrgg?crrrrrrr?r?rccsqqqqqvv??vvvdq??qqqggbb?bbxxx?xxddddbllltpp?ttknnc?cccoooooof?ff?fyyb?nnnn?nrrrrr??vvvvvvqy??yrttlo?u?uuu?zzz?zzzzzii?ij?jjaaajv?hhhhhvuuuuttt?tt?ttsssn?ncvooqqqqqqqfffft?ttttt?tfffff?feeqqqkkddwwszkk?ru?vbyy?oj?jccccbbbb?bnnnnnn?nnb?b?";
        assertEquals(1934.116613785854, squarescores.calcexpectation(p, s), DELTA * 1934.116613785854);
    }

    @Test
    public void case178() {
        int[] p = { 1, 6, 0, 0, 0, 0, 0, 5, 7, 7, 5, 3, 1, 2, 1, 0, 0, 0, 0, 0, 12, 19, 0, 15, 12, 4 };
        String s = "????????????????????aa????a????????????????????a?a?????a???????????????????????????????????????????????????????????????????????????i?avw?????w???w??????????????????????????????????????????????????????????????????????w????w??????????????????????????????????w?w???????????w????ww???????????????????????????????????w???????w???ri??????????????????i???????????w?????????k????????????????e??????????e?e?????????????????????????????????e?????ed??????????????????????d?????????????????????????????????????d???????????d?????????????d????p???????????????????????????p?????????????c??????c????????c??????????????????c??????s???????????????????????s??????????????s?yn???????????n???q???????q????????q???????????n?n????????????????????????????????????????????????????????????????n???????????nn???????????????u?????u??????????u?????????????u??????u?????????????????u??????u???????????u??????????????????????????????h?h?????????????????h?h????h???????????????????????h??h??????????????????????????????????????h????";
        assertEquals(1115.4880121405229, squarescores.calcexpectation(p, s), DELTA * 1115.4880121405229);
    }

    @Test
    public void case179() {
        int[] p = { 11, 1, 2, 2, 15, 7, 0, 0, 1, 17, 9, 0, 0, 0, 1, 3, 3, 3, 1, 0, 1, 4, 0, 19, 0, 0 };
        String s = "z??s??ssss??sl??ll????ll??lp??pp?p??p?p???pp???p?pp??ppp????p?ppp?pnnnn?zz?z?zzzzzz?zz???z????z??zz?zz?zz?z????zzz?z?zz?zzee?????e??ee?e??ee?e?el?lll??z?zz??????zzzzz?z?zzkkk??kkkc?ccccc?c?ccc?cc?cccccccc?ccc????cccc???ccccz?z?c??cj????jjjjj???j?j???e?ee???e?eeee?e?ee?ee????eeee??????e?e??e?ee?ee?ee?eee?ee??e??e?ee??eeegn?nnnnnnnnn?n?nn?nn?n?n???nnn?nnnnn???n?nnn?nn?nn?nn??nn?n?nn???n?n?n?nnnnn?nnn????n?nn?nn?n????n?nn???n??nnnnn?nn??nn?n??n??????nnnnnn??nnnn?nnn?n??n??nnn???nt?tt?twww?wwwww??gg?gg?g???z???????zz??zzzzzzzz???????zz?z??z?zzz??zz?zz?z?zzz??z???????ll???l?l?lle??x?x???xt??t??t?t??tt?t?tssssg????????gg??gggmmmm?rr???rr?rrrr??rb?b?b??b??bb?b???b??bb???bb???b??????bb??bbbbb???b?bb??bbk???k?k??kk??kkk??kk?k??k?kk??kkkk??kk?k???k?ee?e??e???eee???ee??ee?ee??e?e????eeee??????ee?e?wwwwwwww??wwwww?w??wwwwwww??www??w?ww?wwww?wwww?w?j?j?j?jjjj?j??j?jjnnnb?b?b?bb?bb?b??b?bb??b??bbbbbb?bbbbb?b???bbggg?ggggg???sss??s??s??s??ss????s?ss?ss??s??s?s??ss?ss?????ssssss??s?s?s??zzz??????zzzz?";
        assertEquals(1647.915126777878, squarescores.calcexpectation(p, s), DELTA * 1647.915126777878);
    }

    @Test
    public void case180() {
        int[] p = { 10, 6, 3, 0, 6, 8, 3, 2, 3, 2, 2, 2, 4, 3, 2, 7, 5, 5, 2, 2, 10, 1, 0, 2, 7, 3 };
        String s = "c?ajhnnkngqjwaae?xadxsscvwaffxpaycdddtbggm?wsuszv?wwsuuuuqiizzz?httesama?ygke?mnmogdiietfutftbe?kiawtvvvojzctqsnuussgqjjlmmv?ff?ssfwhccpiiogkipccjfaa?antprwweeccym?pnhh?hoobydsspeeeeeghiiieagufgpnnneuiiui?ifa?a?yazwwdbvm??moo?uszjztsbqve?ebpbayijennnttvvghqqncwdxxxkkuu?wcffxwvaoooxdwaoonqettttn?rytpokb?nvnffvvssrm?munwkaeqnq?okkcc?a?alvpvvlabqldidv?lllzjjenlxxxxbpyyssoplmssibell?l?gjgwrtsssmrrnzzgdawwwcyyyyyiphyldxtppclicggepdkkihorooopppfzzzworzucn?b?e?e?ezlhxccwwwewnnnnoqr?ppphtgggbhmkimxyeepncbsss?rqiijnnngvoddppvvm?mmbnls?yhhiwocooltoy?skkycpafltxxxxfr?yyqpvtxggfrrooputdzhdxxxgzfft?tysxsgmmvvvvflexu?wv?mi?jyllqmmifo?ulddrwuqx?jhcuujfmdoocolqzzccyccevzzhzldsccuiioopohoaoorrzfmfaoeemqqqkanndkkjffqqwmlppppofaaaupgg?hsrubykkouuul?ggnxanncohcyxil??aaemmmmmdlrcqgtrxztjjqouqmwvv?ddcmm?ccqqqqqqyccjvgwtjggumtykuhrkwcnnggggccdjzutoymnndbiqdvdllggippoalllygggagbvbyeb?yywjji?iddkkkaodcfywnbbd?eawc?cll?yvtb?ichxpmaaaqqpmhl??gars?szvxkkknn?dvvsqzprrrfcqlljz?yyliuzrrop?qqqmhcqy?dlgiikcbbsfkkr?rrr";
        assertEquals(1312.3631319999884, squarescores.calcexpectation(p, s), DELTA * 1312.3631319999884);
    }

    @Test
    public void case181() {
        int[] p = { 1, 2, 1, 5, 12, 10, 6, 2, 2, 1, 3, 1, 8, 7, 6, 0, 3, 1, 3, 3, 5, 0, 3, 6, 5, 4 };
        String s = "??y???a??a????????????????a??????????????????a?????a?????????????????????????a????a???q????????????????????q?????qq?q?????q?????qqqq?????????????????????????????????????????q?qq????q?????????q??o???????????????????????m??????????m??m???m???m???mm????????m??m?m???????mm?x??x???x??x??x?????????????????xx?????x????x???????????x????????????x?x????????xx?????????????????xx???????????????????x???????xx??????o????????????s??????ss?????????????????????????????ss?s??????????????s?????????????????????????ss?????s??????????????s????t????t?tt????????????t?t?????????????g???????????????????g???????v???????????????v??v???????????????v???v?????vvv????????????????????????v?????????????????????v?????????q??????q??????????q???????q??????qq?????q?qq??????q????????q?q?????p?????pp????????????pp?p???p??????m????????????????mm??b?????????b?bb?b??bb????b??n?????n???????????n??n??????n?????p?????p??p??????p????p????pp???p??????????s?????????s?????????????????????????????????s????????????s???????????????s????d";
        assertEquals(1090.0390449025913, squarescores.calcexpectation(p, s), DELTA * 1090.0390449025913);
    }

    @Test
    public void case182() {
        int[] p = { 3, 9, 2, 1, 2, 4, 3, 3, 6, 2, 1, 1, 6, 6, 3, 2, 3, 8, 3, 1, 5, 3, 5, 4, 10, 4 };
        String s = "azfleaadrbw?rtkkowiiofoopppddjjgodrrssdykdikvmkkwwwvpy??ktteqqgxgiitxddmfdofffstdm?rxz?zzmn?uekeeeekulxaih?hddkbtrrurjvvcknryxc?ipnxhvyyyuuccbrdwhonossskkk?bbusqsgoo?o?uu?wkuugmeebadoddccmqzeicgddddyaquuocemmnlr?vvlzauiiwwwgwwpqggsfcrhqnzgrqllyj?tqrcoozabn?dulobwifz?zve?rjvvzr?molyvvfujcygiieeqvcpj?svzlgjzvyf?egt?tde?xjdbwwgvbaimtkciauuggecqvvv?vvvrrlzzzttxxnlggghppmxfnszccodnn?neyymzurtzhtynwxxrrrciipsatdf?faiazmrwwlvbxjeea?gagwoorribuuunpyeennnmkb?dy?bllffjmrn?dooodllgl?juptenleplhbxtjm?yyldxdnrgggl?lldkj?jjmbllglmthytkqsffxnnngzz?roossssoqudqqebaooooflzjfnuy?kkvwwhkzmhrrvouvwwwwztttanjjzzcgmadvglazzia?cvsajzowhuhurwwkwvvzwihtdip?m?ddvsxvs?aaazzdooydrnvvkf?ddxe?bbgxttmdfci?ii?appwvlrehtt?qeazzzqnblll?yvzoo??tfzrjlxxppmhhqq?qwvzzziiffffbvpjjrnnppffj??m?hliieemmweoz?bbhtvvooek?oawtm?mssvbq?eahhiqqq?hp?pp?ullllxrh?naopnbmmwwwff?rndrrdmgppbfwaa?ayjxttttaaearroo?uveyt?tfnxivp?mlmfxwfzppkidohthophgfaajjryoonnewwokzg?qnjrmkmbbooomifqteecqarafysssswllllff?gffoo?v?vfqkichpinloa?arbrrywlhbbeum";
        assertEquals(1266.9786159999803, squarescores.calcexpectation(p, s), DELTA * 1266.9786159999803);
    }

    @Test
    public void case183() {
        int[] p = { 1, 1, 1, 1, 96 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(23464.403632283338, squarescores.calcexpectation(p, s), DELTA * 23464.403632283338);
    }

    @Test
    public void case184() {
        int[] p = { 1, 2, 45, 45, 7 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1740.796600040712, squarescores.calcexpectation(p, s), DELTA * 1740.796600040712);
    }

    @Test
    public void case185() {
        int[] p = { 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 25 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1106.394185236668, squarescores.calcexpectation(p, s), DELTA * 1106.394185236668);
    }

    @Test
    public void case186() {
        int[] p = { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 75 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(3243.522701765751, squarescores.calcexpectation(p, s), DELTA * 3243.522701765751);
    }

    @Test
    public void case187() {
        int[] p = { 1, 99 };
        String s = "a??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????b";
        assertEquals(89112.51815880286, squarescores.calcexpectation(p, s), DELTA * 89112.51815880286);
    }

    @Test
    public void case188() {
        int[] p = { 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4 };
        String s = "??????????????????????????????????????????????????????????????????????????????????????????????????????????????a?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1040.3386571735396, squarescores.calcexpectation(p, s), DELTA * 1040.3386571735396);
    }

    @Test
    public void case189() {
        int[] p = { 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1040.3359863043372, squarescores.calcexpectation(p, s), DELTA * 1040.3359863043372);
    }

    @Test
    public void case190() {
        int[] p = { 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 1 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1040.986119924298, squarescores.calcexpectation(p, s), DELTA * 1040.986119924298);
    }

    @Test
    public void case191() {
        int[] p = { 10, 10, 10, 10, 10, 10, 10, 10, 10, 10 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1110.9876543210894, squarescores.calcexpectation(p, s), DELTA * 1110.9876543210894);
    }

    @Test
    public void case192() {
        int[] p = { 1, 2, 97 };
        String s = "???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(31286.033701224424, squarescores.calcexpectation(p, s), DELTA * 31286.033701224424);
    }

    @Test
    public void case193() {
        int[] p = { 1, 2, 0, 2, 1, 1, 0, 0, 3, 0, 1, 0, 1, 3, 3, 3, 1, 0, 3, 1, 0, 0, 2, 1, 1, 70 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(2634.654694444029, squarescores.calcexpectation(p, s), DELTA * 2634.654694444029);
    }

    @Test
    public void case194() {
        int[] p = { 0, 1, 3, 4, 3, 0, 3, 3, 2, 4, 1, 0, 2, 3, 0, 1, 4, 1, 3, 1, 5, 0, 3, 4, 3, 46 };
        String s = "???????????????????a?????????????????d???e????o????????c???????????????h?z???????????tj??????????c????????????????????????????????????bm???????t?c???????????????????w???????????????r????o?????j?????????v??a?????????k????????c?????????x???????????????j?????x?????????????????????????????????t??u????????t??????????????????????u????????????????????ha???????????e?????d????????q?op?????????????????????????????????c??????????????????????????????o????????????????ikw??????uo???????x?????g??e??????????????u????????????ze???????m??j???p????p?????????l????c?y????????v?????d?????o??????????????????????????????????n????????????????????????????????????????q????b??t????????a?????h???????????t????????????w????????d?????b??????????????w?????????????????????????y?????????????t?????n?????k?????????w????????????????????????????????????th????????z???????????????????eez????????????vd???h??y??????y????x?????????b????e????????????????????????n??????x??sp????????g??o?mg???????q??????????????????????????v????u??";
        assertEquals(1318.8608814039844, squarescores.calcexpectation(p, s), DELTA * 1318.8608814039844);
    }

    @Test
    public void case195() {
        int[] p = { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 75, 1 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(3243.522701765751, squarescores.calcexpectation(p, s), DELTA * 3243.522701765751);
    }

    @Test
    public void case196() {
        int[] p = { 6, 2, 7, 5, 1, 5, 2, 1, 1, 2, 5, 7, 7, 5, 3, 7, 1, 5, 1, 5, 8, 1, 2, 6, 2, 3 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1055.9237860361482, squarescores.calcexpectation(p, s), DELTA * 1055.9237860361482);
    }

    @Test
    public void case197() {
        int[] p = { 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0 };
        String s = "???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1040.5815972220048, squarescores.calcexpectation(p, s), DELTA * 1040.5815972220048);
    }

    @Test
    public void case198() {
        int[] p = { 5, 5, 90 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(9024.257617728234, squarescores.calcexpectation(p, s), DELTA * 9024.257617728234);
    }

    @Test
    public void case199() {
        int[] p = { 50, 50 };
        String s = "??";
        assertEquals(2.5, squarescores.calcexpectation(p, s), DELTA * 2.5);
    }

    @Test
    public void case200() {
        int[] p = { 1, 75, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };
        String s = "?????????????????a????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????zyxwvutsrqponmlkjihgfedcba";
        assertEquals(3173.8000267694906, squarescores.calcexpectation(p, s), DELTA * 3173.8000267694906);
    }

    @Test
    public void case201() {
        int[] p = { 1, 99 };
        String s = "???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(51110.484881303295, squarescores.calcexpectation(p, s), DELTA * 51110.484881303295);
    }

    @Test
    public void case202() {
        int[] p = { 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5 };
        String s = "????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????";
        assertEquals(1052.5761772853205, squarescores.calcexpectation(p, s), DELTA * 1052.5761772853205);
    }

}
